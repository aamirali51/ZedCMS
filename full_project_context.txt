
==================================================
FILE PATH: .\config.php
==================================================

<?php

declare(strict_types=1);

/**
 * Zero CMS Configuration
 * Database credentials and core settings.
 */

return [
    'database' => [
        'host'     => 'localhost',
        'port'     => 3306,
        'name'     => '123',
        'user'     => 'root',
        'password' => '',
        'charset'  => 'utf8mb4',
    ],

    'app' => [
        'name'    => 'Zero',
        'version' => '1.0.0',
        'debug'   => true,
    ],
];


==================================================
FILE PATH: .\documentaton.md
==================================================

Installation
Add the component via the Tiptap CLI:

npx @tiptap/cli@latest add floating-element

Components
<FloatingElement />
A versatile React component that creates floating UI elements positioned relative to text selections in Tiptap editors.

Usage
import * as React from 'react'
import { EditorContent, EditorContext, useEditor } from '@tiptap/react'

// --- Tiptap Core Extensions ---
import { StarterKit } from '@tiptap/starter-kit'

// --- Tiptap UI ---
import { FloatingElement } from '@/components/tiptap-ui-utils/floating-element'
import { MarkButton } from '@/components/tiptap-ui/mark-button'

// --- UI Primitives ---
import { ButtonGroup } from '@/components/tiptap-ui-primitive/button'
import { Toolbar } from '@/components/tiptap-ui-primitive/toolbar'

// --- Tiptap Node ---
import '@/components/tiptap-node/paragraph-node/paragraph-node.scss'

export const FloatingElementExample = () => {
  const editor = useEditor({
    immediatelyRender: false,
    content: `<h2>Floating Element Example</h2>
      <p>Try selecting some text in this editor. A simple formatting toolbar will appear above your selection. 
      The FloatingElement component positions UI elements relative to the text selection or cursor position. 
      It's commonly used for contextual toolbars, menus, and other elements that should appear near the current editing context.</p>`,
    extensions: [StarterKit],
  })

  return (
    <EditorContext.Provider value={{ editor }}>
      <EditorContent editor={editor} role="presentation" />

      <FloatingElement editor={editor}>
        <Toolbar variant="floating">
          <ButtonGroup orientation="horizontal">
            <MarkButton type="bold" />
            <MarkButton type="italic" />
          </ButtonGroup>
        </Toolbar>
      </FloatingElement>
    </EditorContext.Provider>
  )
}

Props
Name	Type	Default	Description
editor	Editor | null	undefined	The Tiptap editor instance to attach to
shouldShow	boolean	undefined	Controls whether the floating element should be visible
floatingOptions	Partial<UseFloatingOptions>	undefined	Additional options to pass to the floating UI
zIndex	number	50	Z-index for the floating element
onOpenChange	(open: boolean) => void	undefined	Callback fired when the visibility state changes
referenceElement	HTMLElement | null	undefined	Reference element to position the floating element relative to. If provided, this takes precedence over getBoundingClientRect
getBoundingClientRect	(editor: Editor) => DOMRect | null	getSelectionBoundingRect	Custom function to determine the position of the floating element. Only used if referenceElement is not provided
closeOnEscape	boolean	true	Whether to close the floating element when Escape key is pressed
children	React.ReactNode	undefined	Content to display inside the floating element
Advanced Usage Examples
Basic Floating Toolbar
import { shift, flip, offset } from '@floating-ui/react'
import { FloatingElement } from '@/components/tiptap-ui-utils/floating-element'

function FloatingToolbar({ editor }) {
  return (
    <FloatingElement
      editor={editor}
      floatingOptions={{
        placement: 'top',
        middleware: [shift(), flip(), offset(8)],
      }}
    >
      {/* Floating content here */}
    </FloatingElement>
  )
}

Custom Positioning with Mobile Support
import { FloatingElement } from '@/components/tiptap-ui-utils/floating-element'
import { useMobile } from '@/hooks/use-mobile'

function ResponsiveFloatingMenu({ editor, isMenuVisible }) {
  const isMobile = useMobile()

  const getCustomRect = (editor) => {
    // Custom positioning logic
    // Example: position relative to current cursor
    return editor.view.coordsAtPos(editor.state.selection.from)
  }

  return (
    <FloatingElement
      editor={editor}
      shouldShow={isMenuVisible}
      getBoundingClientRect={getCustomRect}
      {...(isMobile
        ? {
            style: {
              position: 'fixed',
              left: 0,
              right: 0,
              bottom: 0,
              margin: '.5rem',
              zIndex: 50,
            },
          }
        : {})}
    >
      {/* Floating content here */}
    </FloatingElement>
  )
}

Customize shouldShow Floating Menu
import { useState, useEffect } from 'react'
import { FloatingElement } from '@/components/tiptap-ui-utils/floating-element'
import { isSelectionValid } from '@/lib/tiptap-collab-utils'

function SelectionMenu({ editor }) {
  const [isVisible, setIsVisible] = useState(false)

  useEffect(() => {
    if (!editor) return

    const updateVisibility = () => {
      const hasSelection = !editor.state.selection.empty
      const isValidSelection = isSelectionValid(editor)
      setIsVisible(hasSelection && isValidSelection)
    }

    editor.on('selectionUpdate', updateVisibility)
    return () => editor.off('selectionUpdate', updateVisibility)
  }, [editor])

  return (
    <FloatingElement editor={editor} shouldShow={isVisible}>
      {/* Your floating content here */}
    </FloatingElement>
  )
}

Using Reference Element
Attach the floating element to a specific DOM element instead of the text selection:

import { useState } from 'react'
import { offset, flip, shift } from '@floating-ui/react'
import { FloatingElement } from '@/components/tiptap-ui-utils/floating-element'

function ButtonWithTooltip() {
  const [buttonRef, setButtonRef] = useState<HTMLElement | null>(null)
  const [showTooltip, setShowTooltip] = useState(false)

  return (
    <>
      <button
        ref={setButtonRef}
        onMouseEnter={() => setShowTooltip(true)}
        onMouseLeave={() => setShowTooltip(false)}
      >
        Hover me
      </button>

      <FloatingElement
        editor={editor}
        referenceElement={buttonRef}
        shouldShow={showTooltip}
        floatingOptions={{
          placement: 'top',
          middleware: [offset(8), flip(), shift()],
        }}
      >
        <div className="tooltip">Helpful tooltip content</div>
      </FloatingElement>
    </>
  )
}

Utilities
getSelectionBoundingRect(editor)
Gets the bounding rectangle of the current selection in the editor.

Parameters:

editor - The Tiptap editor instance
Returns: DOMRect | null - The bounding rectangle of the current selection

import { getSelectionBoundingRect } from '@/lib/tiptap-collab-utils'

const rect = getSelectionBoundingRect(editor)
console.log('Selection bounds:', rect)

isSelectionValid(editor, selection?, excludedNodeTypes?)
Checks if the current selection is valid for showing floating elements. Returns false for empty selections, code blocks, excluded node types, and table cells.

Parameters:

editor - The Tiptap editor instance
selection (optional) - The selection to validate. Defaults to editor.state.selection
excludedNodeTypes (optional) - Array of node type names to exclude. Defaults to ['imageUpload', 'horizontalRule']
Returns: boolean - true if the selection is valid for floating elements

import { isSelectionValid } from '@/lib/tiptap-collab-utils'

const shouldShow = isSelectionValid(editor)

// With custom excluded node types
const isValid = isSelectionValid(editor, undefined, ['image', 'video'])

isTextSelectionValid(editor)
Checks if the current text selection is valid for editing. Returns false for empty selections, code blocks, and node selections.

Parameters:

editor - The Tiptap editor instance
Returns: boolean - true if the text selection is valid

import { isTextSelectionValid } from '@/lib/tiptap-collab-utils'

const canEdit = isTextSelectionValid(editor)
if (canEdit) {
  // Show text editing toolbar
}

isElementWithinEditor(editor, element)
Checks if a DOM element is within the editor's DOM tree. Useful for determining click/focus events.

Parameters:

editor - The Tiptap editor instance
element - The DOM element to check
Returns: boolean - true if the element is within the editor

import { isElementWithinEditor } from '@/components/tiptap-ui-utils/floating-element'

const handleClick = (event: MouseEvent) => {
  if (isElementWithinEditor(editor, event.target as Node)) {
    console.log('Clicked inside editor')
  }
}

Previously
Utils components
Next up

Color Highlight Button
Available for free
A fully accessible and customizable color highlight button for Tiptap editors. Apply background colors to selected text using keyboard shortcuts or UI, with support for dynamic color sets, custom rendering, and accessibility.


Installation
Add the component via the Tiptap CLI:

npx @tiptap/cli@latest add color-highlight-button

Components
<ColorHighlightButton />
A ready-to-use React button for applying color highlights to selected text in a Tiptap editor.

Usage
import { EditorContent, EditorContext, useEditor } from '@tiptap/react'

// --- Tiptap Core Extensions ---
import { StarterKit } from '@tiptap/starter-kit'
import { Highlight } from '@tiptap/extension-highlight'

// --- Tiptap UI ---
import { ColorHighlightButton } from '@/components/tiptap-ui/color-highlight-button'

// --- UI Primitive ---
import { ButtonGroup } from '@/components/tiptap-ui-primitive/button'

// --- Node Styles ---
import '@/components/tiptap-node/code-block-node/code-block-node.scss'
import '@/components/tiptap-node/paragraph-node/paragraph-node.scss'

export default function MyEditor() {
  const editor = useEditor({
    immediatelyRender: false,
    extensions: [StarterKit, Highlight.configure({ multicolor: true })],
    content: `
      <h2>Color Highlight Button Demo</h2>
      <p>Welcome to the color highlight button! This demo showcases functionality.</p>
      <h3>How to Use:</h3>
      <p>1. <strong>Select any text</strong> you want to highlight</p>
      <p>2. <strong>Click a color button</strong> to apply that <mark data-color="oklch(88.5% 0.062 18.334)" style="background-color: oklch(88.5% 0.062 18.334); color: inherit">highlight</mark></p>
    `,
  })

  return (
    <EditorContext.Provider value={{ editor }}>
      <ButtonGroup orientation="horizontal">
        <ColorHighlightButton tooltip="Red" highlightColor="oklch(88.5% 0.062 18.334)" />
        <ColorHighlightButton
          editor={editor}
          tooltip="Orange"
          highlightColor="oklch(90.1% 0.076 70.697)"
          text="Highlight"
          hideWhenUnavailable={true}
          showShortcut={true}
          onApplied={({ color, label }) => console.log(`Applied ${label} highlight: ${color}`)}
        />
      </ButtonGroup>

      <EditorContent editor={editor} role="presentation" />
    </EditorContext.Provider>
  )
}

Props
Name	Type	Default	Description
editor	Editor | null	undefined	The Tiptap editor instance
highlightColor	string	required	The highlight color to apply (CSS color value)
text	string	undefined	Optional text label for the button
hideWhenUnavailable	boolean	false	Hides the button when highlight is not applicable
onApplied	({ color, label }) => void	undefined	Callback fired after applying a highlight
showShortcut	boolean	false	Shows a keyboard shortcut badge (if available)
Hooks
useColorHighlight(config)
A powerful hook to build your own custom color highlight button with full control over behavior and rendering.

Usage
import { useColorHighlight } from '@/components/tiptap-ui/color-highlight-button'
import { Badge } from '@/components/tiptap-ui-primitive/badge'
import { parseShortcutKeys } from '@/lib/tiptap-utils'

function MyColorHighlightButton() {
  const { isVisible, isActive, canColorHighlight, handleColorHighlight, label, shortcutKeys } =
    useColorHighlight({
      editor: myEditor,
      highlightColor: 'var(--tt-color-highlight-blue)',
      label: 'Blue Highlight',
      hideWhenUnavailable: true,
      onApplied: ({ color, label }) => console.log(`Applied: ${label}`),
    })

  if (!isVisible) return null

  return (
    <button
      onClick={handleColorHighlight}
      disabled={!canColorHighlight}
      aria-label={label}
      aria-pressed={isActive}
      style={{ backgroundColor: isActive ? highlightColor : 'transparent' }}
    >
      {label}
      {shortcutKeys && <Badge>{parseShortcutKeys({ shortcutKeys })}</Badge>}
    </button>
  )
}

Props
Name	Type	Default	Description
editor	Editor | null	undefined	The Tiptap editor instance
highlightColor	string	required	The highlight color to apply
label	string	optional	Accessible label for the button
hideWhenUnavailable	boolean	false	Hides the button if highlight cannot be applied
mode	"mark" | "node"	"mark"	Highlighting mode (mark or node background)
onApplied	({ color, label, mode }) => void	undefined	Callback fired after applying highlight
Return Values
Name	Type	Description
isVisible	boolean	Whether the button should be rendered
isActive	boolean	If the highlight is currently active
canColorHighlight	boolean	If the highlight can be applied
handleColorHighlight	() => boolean	Function to apply the color highlight
handleRemoveHighlight	() => boolean	Function to remove the highlight
label	string	Accessible label text for the button
shortcutKeys	string	Keyboard shortcut (Cmd/Ctrl + Shift + H)
Icon	React.FC	Icon component used (HighlighterIcon)
mode	"mark" | "node"	The highlighting mode being used
Utilities
canColorHighlight(editor, mode?)
Checks if color highlight can be applied in the current editor state.

Parameters
Parameter	Type	Default	Description
editor	Editor | null	Required	The Tiptap editor instance
mode	"mark" | "node"	"mark"	Highlighting mode (mark or node background)
Returns
boolean - Whether highlight can be applied

Usage
import { canColorHighlight } from '@/components/tiptap-ui/color-highlight-button'

const canApply = canColorHighlight(editor)
const canApplyNode = canColorHighlight(editor, 'node')

isColorHighlightActive(editor, highlightColor?, mode?)
Checks if a color highlight is currently active in the selection.

Parameters
Parameter	Type	Default	Description
editor	Editor | null	Required	The Tiptap editor instance
highlightColor	string	undefined	The specific color to check for
mode	"mark" | "node"	"mark"	Highlighting mode (mark or node background)
Returns
boolean - Whether the highlight is active

Usage
import { isColorHighlightActive } from '@/components/tiptap-ui/color-highlight-button'

const isActive = isColorHighlightActive(editor) // Any highlight active
const isYellowActive = isColorHighlightActive(editor, 'var(--tt-color-highlight-yellow)') // Specific color active
const isNodeHighlight = isColorHighlightActive(editor, 'var(--tt-color-highlight-blue)', 'node')

removeHighlight(editor, mode?)
Removes the current highlight from the selection.

Parameters
Parameter	Type	Default	Description
editor	Editor | null	Required	The Tiptap editor instance
mode	"mark" | "node"	"mark"	Highlighting mode (mark or node background)
Returns
boolean - Whether the highlight was successfully removed

Usage
import { removeHighlight } from '@/components/tiptap-ui/color-highlight-button'

const success = removeHighlight(editor)
const successNode = removeHighlight(editor, 'node')

pickHighlightColorsByValue(values)
Filters the default highlight colors by their values.

Parameters
Parameter	Type	Description
values	string[]	Array of color values to filter by
Returns
HighlightColor[] - Array of matching highlight color objects

Usage
import { pickHighlightColorsByValue } from '@/components/tiptap-ui/color-highlight-button'

const colors = pickHighlightColorsByValue([
  'var(--tt-color-highlight-yellow)',
  'var(--tt-color-highlight-blue)',
])
// Returns the full color objects with label, value, and border properties

Keyboard Shortcuts
The color highlight button supports the following keyboard shortcut:

Cmd/Ctrl + Shift + H: Apply color highlight
This shortcut is automatically registered when using the ColorHighlightButton or useColorHighlight() hook, and applies the configured highlight color to the current selection.

Requirements
Dependencies
@tiptap/react - Core Tiptap React integration
@tiptap/extension-highlight - Highlight extension for text highlighting
react-hotkeys-hook - Keyboard shortcut management
Referenced Components
use-tiptap-editor (hook)
button (primitive)
badge (primitive)
tiptap-utils (lib)
highlighter-icon (icon)

Code Block Button
Available for free
A fully accessible code block button for Tiptap editors. Easily toggle selected content into a <codeBlock> with keyboard shortcut support and flexible customization options.


Installation
Add the component via the Tiptap CLI:

npx @tiptap/cli@latest add code-block-button

Components
<CodeBlockButton />
A prebuilt React component that toggles code block formatting.

Usage
import { useEditor, EditorContent, EditorContext } from '@tiptap/react'
import { StarterKit } from '@tiptap/starter-kit'
import { CodeBlockButton } from '@/components/tiptap-ui/code-block-button'

export default function MyEditor() {
  const editor = useEditor({
    immediatelyRender: false,
    extensions: [StarterKit],
    content: `
        <pre><code>console.log('Hello, World!');</code></pre>
        `,
  })

  return (
    <EditorContext.Provider value={{ editor }}>
      <CodeBlockButton
        editor={editor}
        text="Code"
        hideWhenUnavailable={true}
        showShortcut={true}
        onToggled={() => console.log('Code block toggled!')}
      />

      <EditorContent editor={editor} role="presentation" />
    </EditorContext.Provider>
  )
}

Props
Name	Type	Default	Description
editor	Editor | null	undefined	The Tiptap editor instance
text	string	undefined	Optional text label for the button
hideWhenUnavailable	boolean	false	Hides the button when code block is not applicable
onToggled	() => void	undefined	Callback fired after a successful toggle
showShortcut	boolean	false	Shows a keyboard shortcut badge (if available)
Hooks
useCodeBlock()
A custom hook to build your own code block toggle button with full control over rendering and behavior.

Usage
import { useCodeBlock } from '@/components/tiptap-ui/code-block-button'
import { parseShortcutKeys } from '@/lib/tiptap-utils'
import { Badge } from '@/components/tiptap-ui-primitive/badge'

function MyCodeBlockButton() {
  const { isVisible, isActive, canToggle, handleToggle, label, shortcutKeys, Icon } = useCodeBlock({
    editor: myEditor,
    hideWhenUnavailable: true,
    onToggled: () => console.log('Code block toggled!'),
  })

  if (!isVisible) return null

  return (
    <button onClick={handleToggle} disabled={!canToggle} aria-label={label} aria-pressed={isActive}>
      <Icon />
      {label}
      {shortcutKeys && <Badge>{parseShortcutKeys({ shortcutKeys })}</Badge>}
    </button>
  )
}

Props
Name	Type	Default	Description
editor	Editor | null	undefined	The Tiptap editor instance
hideWhenUnavailable	boolean	false	Hides the button if code block cannot be applied
onToggled	() => void	undefined	Callback fired after toggling code block
Return Values
Name	Type	Description
isVisible	boolean	Whether the button should be rendered
isActive	boolean	If the code block is currently active
canToggle	boolean	If the code block toggle is currently allowed
handleToggle	() => boolean	Function to toggle code block formatting
label	string	Accessible label text for the button
shortcutKeys	string	Keyboard shortcut (Cmd/Ctrl + Alt + C)
Icon	React.FC	Icon component for the code block button
Utilities
canToggle(editor, turnInto?)
Checks if code block can be toggled in the current editor state.

Parameters:

editor: Editor | null - The Tiptap editor instance
turnInto: boolean - Whether to check for convertible node types (default: true)
Returns: boolean - Whether the code block can be toggled

import { canToggle } from '@/components/tiptap-ui/code-block-button'

const canToggleBlock = canToggle(editor) // Check if can toggle
const canTurnInto = canToggle(editor, true) // Explicit: check if selection can be turned into a code block
const canToggleDirect = canToggle(editor, false) // Check if can toggle directly

toggleCodeBlock(editor)
Programmatically toggles code block formatting for the current selection.

Parameters:

editor: Editor | null - The Tiptap editor instance
Returns: boolean - Whether the toggle was successful

import { toggleCodeBlock } from '@/components/tiptap-ui/code-block-button'

const success = toggleCodeBlock(editor)
if (success) {
  console.log('Code block toggled successfully!')
}

shouldShowButton(props)
Determines if the code block button should be shown based on editor state and configuration.

Parameters:

props: object
editor: Editor | null - The Tiptap editor instance
hideWhenUnavailable: boolean - Whether to hide when unavailable
Returns: boolean - Whether the button should be shown

import { shouldShowButton } from '@/components/tiptap-ui/code-block-button'

const shouldShow = shouldShowButton({
  editor,
  hideWhenUnavailable: true,
})

Keyboard Shortcuts
The code block button supports the following keyboard shortcut:

Cmd/Ctrl + Alt + C: Toggle code block formatting
The shortcut is automatically registered when using either the <CodeBlockButton /> component or the useCodeBlock() hook.

Requirements
Dependencies
@tiptap/react - Core Tiptap React integration
@tiptap/starter-kit - Basic Tiptap extensions including code block support
react-hotkeys-hook - Keyboard shortcut management
Referenced Components
use-tiptap-editor (hook)
button (primitive)
badge (primitive)
tiptap-utils (lib)
code-block-icon (icon)


==================================================
FILE PATH: .\fl.py
==================================================

import os

# --- CONFIGURATION ---
output_file = "full_project_context.txt"

# Folders to ignore completely
ignore_dirs = {
    ".git",
    "node_modules",
    "vendor",
    "__pycache__",
    ".vscode",
    "dist",
    "build",
}

# File extensions to include (add more if needed)
valid_extensions = {
    ".php",
    ".html",
    ".css",
    ".js",
    ".json",
    ".sql",
    ".py",
    ".ts",
    ".jsx",
    ".tsx",
    ".vue",
    ".md",
}

# Specific files to ignore
ignore_files = {"package-lock.json", "composer.lock", output_file, "prepare_for_ai.py"}


def is_text_file(filename):
    return any(filename.endswith(ext) for ext in valid_extensions)


def merge_files():
    with open(output_file, "w", encoding="utf-8") as outfile:
        # Walk the current directory
        for root, dirs, files in os.walk("."):
            # Modify dirs in-place to skip ignored directories
            dirs[:] = [d for d in dirs if d not in ignore_dirs]

            for file in files:
                if file in ignore_files or not is_text_file(file):
                    continue

                file_path = os.path.join(root, file)

                try:
                    with open(file_path, "r", encoding="utf-8") as infile:
                        content = infile.read()

                    # Add a clear header for the AI
                    outfile.write(f"\n{'=' * 50}\n")
                    outfile.write(f"FILE PATH: {file_path}\n")
                    outfile.write(f"{'=' * 50}\n\n")
                    outfile.write(content)
                    outfile.write("\n\n")
                    print(f"Added: {file_path}")

                except Exception as e:
                    print(f"Skipped {file_path} (Error: {e})")


if __name__ == "__main__":
    merge_files()
    print(f"\nDone! Upload '{output_file}' to the chat.")



==================================================
FILE PATH: .\index.php
==================================================

<?php

declare(strict_types=1);

/**
 * Zero CMS Entry Point
 * 
 * This file does ONLY four things:
 * 1. Loads the configuration
 * 2. Autoloads classes in /core
 * 3. Loads all addons
 * 4. Initializes the App class
 */

// 1. Load configuration
$config = require __DIR__ . '/config.php';

// 2. Autoload classes in /core (PSR-4 style autoloader)
spl_autoload_register(function (string $class): void {
    // Convert namespace separator to directory separator
    // Core\App -> core/App.php
    $prefix = 'Core\\';
    $baseDir = __DIR__ . '/core/';

    // Check if the class uses the Core namespace
    $len = strlen($prefix);
    if (strncmp($prefix, $class, $len) !== 0) {
        return;
    }

    // Get the relative class name
    $relativeClass = substr($class, $len);

    // Build the file path
    $file = $baseDir . str_replace('\\', '/', $relativeClass) . '.php';

    // Require the file if it exists
    if (file_exists($file)) {
        require $file;
    }
});

// 3. Load all addons from content/addons
$addonsDir = __DIR__ . '/content/addons';
if (is_dir($addonsDir)) {
    foreach (glob($addonsDir . '/*.php') as $addonFile) {
        require_once $addonFile;
    }
}

// 4. Initialize and run the App
$app = new \Core\App($config);
$app->run();




==================================================
FILE PATH: .\install.php
==================================================

<?php

declare(strict_types=1);

/**
 * Zero CMS System Installer
 * 
 * Handles database setup, table creation, and initial admin user.
 */

// If config.php already exists, redirect to home
if (file_exists(__DIR__ . '/config.php')) {
    // Get base path for subdirectory support
    $scriptName = $_SERVER['SCRIPT_NAME'] ?? '/install.php';
    $basePath = dirname($scriptName);
    $basePath = ($basePath === '/' || $basePath === '\\') ? '' : $basePath;
    header('Location: ' . $basePath . '/');
    exit;
}

$error = '';
$success = false;

// Handle POST request
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $host = trim($_POST['db_host'] ?? 'localhost');
    $name = trim($_POST['db_name'] ?? '');
    $user = trim($_POST['db_user'] ?? '');
    $pass = $_POST['db_pass'] ?? '';
    
    // Admin credentials
    $admin_email = trim($_POST['admin_email'] ?? '');
    $admin_pass = $_POST['admin_pass'] ?? '';

    // Validate required fields
    if (empty($name)) {
        $error = 'Database name is required.';
    } elseif (empty($user)) {
        $error = 'Database user is required.';
    } elseif (empty($admin_email)) {
        $error = 'Admin email is required.';
    } elseif (!filter_var($admin_email, FILTER_VALIDATE_EMAIL)) {
        $error = 'Please enter a valid admin email address.';
    } elseif (empty($admin_pass) || strlen($admin_pass) < 6) {
        $error = 'Admin password must be at least 6 characters.';
    } else {
        try {
            // 1. Connect to MySQL (without database first)
            $dsn = "mysql:host={$host};charset=utf8mb4";
            $pdo = new PDO($dsn, $user, $pass, [
                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            ]);

            // 2. Create database if not exists
            $pdo->exec("CREATE DATABASE IF NOT EXISTS `{$name}` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci");
            $pdo->exec("USE `{$name}`");

            // 3. Create zero_content table
            $pdo->exec("
                CREATE TABLE IF NOT EXISTS `zero_content` (
                    `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
                    `slug` VARCHAR(255) NOT NULL,
                    `type` VARCHAR(50) NOT NULL DEFAULT 'page',
                    `title` VARCHAR(255) NOT NULL,
                    `data` JSON NULL,
                    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
                    PRIMARY KEY (`id`),
                    UNIQUE INDEX `idx_slug` (`slug`),
                    INDEX `idx_type` (`type`)
                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
            ");

            // 4. Create users table
            $pdo->exec("
                CREATE TABLE IF NOT EXISTS `users` (
                    `id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT,
                    `email` VARCHAR(255) NOT NULL,
                    `password_hash` VARCHAR(255) NOT NULL,
                    `role` VARCHAR(50) NOT NULL DEFAULT 'subscriber',
                    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
                    PRIMARY KEY (`id`),
                    UNIQUE INDEX `idx_email` (`email`)
                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
            ");

            // 5. Insert admin user with provided credentials
            $stmt = $pdo->prepare("SELECT id FROM users WHERE email = :email");
            $stmt->execute(['email' => $admin_email]);
            if (!$stmt->fetch()) {
                $hashedPassword = password_hash($admin_pass, PASSWORD_DEFAULT);
                $stmt = $pdo->prepare("INSERT INTO users (email, password_hash, role) VALUES (:email, :pass, :role)");
                $stmt->execute([
                    'email' => $admin_email,
                    'pass'  => $hashedPassword,
                    'role'  => 'admin',
                ]);
            }

            // 6. Write config.php
            $configContent = <<<PHP
<?php

declare(strict_types=1);

/**
 * Zero CMS Configuration
 * Database credentials and core settings.
 */

return [
    'database' => [
        'host'     => '{$host}',
        'port'     => 3306,
        'name'     => '{$name}',
        'user'     => '{$user}',
        'password' => '{$pass}',
        'charset'  => 'utf8mb4',
    ],

    'app' => [
        'name'    => 'Zero',
        'version' => '1.0.0',
        'debug'   => true,
    ],
];
PHP;

            file_put_contents(__DIR__ . '/config.php', $configContent);

            // 7. Redirect to admin login (with base path for subdirectory support)
            // Use actual folder name from filesystem to ensure correct case
            $folderName = basename(__DIR__);
            header('Location: /' . $folderName . '/admin/login');
            exit;

        } catch (PDOException $e) {
            $error = 'Database Error: ' . $e->getMessage();
        } catch (Exception $e) {
            $error = 'Error: ' . $e->getMessage();
        }
    }
}
?>
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Zero CMS System Installer</title>
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&amp;family=Noto+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<!-- Material Symbols -->
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<!-- Theme Configuration -->
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#256af4",
              "primary-dark": "#1a52c9",
              "background-light": "#f5f6f8",
              "background-dark": "#101622",
              "surface-light": "#ffffff",
              "surface-dark": "#1e293b",
            },
            fontFamily: {
              "display": ["Space Grotesk", "sans-serif"],
              "body": ["Noto Sans", "sans-serif"],
            },
            borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px" },
          },
        },
      }
    </script>
<style>
        /* Custom smooth focus transition */
        .form-input-transition {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="font-display antialiased text-slate-800 bg-background-light dark:bg-background-dark min-h-screen flex items-center justify-center relative overflow-hidden selection:bg-primary selection:text-white">
<!-- Vibrant Mesh Background -->
<div class="absolute inset-0 w-full h-full bg-[#101622] z-0">
<!-- Base Gradient -->
<div class="absolute inset-0 bg-gradient-to-br from-indigo-950 via-[#0f172a] to-[#0a0f1a] opacity-90"></div>
<!-- Mesh Blobs -->
<div class="absolute top-[-10%] left-[-10%] w-[60%] h-[60%] bg-[#256af4] rounded-full blur-[140px] opacity-20 animate-pulse"></div>
<div class="absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-purple-600 rounded-full blur-[140px] opacity-20"></div>
<div class="absolute top-[40%] left-[50%] -translate-x-1/2 -translate-y-1/2 w-[40%] h-[40%] bg-cyan-500 rounded-full blur-[120px] opacity-15"></div>
<!-- Grid Pattern Overlay -->
<div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 mix-blend-soft-light"></div>
</div>
<!-- Main Installer Layout -->
<div class="layout-container flex w-full max-w-6xl p-4 md:p-6 lg:p-8 z-10 relative">
<div class="flex-1 flex justify-center">
<!-- Card Container -->
<div class="w-full max-w-[1000px] bg-surface-light dark:bg-surface-dark rounded-2xl shadow-2xl overflow-hidden border border-white/20 dark:border-white/5 flex flex-col md:flex-row min-h-[640px]">
<!-- Left Visual Column (Hidden on mobile) -->
<div class="hidden md:flex md:w-5/12 lg:w-4/12 relative bg-slate-900 overflow-hidden flex-col justify-between">
<!-- Background Image -->
<div class="absolute inset-0 z-0">
<img alt="Abstract vibrant geometric structures floating in dark space" class="w-full h-full object-cover opacity-80 mix-blend-overlay" data-alt="Abstract vibrant geometric structures floating in dark space" src="https://lh3.googleusercontent.com/aida-public/AB6AXuB5uR8A2ezko2fJqiIoUmLL5YxDOkKtDSI2iPl8OUzS1nISBO4D501dhGX7TrID9NdsKwTNp8UC2Znnj-gTjt1ndDn7hu7rPRJ0hIxt-569NkRsnQoVEd3qS2oQ3rcwGpMa6pJ1LpghNxtlT1nQO5l30OZo7FoNs3XzVQnHQrhqBntfoAlW1NdhFrXLghkRloavN3B_AiYMEI4JWnaBpUge3Gwj4cRFg27RkqoJxXwtYB9G5f37cd4eshN_MLuUlky4ZSQYAD2q8jMT"/>
<div class="absolute inset-0 bg-gradient-to-b from-primary/30 to-purple-900/90 mix-blend-multiply"></div>
</div>
<!-- Decorative Content -->
<div class="relative z-10 p-8 h-full flex flex-col justify-end text-white">
<div class="w-12 h-12 rounded-lg bg-white/10 backdrop-blur-md border border-white/20 flex items-center justify-center mb-6">
<span class="material-symbols-outlined text-white text-2xl">deployed_code</span>
</div>
<h2 class="text-3xl font-bold leading-tight mb-3">Build Faster.<br/>Scale Infinite.</h2>
<p class="text-white/70 text-sm font-normal leading-relaxed mb-8 max-w-[260px]">
                            Zero uses an advanced query engine to deliver content at the speed of light.
                        </p>
<!-- Progress Indicators -->
<div class="flex items-center gap-2">
<div class="h-1 flex-1 bg-white rounded-full"></div>
<div class="h-1 flex-1 bg-white/20 rounded-full"></div>
<div class="h-1 flex-1 bg-white/20 rounded-full"></div>
</div>
<p class="text-[10px] uppercase tracking-widest text-white/50 mt-2 font-bold">Step 1 of 3: Database</p>
</div>
</div>
<!-- Right Form Column -->
<div class="flex-1 flex flex-col p-6 lg:p-10 overflow-y-auto max-h-[90vh]">
<!-- Header -->
<div class="flex flex-col gap-2 mb-10">
<div class="flex items-center gap-2 text-primary mb-2">
<span class="material-symbols-outlined text-3xl">bolt</span>
<span class="text-xl font-black tracking-tighter uppercase text-slate-900 dark:text-white">Zero</span>
</div>
<h1 class="text-[#0d121c] dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">Welcome to the Future of Content</h1>
<p class="text-[#49659c] dark:text-slate-400 text-base font-normal leading-normal">
                            Configure your database to initialize the high-performance core.
                        </p>
</div>

<?php if ($error): ?>
<!-- Error Message -->
<div class="mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/30 flex items-start gap-3">
    <span class="material-symbols-outlined text-red-500 text-xl mt-0.5">error</span>
    <div>
        <p class="text-red-600 dark:text-red-400 font-semibold text-sm">Installation Failed</p>
        <p class="text-red-500/80 dark:text-red-400/80 text-sm mt-1"><?= htmlspecialchars($error) ?></p>
    </div>
</div>
<?php endif; ?>

<!-- Form Fields -->
<form class="flex flex-col gap-6" method="POST" action="">
<!-- Row 1: Host -->
<label class="flex flex-col gap-2 group">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Database Host</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">dns</span>
</div>
<input name="db_host" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="localhost" type="text" value="<?= htmlspecialchars($_POST['db_host'] ?? 'localhost') ?>"/>
</div>
</label>
<!-- Row 2: DB Name -->
<label class="flex flex-col gap-2 group">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Database Name</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">database</span>
</div>
<input name="db_name" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="zero_db" type="text" value="<?= htmlspecialchars($_POST['db_name'] ?? '') ?>"/>
</div>
</label>
<!-- Row 3: User & Pass (2 Columns) -->
<div class="flex flex-col sm:flex-row gap-6">
<label class="flex flex-col gap-2 flex-1 min-w-[200px]">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Database User</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">person</span>
</div>
<input name="db_user" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="username" type="text" value="<?= htmlspecialchars($_POST['db_user'] ?? 'root') ?>"/>
</div>
</label>
<label class="flex flex-col gap-2 flex-1 min-w-[200px]">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Database Password</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">key</span>
</div>
<input name="db_pass" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="••••••••" type="password" value=""/>
</div>
</label>
</div>

<!-- Separator -->
<div class="flex items-center gap-4 my-2">
<div class="flex-1 h-px bg-slate-200 dark:bg-slate-700"></div>
<span class="text-xs text-slate-400 uppercase tracking-wider font-semibold">Admin Account</span>
<div class="flex-1 h-px bg-slate-200 dark:bg-slate-700"></div>
</div>

<!-- Row 4: Admin Email -->
<label class="flex flex-col gap-2 group">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Admin Email</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">mail</span>
</div>
<input name="admin_email" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="admin@example.com" type="email" value="<?= htmlspecialchars($_POST['admin_email'] ?? '') ?>"/>
</div>
</label>

<!-- Row 5: Admin Password -->
<label class="flex flex-col gap-2 group">
<p class="text-[#0d121c] dark:text-slate-200 text-sm font-bold uppercase tracking-wide">Admin Password</p>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-slate-400">
<span class="material-symbols-outlined text-[20px]">lock</span>
</div>
<input name="admin_pass" class="form-input-transition flex w-full rounded-lg border border-[#ced7e8] dark:border-slate-600 bg-background-light dark:bg-slate-800/50 h-14 pl-12 pr-4 text-base text-[#0d121c] dark:text-white placeholder:text-[#49659c] dark:placeholder:text-slate-500 focus:outline-0 focus:ring-2 focus:ring-primary/20 focus:border-primary" placeholder="Min 6 characters" type="password" value=""/>
</div>
</label>

<!-- Action Button -->
<div class="pt-4">
<button type="submit" class="relative w-full overflow-hidden rounded-xl h-14 bg-gradient-to-r from-primary to-purple-600 text-[#f8f9fc] text-lg font-bold tracking-wide shadow-lg shadow-primary/30 hover:shadow-primary/50 hover:scale-[1.01] active:scale-[0.99] transition-all duration-200 group">
<div class="absolute inset-0 bg-white/0 group-hover:bg-white/10 transition-colors duration-200"></div>
<div class="flex items-center justify-center gap-3 relative z-10">
<span class="material-symbols-outlined text-[24px]">rocket_launch</span>
<span>Ignite Engine</span>
</div>
</button>
</div>
</form>
<!-- Footer Help -->
<div class="mt-auto pt-8 flex justify-center">
<a class="inline-flex items-center gap-2 text-sm text-slate-400 hover:text-primary transition-colors font-medium" href="#">
<span class="material-symbols-outlined text-[18px]">help</span>
<span>Trouble connecting?</span>
</a>
</div>
</div>
</div>
</div>
</div>
</body></html>


==================================================
FILE PATH: .\content\addons\admin_addon.php
==================================================

<?php

declare(strict_types=1);

/**
 * Admin Addon - Handles admin routes
 * 
 * Routes:
 * - /admin/login  -> Login page
 * - /admin        -> Dashboard (requires auth)
 * - /admin/dashboard -> Dashboard alias
 * - ?logout=true  -> Logout handler
 */

use Core\Event;
use Core\Router;
use Core\Auth;
use Core\Database;

// Register admin routes
Event::on('route_request', function (array $request): void {
    $uri = $request['uri'];
    $themePath = __DIR__ . '/../themes/admin-default';

    // /admin/logout - Logout and redirect
    if ($uri === '/admin/logout') {
        Auth::logout();
        Router::redirect('/admin/login');
    }

    // Legacy logout via query param (/?logout=true)
    if (isset($_GET['logout']) && $_GET['logout'] === 'true') {
        Auth::logout();
        Router::redirect('/admin/login');
    }

    // /admin/login
    if ($uri === '/admin/login') {
        // If already logged in, redirect to dashboard
        if (Auth::check()) {
            Router::redirect('/admin');
        }
        
        ob_start();
        require $themePath . '/login.php';
        $content = ob_get_clean();
        Router::setHandled($content);
        return;
    }

    // /admin or /admin/dashboard - requires auth
    if ($uri === '/admin' || $uri === '/admin/dashboard') {
        // Check authentication
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        // Fetch real stats for dashboard
        try {
            $db = Database::getInstance();
            
            // Count pages
            $total_pages = $db->queryValue(
                "SELECT COUNT(*) FROM zero_content WHERE type = :type",
                ['type' => 'page']
            ) ?: 0;
            
            // Count posts
            $total_posts = $db->queryValue(
                "SELECT COUNT(*) FROM zero_content WHERE type = :type",
                ['type' => 'post']
            ) ?: 0;
            
            // Count all content
            $total_content = $db->queryValue(
                "SELECT COUNT(*) FROM zero_content"
            ) ?: 0;
            
            // Count users
            $total_users = $db->queryValue(
                "SELECT COUNT(*) FROM users"
            ) ?: 0;
            
            // Count addons
            $addons_dir = __DIR__;
            $total_addons = count(glob($addons_dir . '/*.php'));
            
        } catch (Exception $e) {
            $total_pages = 0;
            $total_posts = 0;
            $total_content = 0;
            $total_users = 0;
            $total_addons = 0;
        }
        
        // System status
        $system_status = 'Optimal';
        
        // Get current user
        $current_user = Auth::user();
        
        ob_start();
        require $themePath . '/dashboard.php';
        $content = ob_get_clean();
        Router::setHandled($content);
        return;
    }

    // /admin/content - Content list (requires auth)
    if ($uri === '/admin/content') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        ob_start();
        require $themePath . '/content-list.php';
        $content = ob_get_clean();
        Router::setHandled($content);
        return;
    }

    // /admin/editor - Content editor (requires auth)
    if ($uri === '/admin/editor') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        ob_start();
        require $themePath . '/editor.php';
        $content = ob_get_clean();
        Router::setHandled($content);
        return;
    }

    // /admin/settings - Settings page (requires auth)
    if ($uri === '/admin/settings') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        // Placeholder page
        $content = '<!DOCTYPE html><html><head><title>Settings - Zero CMS</title></head><body style="font-family:Inter,sans-serif;padding:40px;"><h1>Settings</h1><p>Settings page coming soon.</p><a href="' . \Core\Router::url('/admin') . '">← Back to Dashboard</a></body></html>';
        Router::setHandled($content);
        return;
    }

    // /admin/addons - Addons page (requires auth)
    if ($uri === '/admin/addons') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        $content = '<!DOCTYPE html><html><head><title>Addons - Zero CMS</title></head><body style="font-family:Inter,sans-serif;padding:40px;"><h1>Addons</h1><p>Addons manager coming soon.</p><a href="' . \Core\Router::url('/admin') . '">← Back to Dashboard</a></body></html>';
        Router::setHandled($content);
        return;
    }

    // /admin/media - Media library (requires auth)
    if ($uri === '/admin/media') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        $content = '<!DOCTYPE html><html><head><title>Media - Zero CMS</title></head><body style="font-family:Inter,sans-serif;padding:40px;"><h1>Media Library</h1><p>Media manager coming soon.</p><a href="' . \Core\Router::url('/admin') . '">← Back to Dashboard</a></body></html>';
        Router::setHandled($content);
        return;
    }

    // /admin/users - Users page (requires auth)
    if ($uri === '/admin/users') {
        if (!Auth::check()) {
            Router::redirect('/admin/login');
        }
        
        $content = '<!DOCTYPE html><html><head><title>Users - Zero CMS</title></head><body style="font-family:Inter,sans-serif;padding:40px;"><h1>Users</h1><p>User management coming soon.</p><a href="' . \Core\Router::url('/admin') . '">← Back to Dashboard</a></body></html>';
        Router::setHandled($content);
        return;
    }

    // /admin/api/save - Save content API (POST)
    if ($uri === '/admin/api/save' && $request['method'] === 'POST') {
        header('Content-Type: application/json');
        
        if (!Auth::check()) {
            echo json_encode(['success' => false, 'error' => 'Not authenticated']);
            Router::setHandled('');
            return;
        }
        
        try {
            // Get JSON input
            $input = json_decode(file_get_contents('php://input'), true);
            
            if (!$input) {
                throw new Exception('Invalid JSON input');
            }
            
            $db = Database::getInstance();
            
            $id = $input['id'] ?? null;
            $title = trim($input['title'] ?? '');
            $slug = trim($input['slug'] ?? '');
            $type = $input['type'] ?? 'page';
            $data = $input['data'] ?? [];
            
            if (empty($title)) {
                throw new Exception('Title is required');
            }
            
            // Auto-generate slug if empty
            if (empty($slug)) {
                $slug = preg_replace('/[^a-z0-9]+/', '-', strtolower($title));
                $slug = trim($slug, '-');
            }
            
            // Encode data as JSON
            $dataJson = json_encode($data);
            
            if ($id) {
                // Update existing
                $db->query(
                    "UPDATE zero_content SET title = :title, slug = :slug, type = :type, data = :data, updated_at = NOW() WHERE id = :id",
                    ['id' => $id, 'title' => $title, 'slug' => $slug, 'type' => $type, 'data' => $dataJson]
                );
                echo json_encode(['success' => true, 'id' => $id, 'message' => 'Content updated']);
            } else {
                // Insert new
                $newId = $db->query(
                    "INSERT INTO zero_content (title, slug, type, data, created_at, updated_at) VALUES (:title, :slug, :type, :data, NOW(), NOW())",
                    ['title' => $title, 'slug' => $slug, 'type' => $type, 'data' => $dataJson]
                );
                echo json_encode(['success' => true, 'id' => $newId, 'message' => 'Content created']);
            }
            
        } catch (Exception $e) {
            echo json_encode(['success' => false, 'error' => $e->getMessage()]);
        }
        
        Router::setHandled('');
        return;
    }

    // /admin/api/upload - Image upload for Editor.js (POST)
    if ($uri === '/admin/api/upload' && $request['method'] === 'POST') {
        header('Content-Type: application/json');
        
        // Check authentication
        if (!Auth::check()) {
            echo json_encode(['success' => 0, 'error' => 'Not authenticated']);
            Router::setHandled('');
            return;
        }
        
        try {
            // Check if file was uploaded
            if (!isset($_FILES['image']) || $_FILES['image']['error'] !== UPLOAD_ERR_OK) {
                throw new Exception('No file uploaded or upload error');
            }
            
            $file = $_FILES['image'];
            
            // Validate file size (5MB max)
            $maxSize = 5 * 1024 * 1024; // 5MB
            if ($file['size'] > $maxSize) {
                throw new Exception('File too large. Maximum size is 5MB');
            }
            
            // Validate file type
            $allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];
            $finfo = finfo_open(FILEINFO_MIME_TYPE);
            $mimeType = finfo_file($finfo, $file['tmp_name']);
            finfo_close($finfo);
            
            if (!in_array($mimeType, $allowedTypes)) {
                throw new Exception('Invalid file type. Only JPG, PNG, WebP, and GIF are allowed');
            }
            
            // Get file extension
            $extensions = [
                'image/jpeg' => 'jpg',
                'image/png' => 'png',
                'image/webp' => 'webp',
                'image/gif' => 'gif'
            ];
            $ext = $extensions[$mimeType] ?? 'jpg';
            
            // Create uploads directory if it doesn't exist
            $uploadDir = dirname(__DIR__) . '/uploads';
            if (!is_dir($uploadDir)) {
                mkdir($uploadDir, 0755, true);
            }
            
            // Generate unique filename
            $filename = md5(uniqid() . time() . $file['name']) . '.' . $ext;
            $filepath = $uploadDir . '/' . $filename;
            
            // Move uploaded file
            if (!move_uploaded_file($file['tmp_name'], $filepath)) {
                throw new Exception('Failed to save uploaded file');
            }
            
            // Build the public URL
            $basePath = Router::getBasePath();
            $protocol = (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off') ? 'https' : 'http';
            $host = $_SERVER['HTTP_HOST'] ?? 'localhost';
            $publicUrl = $protocol . '://' . $host . $basePath . '/content/uploads/' . $filename;
            
            // Return success in Editor.js format
            echo json_encode([
                'success' => 1,
                'file' => [
                    'url' => $publicUrl
                ]
            ]);
            
        } catch (Exception $e) {
            echo json_encode([
                'success' => 0,
                'error' => $e->getMessage()
            ]);
        }
        
        Router::setHandled('');
        return;
    }

}, 10);



==================================================
FILE PATH: .\content\addons\test_addon.php
==================================================

<?php

declare(strict_types=1);

/**
 * Test Addon - Proof of Concept
 * 
 * Demonstrates the event-driven architecture of Zero CMS.
 * Listen to 'route_request' and claim the /hello URL.
 */

use Core\Event;
use Core\Router;

// Register our listener for route requests
Event::on('route_request', function (array $request): void {
    // Check if this is our URL
    if ($request['uri'] === '/hello') {
        // We own this URL! Return our message.
        Router::setHandled('Antigravity CMS is Alive');
    }
}, 10);



==================================================
FILE PATH: .\content\themes\admin-default\content-list.php
==================================================

<?php
/**
 * Zero CMS Content List
 * 
 * Displays all content from zero_content table
 */

use Core\Auth;
use Core\Database;
use Core\Router;

// Check authentication
if (!Auth::check()) {
    Router::redirect('/admin/login');
}

// Get base URL for links
$base_url = Router::getBasePath();

// Fetch content from database
try {
    $db = Database::getInstance();
    $posts = $db->query(
        "SELECT * FROM zero_content ORDER BY updated_at DESC LIMIT 50"
    );
} catch (Exception $e) {
    $posts = [];
}

// Get current user
$current_user = Auth::user();

// Helper function to get type badge color
function getTypeBadgeClass($type) {
    return match($type) {
        'page' => 'bg-blue-50 text-blue-700 border-blue-100',
        'post' => 'bg-purple-50 text-purple-700 border-purple-100',
        'product' => 'bg-orange-50 text-orange-700 border-orange-100',
        default => 'bg-gray-50 text-gray-700 border-gray-100',
    };
}

// Helper to get status from data JSON
function getStatus($post) {
    if (isset($post['data'])) {
        $data = is_string($post['data']) ? json_decode($post['data'], true) : $post['data'];
        return $data['status'] ?? 'published';
    }
    return 'published';
}
?>
<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Zero CMS Content Manager</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#256af4",
              "background-light": "#f5f6f8",
              "background-dark": "#101622",
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"],
              "mono": ["ui-monospace", "SFMono-Regular", "Menlo", "Monaco", "Consolas", "Liberation Mono", "Courier New", "monospace"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
        /* Custom scrollbar for table if needed */
        .custom-scrollbar::-webkit-scrollbar {
            height: 6px;
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-[#0d121c] dark:text-white font-display antialiased min-h-screen flex flex-col">
<!-- Main Layout -->
<div class="layout-container flex flex-col flex-1 w-full max-w-[1280px] mx-auto px-6 py-8">
<!-- Header Section -->
<div class="flex flex-col gap-6 mb-6">
<div class="flex flex-wrap items-center justify-between gap-4">
<h1 class="text-2xl font-bold tracking-tight text-[#0d121c] dark:text-white">Content Library</h1>
<a href="<?= $base_url ?>/admin/editor?new=true" class="flex items-center gap-2 bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
<span class="material-symbols-outlined text-[20px]">add</span>
<span>New Entry</span>
</a>
</div>
<!-- Toolbar: Search & Filter -->
<div class="flex flex-wrap items-center gap-3 w-full">
<!-- Search -->
<div class="relative w-full max-w-sm group">
<span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#49659c] pointer-events-none group-focus-within:text-primary transition-colors">
<span class="material-symbols-outlined text-[20px]">search</span>
</span>
<input class="w-full pl-10 pr-4 py-2.5 bg-white dark:bg-[#1a202c] border border-gray-200 dark:border-gray-700 rounded-lg text-sm placeholder:text-gray-400 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all shadow-sm" placeholder="Search content..." type="text"/>
</div>
<!-- Filter Dropdown -->
<div class="relative w-full max-w-[180px]">
<span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#49659c] pointer-events-none">
<span class="material-symbols-outlined text-[20px]">filter_list</span>
</span>
<select class="w-full pl-10 pr-8 py-2.5 bg-white dark:bg-[#1a202c] border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-[#0d121c] dark:text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary appearance-none cursor-pointer shadow-sm transition-all">
<option value="">All Types</option>
<option value="page">Page</option>
<option value="post">Post</option>
<option value="product">Product</option>
</select>
<span class="absolute right-3 top-1/2 -translate-y-1/2 text-[#49659c] pointer-events-none">
<span class="material-symbols-outlined text-[20px]">expand_more</span>
</span>
</div>
</div>
</div>
<!-- Data Grid -->
<div class="flex-1 flex flex-col bg-white dark:bg-[#1a202c] rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
<div class="overflow-x-auto custom-scrollbar">
<table class="w-full min-w-[900px]">
<thead>
<tr class="border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50">
<th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-[25%]">Title</th>
<th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-[20%]">Slug</th>
<th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-[10%]">Type</th>
<th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-[15%]">Status</th>
<th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-[15%]">Date</th>
<th class="px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider w-[15%]">Actions</th>
</tr>
</thead>
<tbody class="divide-y divide-gray-100 dark:divide-gray-800">
<?php if (empty($posts)): ?>
<tr>
<td colspan="6" class="px-6 py-12 text-center">
<div class="flex flex-col items-center gap-3">
<span class="material-symbols-outlined text-4xl text-gray-300">folder_open</span>
<p class="text-gray-500">No content found</p>
<a href="<?= $base_url ?>/admin/editor?new=true" class="text-primary hover:underline text-sm font-medium">Create your first entry</a>
</div>
</td>
</tr>
<?php else: ?>
<?php foreach ($posts as $post): 
    $status = getStatus($post);
    $typeBadgeClass = getTypeBadgeClass($post['type']);
    $date = date('M d, Y', strtotime($post['updated_at'] ?? $post['created_at']));
?>
<tr class="group/row hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors">
<td class="px-6 py-4 whitespace-nowrap">
<span class="text-sm font-bold text-[#0d121c] dark:text-white"><?= htmlspecialchars($post['title']) ?></span>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="text-xs font-mono text-gray-500 dark:text-gray-400">/<?= htmlspecialchars($post['slug']) ?></span>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <?= $typeBadgeClass ?> border">
    <?= ucfirst(htmlspecialchars($post['type'])) ?>
</span>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<div class="flex items-center gap-2">
<?php if ($status === 'published'): ?>
<span class="relative flex h-2 w-2">
<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
<span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
</span>
<span class="text-sm text-gray-600 dark:text-gray-300">Live</span>
<?php elseif ($status === 'draft'): ?>
<span class="h-2 w-2 rounded-full bg-amber-400"></span>
<span class="text-sm text-gray-600 dark:text-gray-300">Draft</span>
<?php else: ?>
<span class="h-2 w-2 rounded-full bg-gray-300"></span>
<span class="text-sm text-gray-600 dark:text-gray-300"><?= ucfirst($status) ?></span>
<?php endif; ?>
</div>
</td>
<td class="px-6 py-4 whitespace-nowrap">
<span class="text-sm text-gray-500"><?= $date ?></span>
</td>
<td class="px-6 py-4 whitespace-nowrap text-right">
<div class="opacity-0 group-hover/row:opacity-100 transition-opacity flex items-center justify-end gap-2">
<a href="<?= $base_url ?>/admin/editor?id=<?= $post['id'] ?>" class="p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md text-gray-500 hover:text-primary transition-colors" title="Edit">
<span class="material-symbols-outlined text-[18px]">edit</span>
</a>
<button class="p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md text-gray-500 hover:text-red-600 transition-colors" title="Delete" onclick="if(confirm('Delete this content?')) window.location.href='<?= $base_url ?>/admin/content/delete?id=<?= $post['id'] ?>'">
<span class="material-symbols-outlined text-[18px]">delete</span>
</button>
</div>
</td>
</tr>
<?php endforeach; ?>
<?php endif; ?>
</tbody>
</table>
</div>
<!-- Pagination -->
<div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50/30 dark:bg-gray-800/30 flex items-center justify-between">
<span class="text-sm text-gray-500">
    Showing <?= count($posts) ?> entries
</span>
<div class="flex items-center gap-4">
<div class="flex items-center gap-1">
<button class="flex items-center justify-center h-8 px-3 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 text-gray-600 text-sm font-medium transition-colors disabled:opacity-50 shadow-sm" disabled="">
                            Previous
                        </button>
<button class="flex items-center justify-center h-8 px-3 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 text-gray-600 text-sm font-medium transition-colors shadow-sm">
                            Next
                        </button>
</div>
</div>
</div>
</div>
</div>
</body></html>


==================================================
FILE PATH: .\content\themes\admin-default\dashboard.php
==================================================

<?php
/**
 * Zero CMS Admin Dashboard
 * 
 * Variables available from admin_addon.php:
 * - $total_pages, $total_posts, $total_content, $total_users, $total_addons
 * - $system_status, $current_user
 */

use Core\Router;

// Ensure variables are set (fallback for direct access)
$total_pages = $total_pages ?? 0;
$total_posts = $total_posts ?? 0;
$total_content = $total_content ?? 0;
$total_users = $total_users ?? 0;
$total_addons = $total_addons ?? 0;
$system_status = $system_status ?? 'Unknown';
$current_user = $current_user ?? ['email' => 'Guest', 'role' => 'guest'];

// Extract user display info
$user_email = $current_user['email'] ?? 'admin@zero.local';
$user_role = ucfirst($current_user['role'] ?? 'Admin');
$user_initials = strtoupper(substr($user_email, 0, 2));

// Generate URLs with base path
$base_url = Router::getBasePath();
?>
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Zero CMS Command Center</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&amp;family=Noto+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "primary": "#4f46e5",
              "primary-hover": "#4338ca",
              "text-main": "#111827",
              "text-secondary": "#6b7280",
              "accent-blue": "#2563eb",
              "accent-purple": "#7c3aed",
              "accent-green": "#10b981",
              "accent-orange": "#f97316",
            },
            fontFamily: {
              "display": ["Space Grotesk", "sans-serif"],
              "body": ["Noto Sans", "sans-serif"],
            },
          },
        },
      }
    </script>
</head>
<body class="font-body text-slate-800 bg-gray-50 h-screen flex overflow-hidden">
<aside class="w-[250px] bg-white border-r border-gray-200 flex flex-col flex-shrink-0 z-30">
<div class="h-20 flex items-center px-8 border-b border-gray-100">
<div class="flex items-center gap-3">
<div class="w-8 h-8 bg-black text-white rounded flex items-center justify-center font-display font-bold text-xl rotate-45">
<span class="-rotate-45">Z</span>
</div>
<span class="font-display font-bold text-2xl tracking-tight text-gray-900">ZERO</span>
</div>
</div>
<nav class="flex-1 py-8 space-y-1">
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-accent-purple bg-purple-50 text-accent-purple font-medium group transition-colors" href="<?= $base_url ?>/admin">
<span class="material-symbols-outlined text-[22px]">dashboard</span>
<span>Dashboard</span>
</a>
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-transparent text-gray-500 hover:text-gray-900 hover:bg-gray-50 font-medium transition-colors group" href="<?= $base_url ?>/admin/content">
<span class="material-symbols-outlined text-[22px] group-hover:text-gray-700">article</span>
<span>Content</span>
</a>
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-transparent text-gray-500 hover:text-gray-900 hover:bg-gray-50 font-medium transition-colors group" href="<?= $base_url ?>/admin/media">
<span class="material-symbols-outlined text-[22px] group-hover:text-gray-700">perm_media</span>
<span>Media</span>
</a>
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-transparent text-gray-500 hover:text-gray-900 hover:bg-gray-50 font-medium transition-colors group" href="<?= $base_url ?>/admin/users">
<span class="material-symbols-outlined text-[22px] group-hover:text-gray-700">group</span>
<span>Users</span>
</a>
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-transparent text-gray-500 hover:text-gray-900 hover:bg-gray-50 font-medium transition-colors group" href="<?= $base_url ?>/admin/addons">
<span class="material-symbols-outlined text-[22px] group-hover:text-gray-700">extension</span>
<span>Addons</span>
</a>
<a class="flex items-center gap-3 px-6 py-3.5 border-l-4 border-transparent text-gray-500 hover:text-gray-900 hover:bg-gray-50 font-medium transition-colors group" href="<?= $base_url ?>/admin/settings">
<span class="material-symbols-outlined text-[22px] group-hover:text-gray-700">settings</span>
<span>Settings</span>
</a>
</nav>
<div class="p-6 border-t border-gray-100 space-y-3">
<div class="flex items-center gap-3 p-3 rounded-lg bg-gray-50 border border-gray-100 cursor-pointer hover:bg-gray-100 transition-colors">
<span class="material-symbols-outlined text-gray-500">help</span>
<span class="text-sm font-medium text-gray-600">Support Center</span>
</div>
<!-- Logout Button -->
<a href="<?= $base_url ?>/admin/logout" class="flex items-center gap-3 p-3 rounded-lg bg-red-50 border border-red-100 cursor-pointer hover:bg-red-100 transition-colors group">
<span class="material-symbols-outlined text-red-500 group-hover:text-red-600">logout</span>
<span class="text-sm font-medium text-red-600 group-hover:text-red-700">Logout</span>
</a>
</div>
</aside>
<main class="flex-1 flex flex-col min-w-0 overflow-hidden relative">
<header class="h-20 bg-white border-b border-gray-200 flex items-center justify-between px-8 flex-shrink-0 z-20 shadow-sm">
<div class="flex items-center text-sm font-medium text-gray-500">
<span class="hover:text-gray-900 cursor-pointer transition-colors">Home</span>
<span class="material-symbols-outlined text-[16px] mx-2 text-gray-400">chevron_right</span>
<span class="text-gray-900">Dashboard</span>
</div>
<div class="flex items-center gap-6">
<button class="hidden sm:flex items-center gap-2 bg-accent-blue hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-semibold text-sm transition-all shadow-md shadow-blue-200 hover:shadow-blue-300 active:scale-95">
<span class="material-symbols-outlined text-[20px]">add</span>
                New Post
            </button>
<div class="h-8 w-[1px] bg-gray-200 hidden sm:block"></div>
<div class="flex items-center gap-3 cursor-pointer">
<div class="text-right hidden md:block">
<p class="text-sm font-semibold text-gray-900"><?= htmlspecialchars($user_email) ?></p>
<p class="text-xs text-gray-500"><?= htmlspecialchars($user_role) ?></p>
</div>
<div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold ring-4 ring-gray-50">
                    <?= htmlspecialchars($user_initials) ?>
                </div>
</div>
</div>
</header>
<div class="flex-1 overflow-y-auto p-6 lg:p-10 bg-gray-50">
<!-- Stats Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-8">
<!-- Total Pages Card -->
<div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
<div class="flex justify-between items-start mb-2">
<h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide">Total Pages</h3>
<div class="p-1.5 bg-purple-50 rounded-md text-purple-600">
<span class="material-symbols-outlined text-[20px]">description</span>
</div>
</div>
<div class="flex items-end justify-between">
<div>
<div class="text-4xl font-display font-bold text-gray-900"><?= number_format($total_pages) ?></div>
<p class="text-xs text-gray-500 font-medium mt-1">Published pages</p>
</div>
</div>
<div class="absolute bottom-0 right-0 w-1/2 h-16 opacity-30 group-hover:opacity-50 transition-opacity">
<svg class="w-full h-full text-purple-600 fill-current" preserveAspectRatio="none" viewBox="0 0 100 40">
<path d="M0 30 Q 10 35 20 20 T 40 10 T 60 25 T 80 15 T 100 5 L 100 40 L 0 40 Z"></path>
</svg>
</div>
</div>
<!-- System Health Card -->
<div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
<div class="flex justify-between items-start mb-2">
<h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide">System Health</h3>
<div class="p-1.5 bg-green-50 rounded-md text-green-600">
<span class="material-symbols-outlined text-[20px]">monitor_heart</span>
</div>
</div>
<div class="flex items-end justify-between">
<div>
<div class="text-4xl font-display font-bold text-gray-900"><?= htmlspecialchars($system_status) ?></div>
<p class="text-xs text-gray-400 font-medium mt-1">All systems running</p>
</div>
</div>
<div class="absolute bottom-0 right-0 w-1/2 h-16 opacity-30 group-hover:opacity-50 transition-opacity">
<svg class="w-full h-full text-green-500 fill-current" preserveAspectRatio="none" viewBox="0 0 100 40">
<path d="M0 35 L 20 35 L 30 10 L 40 35 L 60 35 L 70 20 L 80 35 L 100 35 L 100 40 L 0 40 Z"></path>
</svg>
</div>
</div>
<!-- Active Addons Card -->
<div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
<div class="flex justify-between items-start mb-2">
<h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide">Active Addons</h3>
<div class="p-1.5 bg-blue-50 rounded-md text-blue-600">
<span class="material-symbols-outlined text-[20px]">extension</span>
</div>
</div>
<div class="flex items-end justify-between">
<div>
<div class="text-4xl font-display font-bold text-gray-900"><?= number_format($total_addons) ?></div>
<p class="text-xs text-gray-500 font-medium mt-1">Loaded plugins</p>
</div>
</div>
<div class="absolute bottom-0 right-0 w-1/2 h-16 opacity-30 group-hover:opacity-50 transition-opacity">
<svg class="w-full h-full text-blue-500 fill-current" preserveAspectRatio="none" viewBox="0 0 100 40">
<path d="M0 25 C 20 25, 30 15, 50 15 S 80 30, 100 10 L 100 40 L 0 40 Z"></path>
</svg>
</div>
</div>
<!-- Total Users Card -->
<div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
<div class="flex justify-between items-start mb-2">
<h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide">Total Users</h3>
<div class="p-1.5 bg-orange-50 rounded-md text-orange-600">
<span class="material-symbols-outlined text-[20px]">group</span>
</div>
</div>
<div class="flex items-end justify-between">
<div>
<div class="text-4xl font-display font-bold text-gray-900"><?= number_format($total_users) ?></div>
<p class="text-xs text-gray-500 font-medium mt-1">Registered users</p>
</div>
</div>
<div class="absolute bottom-0 right-0 w-1/2 h-16 opacity-30 group-hover:opacity-50 transition-opacity">
<svg class="w-full h-full text-orange-400 fill-current" preserveAspectRatio="none" viewBox="0 0 100 40">
<path d="M0 30 L 15 25 L 30 28 L 45 15 L 60 18 L 75 10 L 90 12 L 100 5 L 100 40 L 0 40 Z"></path>
</svg>
</div>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
<div class="lg:col-span-2 bg-white rounded-xl border border-gray-200 p-6 shadow-sm">
<div class="flex justify-between items-center mb-6">
<h2 class="text-lg font-bold font-display text-gray-900">Traffic Overview</h2>
<div class="flex items-center gap-2">
<select class="text-xs border-gray-200 rounded-md text-gray-500 focus:ring-accent-purple focus:border-accent-purple">
<option>Last 7 Days</option>
<option>Last 30 Days</option>
</select>
<button class="p-1 hover:bg-gray-100 rounded text-gray-400">
<span class="material-symbols-outlined text-[20px]">more_horiz</span>
</button>
</div>
</div>
<div class="w-full h-[300px] relative">
<div class="absolute inset-0 flex flex-col justify-between text-xs text-gray-400">
<div class="border-b border-gray-100 pb-1 w-full flex items-end"><span>10k</span></div>
<div class="border-b border-gray-100 pb-1 w-full flex items-end"><span>7.5k</span></div>
<div class="border-b border-gray-100 pb-1 w-full flex items-end"><span>5k</span></div>
<div class="border-b border-gray-100 pb-1 w-full flex items-end"><span>2.5k</span></div>
<div class="border-b border-gray-100 pb-1 w-full flex items-end"><span>0</span></div>
</div>
<svg class="absolute inset-0 w-full h-full overflow-visible" preserveAspectRatio="none" viewBox="0 0 100 100">
<defs>
<linearGradient id="chartGradient" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#8b5cf6" stop-opacity="0.2"></stop>
<stop offset="100%" stop-color="#8b5cf6" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M0 80 C 10 75, 15 60, 25 65 S 35 40, 50 45 S 65 20, 75 30 S 90 10, 100 25 L 100 100 L 0 100 Z" fill="url(#chartGradient)"></path>
<path d="M0 80 C 10 75, 15 60, 25 65 S 35 40, 50 45 S 65 20, 75 30 S 90 10, 100 25" fill="none" stroke="#7c3aed" stroke-width="0.8" vector-effect="non-scaling-stroke"></path>
<circle cx="25" cy="65" fill="white" r="1" stroke="#7c3aed" stroke-width="0.5"></circle>
<circle cx="50" cy="45" fill="white" r="1" stroke="#7c3aed" stroke-width="0.5"></circle>
<circle cx="75" cy="30" fill="white" r="1" stroke="#7c3aed" stroke-width="0.5"></circle>
</svg>
</div>
<div class="flex justify-between mt-4 text-xs text-gray-400 px-2">
<span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
</div>
</div>
<div class="bg-white rounded-xl border border-gray-200 p-6 shadow-sm flex flex-col">
<div class="flex justify-between items-center mb-6">
<h2 class="text-lg font-bold font-display text-gray-900">System Events</h2>
<a class="text-xs font-semibold text-accent-blue hover:text-blue-700" href="#">View All</a>
</div>
<div class="flex-1 overflow-y-auto pr-2">
<ul class="space-y-6">
<li class="relative pl-6 border-l border-gray-100 pb-1">
<div class="absolute left-[-5px] top-[6px] w-2.5 h-2.5 rounded-full bg-green-500 ring-4 ring-white"></div>
<div class="flex justify-between items-start">
<div>
<p class="text-sm font-semibold text-gray-800">System Initialized</p>
<p class="text-xs text-gray-500 mt-0.5">Zero CMS core loaded successfully.</p>
</div>
<span class="text-[10px] text-gray-400 font-medium whitespace-nowrap">Just now</span>
</div>
</li>
<li class="relative pl-6 border-l border-gray-100 pb-1">
<div class="absolute left-[-5px] top-[6px] w-2.5 h-2.5 rounded-full bg-blue-500 ring-4 ring-white"></div>
<div class="flex justify-between items-start">
<div>
<p class="text-sm font-semibold text-gray-800">User Login</p>
<p class="text-xs text-gray-500 mt-0.5"><?= htmlspecialchars($user_email) ?> logged in</p>
</div>
<span class="text-[10px] text-gray-400 font-medium whitespace-nowrap">Just now</span>
</div>
</li>
<li class="relative pl-6 border-l border-gray-100 pb-1">
<div class="absolute left-[-5px] top-[6px] w-2.5 h-2.5 rounded-full bg-purple-500 ring-4 ring-white"></div>
<div class="flex justify-between items-start">
<div>
<p class="text-sm font-semibold text-gray-800"><?= $total_addons ?> Addons Loaded</p>
<p class="text-xs text-gray-500 mt-0.5">All plugins initialized.</p>
</div>
<span class="text-[10px] text-gray-400 font-medium whitespace-nowrap">Startup</span>
</div>
</li>
<li class="relative pl-6 border-l border-transparent">
<div class="absolute left-[-5px] top-[6px] w-2.5 h-2.5 rounded-full bg-gray-300 ring-4 ring-white"></div>
<div class="flex justify-between items-start">
<div>
<p class="text-sm font-semibold text-gray-800">Database Connected</p>
<p class="text-xs text-gray-500 mt-0.5">MySQL connection established.</p>
</div>
<span class="text-[10px] text-gray-400 font-medium whitespace-nowrap">Startup</span>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</main>

</body></html>


==================================================
FILE PATH: .\content\themes\admin-default\editor.php
==================================================

<?php
/**
 * Zero CMS Editor (React + Tiptap Version)
 * 
 * Uses the built frontend bundle from _frontend/
 */

use Core\Auth;
use Core\Database;
use Core\Router;

// Check authentication
if (!Auth::check()) {
    Router::redirect('/admin/login');
}

// Get base URL for links
$base_url = Router::getBasePath();

// Initialize variables
$post = null;
$post_id = $_GET['id'] ?? '';
$is_new = isset($_GET['new']) && $_GET['new'] === 'true';
$jsonContent = '{}';

// Fetch existing content if editing
if (!empty($post_id) && is_numeric($post_id)) {
    try {
        $db = Database::getInstance();
        $post = $db->queryOne(
            "SELECT * FROM zero_content WHERE id = :id LIMIT 1",
            ['id' => (int)$post_id]
        );
        
        if ($post && !empty($post['data'])) {
            $data = is_string($post['data']) ? json_decode($post['data'], true) : $post['data'];
            // Handle both structure types (content key or direct)
            if (isset($data['content'])) {
                $jsonContent = json_encode($data['content']);
            } else {
                $jsonContent = json_encode($data);
            }
        }
    } catch (Exception $e) {
        $post = null;
        $jsonContent = '{}';
    }
}

// Safe JSON for JS
$initialDataSafe = $jsonContent ?: '{}';
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title><?= $post ? htmlspecialchars($post['title']) : 'New Entry' ?> — Zero CMS</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#256af4",
                        success: "#10b981",
                    },
                    fontFamily: {
                        sans: ["Inter", "sans-serif"],
                        serif: ["Lora", "Georgia", "serif"],
                    },
                },
            },
        }
    </script>
</head>

<body class="bg-gray-50 h-screen overflow-hidden">

<div class="flex h-screen overflow-hidden bg-gray-50">
    <main class="flex-1 h-full overflow-y-auto flex flex-col items-center">
        <!-- Spacer -->
        <div class="h-8 w-full"></div>
        
        <!-- Editor Container -->
        <div id="tiptap-editor" class="w-full max-w-[1100px] mb-20 px-4"></div>
    </main>
    
    <aside class="w-80 h-full bg-white border-l border-gray-200 overflow-y-auto shrink-0 z-20 shadow-sm flex flex-col">
        <div class="p-6 space-y-6">
            <!-- Header / Back Link -->
            <div class="mb-4">
                <a href="<?= $base_url ?>/admin/content" class="text-xs text-gray-500 hover:text-gray-900 flex items-center mb-2">
                     <span class="material-symbols-outlined text-[14px] mr-1">arrow_back</span>
                     Back to Content
                </a>
            </div>

            <!-- Title Input (Adding this back as it was lost in the snippet but essential) -->
             <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Title</label>
                <input 
                    id="post-title" 
                    type="text" 
                    class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm font-bold"
                    value="<?= htmlspecialchars($post['title'] ?? '') ?>"
                    placeholder="Enter title here..."
                >
            </div>

            <!-- Status -->
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Status</label>
                <select id="post-status" class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                    <option value="draft" <?= ($post['data']['status'] ?? '') === 'draft' ? 'selected' : '' ?>>Draft</option>
                    <option value="published" <?= ($post['data']['status'] ?? '') === 'published' ? 'selected' : '' ?>>Published</option>
                </select>
            </div>
            
            <!-- Type (Adding back logic) -->
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Type</label>
                <select id="post-type" class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                    <option value="page" <?= ($post['type'] ?? 'page') === 'page' ? 'selected' : '' ?>>Page</option>
                    <option value="post" <?= ($post['type'] ?? '') === 'post' ? 'selected' : '' ?>>Post</option>
                </select>
            </div>

            <!-- Save Button -->
            <button id="save-btn" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none transition-colors">
                Save Changes
            </button>
            
            <hr class="border-gray-100">
            
            <!-- Slug -->
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">URL Slug</label>
                <input 
                    id="post-slug" 
                    type="text" 
                    class="w-full border-gray-300 rounded-md shadow-sm text-sm" 
                    placeholder="my-post-url"
                    value="<?= htmlspecialchars($post['slug'] ?? '') ?>"
                >
            </div>
            
            <div id="save-feedback" class="text-xs text-center text-gray-500 h-4"></div>
            
            <!-- Categories Section -->
            <div class="border-t border-gray-100 pt-4 mt-4">
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Categories</label>
                <div class="space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded p-2 bg-gray-50">
                    <label class="flex items-center space-x-2 cursor-pointer hover:bg-white rounded px-1">
                        <input type="checkbox" name="categories[]" value="technology" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span class="text-sm text-gray-700">Technology</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer hover:bg-white rounded px-1">
                        <input type="checkbox" name="categories[]" value="tutorials" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span class="text-sm text-gray-700">Tutorials</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer hover:bg-white rounded px-1">
                        <input type="checkbox" name="categories[]" value="updates" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span class="text-sm text-gray-700">Updates</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer hover:bg-white rounded px-1">
                        <input type="checkbox" name="categories[]" value="news" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span class="text-sm text-gray-700">News</span>
                    </label>
                </div>
                <button type="button" class="text-xs text-indigo-600 mt-2 font-medium hover:underline">+ Add New Category</button>
            </div>
            
            <!-- Featured Image Section -->
            <div class="border-t border-gray-100 pt-4 mt-4">
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Featured Image</label>
                <div id="featured-image-drop" class="border-2 border-dashed border-gray-300 rounded-md p-4 flex flex-col items-center justify-center text-center hover:bg-gray-50 hover:border-indigo-400 cursor-pointer transition-colors" onclick="document.getElementById('feat-upload').click()">
                    <div id="featured-preview" class="hidden w-full mb-2">
                        <img id="featured-img" src="" class="w-full h-32 object-cover rounded" alt="Featured">
                    </div>
                    <div id="featured-placeholder">
                        <svg class="h-10 w-10 text-gray-400 mb-2 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <span class="text-xs text-gray-500">Click to upload or drag & drop</span>
                    </div>
                    <input type="file" id="feat-upload" class="hidden" accept="image/*">
                </div>
                <button type="button" id="remove-featured" class="hidden text-xs text-red-500 mt-2 font-medium hover:underline">Remove Image</button>
            </div>
            
            <!-- Excerpt Section -->
            <div class="border-t border-gray-100 pt-4 mt-4">
                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Excerpt</label>
                <textarea id="post-excerpt" rows="3" class="w-full border-gray-300 rounded-md shadow-sm text-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="Write a short summary..."><?= htmlspecialchars($post['data']['excerpt'] ?? '') ?></textarea>
            </div>
        </div>
    </aside>
</div>

<!-- DATA INJECTION -->
<script>
    window.ZERO_INITIAL_CONTENT = <?= $initialDataSafe ?>;
    const postId = "<?= htmlspecialchars($post_id) ?>";
    const baseUrl = "<?= $base_url ?>";
</script>

<!-- REACT BUNDLE -->
<script src="<?= $base_url ?>/content/themes/admin-default/assets/js/editor.bundle.js"></script>

<!-- SAVE & UI LOGIC -->
<script>
// Sync slugs
const titleInput = document.getElementById('post-title');
const slugInput = document.getElementById('post-slug');

function generateSlug(text) {
    return text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
}

if (titleInput && slugInput) {
    titleInput.addEventListener('input', () => {
        if (!postId) {
            slugInput.value = generateSlug(titleInput.value);
        }
    });

    slugInput.addEventListener('input', () => slugInput.value = generateSlug(slugInput.value));
}

// Save Handler
document.getElementById('save-btn').addEventListener('click', async () => {
    const btn = document.getElementById('save-btn');
    const feedback = document.getElementById('save-feedback');
    
    // Loading state
    const originalText = btn.textContent;
    btn.disabled = true;
    btn.textContent = 'Saving...';
    feedback.textContent = '';
    
    try {
        // Get content from React Global Variable
        const editorContent = window.zero_editor_content;
        
        // Construct payload
        const payload = {
            id: postId || null,
            title: titleInput ? titleInput.value.trim() : 'Untitled',
            slug: slugInput ? (slugInput.value.trim() || generateSlug(titleInput.value)) : '',
            type: document.getElementById('post-type').value,
            data: {
                content: editorContent,
                status: document.getElementById('post-status').value
            }
        };
        
        if (!payload.title) {
            alert('Please enter a title');
            throw new Error('Title required');
        }
        
        const res = await fetch(baseUrl + '/admin/api/save', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        
        const result = await res.json();
        
        if (result.success) {
            btn.textContent = 'Saved!';
            feedback.textContent = 'Last saved: ' + new Date().toLocaleTimeString();
            feedback.className = 'text-xs text-center text-green-600 h-4';
            
            if (!postId && result.id) {
                history.pushState(null, '', baseUrl + '/admin/editor?id=' + result.id);
            }
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.disabled = false;
            }, 2000);
        } else {
            throw new Error(result.error || 'Save failed');
        }
        
    } catch (err) {
        console.error('Save error:', err);
        alert('Error: ' + err.message);
        btn.textContent = originalText;
        btn.disabled = false;
        feedback.textContent = 'Save failed';
        feedback.className = 'text-xs text-center text-red-600 h-4';
    }
});
</script>

</body>
</html>


==================================================
FILE PATH: .\content\themes\admin-default\login.php
==================================================

<?php

declare(strict_types=1);

/**
 * Zero CMS Admin Login Page
 */

// Load the autoloader and config
$config = require __DIR__ . '/../../../config.php';

// Autoload core classes
spl_autoload_register(function (string $class): void {
    $prefix = 'Core\\';
    $baseDir = __DIR__ . '/../../../core/';
    $len = strlen($prefix);
    if (strncmp($prefix, $class, $len) !== 0) {
        return;
    }
    $relativeClass = substr($class, $len);
    $file = $baseDir . str_replace('\\', '/', $relativeClass) . '.php';
    if (file_exists($file)) {
        require $file;
    }
});

use Core\Auth;
use Core\Database;
use Core\Router;

// Initialize database
Database::setConfig($config['database']);

// If already logged in, redirect to admin
if (Auth::check()) {
    Router::redirect('/admin');
}

$error = '';

// Handle POST request
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $email = trim($_POST['email'] ?? '');
    $password = $_POST['password'] ?? '';

    if (empty($email) || empty($password)) {
        $error = 'Please enter both email and password.';
    } elseif (Auth::login($email, $password)) {
        // Success! Redirect to admin dashboard
        Router::redirect('/admin');
    } else {
        $error = 'Invalid email or password. Please try again.';
    }
}
?>
<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Zero CMS Login Screen</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&amp;family=Noto+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "primary": "#4f46e5",
              "primary-hover": "#4338ca",
              "text-main": "#111827",
              "text-secondary": "#6b7280",
            },
            fontFamily: {
              "display": ["Space Grotesk", "sans-serif"],
              "body": ["Noto Sans", "sans-serif"],
            },
            backgroundImage: {
                'brand-gradient': 'linear-gradient(135deg, #312e81 0%, #7c3aed 50%, #f97316 100%)',
                'btn-gradient': 'linear-gradient(to right, #4f46e5, #7c3aed)',
            }
          },
        },
      }
    </script>
</head>
<body class="font-body text-slate-800 bg-white min-h-screen flex w-full">
<div class="hidden lg:flex lg:w-1/2 bg-brand-gradient flex-col items-center justify-center relative overflow-hidden text-white p-12">
<div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10 mix-blend-overlay"></div>
<div class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-purple-500 rounded-full blur-[128px] opacity-30"></div>
<div class="absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-orange-400 rounded-full blur-[128px] opacity-30"></div>
<div class="relative z-10 text-center">
<div class="mb-6">
<div class="w-20 h-20 border-4 border-white/20 rounded-2xl mx-auto flex items-center justify-center rotate-45 mb-8 backdrop-blur-sm">
<div class="w-10 h-10 bg-white rounded-lg -rotate-45"></div>
</div>
</div>
<h1 class="font-display font-bold text-8xl tracking-tight leading-none mb-4 drop-shadow-sm">ZERO</h1>
<p class="font-light text-2xl tracking-[0.2em] uppercase text-white/90">The speed you need.</p>
</div>
<div class="absolute bottom-8 left-0 w-full text-center text-white/40 text-xs font-display">
            CMS Dashboard v2.4.0
        </div>
</div>
<div class="w-full lg:w-1/2 flex items-center justify-center p-6 sm:p-12 lg:p-24 bg-white relative">
<div class="w-full max-w-md space-y-8">
<div class="lg:hidden text-center mb-8">
<span class="font-display font-bold text-4xl text-transparent bg-clip-text bg-gradient-to-r from-purple-700 to-orange-500">ZERO</span>
</div>
<div class="text-left">
<h2 class="text-3xl font-bold text-text-main font-display">Sign in to Dashboard</h2>
<p class="mt-2 text-sm text-text-secondary">Welcome back. Please enter your credentials to access the admin panel.</p>
</div>

<?php if ($error): ?>
<!-- Error Message -->
<div class="p-4 rounded-xl bg-red-50 border border-red-200 flex items-start gap-3">
    <span class="material-symbols-outlined text-red-500 text-xl mt-0.5">error</span>
    <div>
        <p class="text-red-700 font-semibold text-sm">Authentication Failed</p>
        <p class="text-red-600 text-sm mt-1"><?= htmlspecialchars($error) ?></p>
    </div>
</div>
<?php endif; ?>

<form action="" class="mt-8 space-y-6" method="POST">
<div class="space-y-5">
<div>
<label class="block text-sm font-semibold text-text-main mb-2" for="email">Email Address</label>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
<span class="material-symbols-outlined text-gray-400 text-[20px]">mail</span>
</div>
<input autocomplete="email" class="appearance-none block w-full pl-10 pr-3 py-3 border border-gray-200 rounded-xl leading-5 bg-gray-50 text-gray-900 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-purple-500 focus:border-transparent sm:text-sm transition-all duration-200" id="email" name="email" placeholder="name@company.com" required="" type="email" value="<?= htmlspecialchars($_POST['email'] ?? '') ?>"/>
</div>
</div>
<div>
<label class="block text-sm font-semibold text-text-main mb-2" for="password">Password</label>
<div class="relative">
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
<span class="material-symbols-outlined text-gray-400 text-[20px]">lock</span>
</div>
<input autocomplete="current-password" class="appearance-none block w-full pl-10 pr-3 py-3 border border-gray-200 rounded-xl leading-5 bg-gray-50 text-gray-900 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-purple-500 focus:border-transparent sm:text-sm transition-all duration-200" id="password" name="password" placeholder="••••••••" required="" type="password"/>
</div>
</div>
</div>
<div class="flex items-center justify-between">
<div class="flex items-center">
<input class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded cursor-pointer" id="remember-me" name="remember-me" type="checkbox"/>
<label class="ml-2 block text-sm text-text-secondary cursor-pointer select-none" for="remember-me">Remember me</label>
</div>
</div>
<div>
<button class="group relative w-full flex justify-center py-3.5 px-4 border border-transparent text-sm font-bold rounded-xl text-white bg-btn-gradient hover:shadow-lg hover:shadow-purple-500/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all duration-300 transform hover:-translate-y-0.5" type="submit">
<span class="absolute left-0 inset-y-0 flex items-center pl-3">
<span class="material-symbols-outlined text-purple-200 group-hover:text-white transition-colors text-[20px]">verified_user</span>
</span>
                        Authenticate
                    </button>
</div>
</form>
<div class="mt-6 text-center">
<a class="text-sm font-medium text-purple-600 hover:text-purple-500 transition-colors" href="#">
                    Forgot Password?
                </a>
</div>
</div>
<div class="absolute bottom-6 w-full text-center lg:text-left lg:pl-0">
<div class="text-xs text-gray-300 lg:hidden">
                © 2023 Zero CMS
             </div>
</div>
</div>

</body></html>


==================================================
FILE PATH: .\content\themes\admin-default\assets\js\editor.bundle.js
==================================================

(function(){"use strict";var wh=document.createElement("style");wh.textContent=`@tailwind base;@tailwind components;@tailwind utilities;.ProseMirror{outline:none;min-height:150px}.ProseMirror p.is-editor-empty:first-child:before{color:#adb5bd;content:attr(data-placeholder);float:left;height:0;pointer-events:none}.drag-handle{display:flex;align-items:center;justify-content:center;width:20px;height:20px;cursor:grab;border-radius:4px;background:transparent;color:#9ca3af;transition:all .15s ease}.drag-handle:hover{background:#f3f4f6;color:#6b7280}.drag-handle:active{cursor:grabbing;background:#e5e7eb;color:#374151}.drag-handle svg{width:14px;height:14px}
/*$vite$:1*/`,document.head.appendChild(wh);function xh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sh={exports:{}},qs={},Eh={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fo=Symbol.for("react.element"),Kw=Symbol.for("react.portal"),qw=Symbol.for("react.fragment"),Jw=Symbol.for("react.strict_mode"),Qw=Symbol.for("react.profiler"),Gw=Symbol.for("react.provider"),Yw=Symbol.for("react.context"),Xw=Symbol.for("react.forward_ref"),Zw=Symbol.for("react.suspense"),ex=Symbol.for("react.memo"),tx=Symbol.for("react.lazy"),Ch=Symbol.iterator;function nx(t){return t===null||typeof t!="object"?null:(t=Ch&&t[Ch]||t["@@iterator"],typeof t=="function"?t:null)}var bh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Th=Object.assign,Mh={};function ui(t,e,n){this.props=t,this.context=e,this.refs=Mh,this.updater=n||bh}ui.prototype.isReactComponent={},ui.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},ui.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Nh(){}Nh.prototype=ui.prototype;function Ju(t,e,n){this.props=t,this.context=e,this.refs=Mh,this.updater=n||bh}var Qu=Ju.prototype=new Nh;Qu.constructor=Ju,Th(Qu,ui.prototype),Qu.isPureReactComponent=!0;var Oh=Array.isArray,Ah=Object.prototype.hasOwnProperty,Gu={current:null},Rh={key:!0,ref:!0,__self:!0,__source:!0};function Dh(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Ah.call(e,r)&&!Rh.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:fo,type:t,key:o,ref:s,props:i,_owner:Gu.current}}function rx(t,e){return{$$typeof:fo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Yu(t){return typeof t=="object"&&t!==null&&t.$$typeof===fo}function ix(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ih=/\/+/g;function Xu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ix(""+t.key):e.toString(36)}function Js(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case fo:case Kw:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Xu(s,0):r,Oh(i)?(n="",t!=null&&(n=t.replace(Ih,"$&/")+"/"),Js(i,e,n,"",function(u){return u})):i!=null&&(Yu(i)&&(i=rx(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Ih,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Oh(t))for(var l=0;l<t.length;l++){o=t[l];var a=r+Xu(o,l);s+=Js(o,e,n,a,i)}else if(a=nx(t),typeof a=="function")for(t=a.call(t),l=0;!(o=t.next()).done;)o=o.value,a=r+Xu(o,l++),s+=Js(o,e,n,a,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Qs(t,e,n){if(t==null)return t;var r=[],i=0;return Js(t,r,"","",function(o){return e.call(n,o,i++)}),r}function ox(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var et={current:null},Gs={transition:null},sx={ReactCurrentDispatcher:et,ReactCurrentBatchConfig:Gs,ReactCurrentOwner:Gu};function Ph(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:Qs,forEach:function(t,e,n){Qs(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Qs(t,function(){e++}),e},toArray:function(t){return Qs(t,function(e){return e})||[]},only:function(t){if(!Yu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},G.Component=ui,G.Fragment=qw,G.Profiler=Qw,G.PureComponent=Ju,G.StrictMode=Jw,G.Suspense=Zw,G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sx,G.act=Ph,G.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Th({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Gu.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)Ah.call(e,a)&&!Rh.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:fo,type:t.type,key:i,ref:o,props:r,_owner:s}},G.createContext=function(t){return t={$$typeof:Yw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Gw,_context:t},t.Consumer=t},G.createElement=Dh,G.createFactory=function(t){var e=Dh.bind(null,t);return e.type=t,e},G.createRef=function(){return{current:null}},G.forwardRef=function(t){return{$$typeof:Xw,render:t}},G.isValidElement=Yu,G.lazy=function(t){return{$$typeof:tx,_payload:{_status:-1,_result:t},_init:ox}},G.memo=function(t,e){return{$$typeof:ex,type:t,compare:e===void 0?null:e}},G.startTransition=function(t){var e=Gs.transition;Gs.transition={};try{t()}finally{Gs.transition=e}},G.unstable_act=Ph,G.useCallback=function(t,e){return et.current.useCallback(t,e)},G.useContext=function(t){return et.current.useContext(t)},G.useDebugValue=function(){},G.useDeferredValue=function(t){return et.current.useDeferredValue(t)},G.useEffect=function(t,e){return et.current.useEffect(t,e)},G.useId=function(){return et.current.useId()},G.useImperativeHandle=function(t,e,n){return et.current.useImperativeHandle(t,e,n)},G.useInsertionEffect=function(t,e){return et.current.useInsertionEffect(t,e)},G.useLayoutEffect=function(t,e){return et.current.useLayoutEffect(t,e)},G.useMemo=function(t,e){return et.current.useMemo(t,e)},G.useReducer=function(t,e,n){return et.current.useReducer(t,e,n)},G.useRef=function(t){return et.current.useRef(t)},G.useState=function(t){return et.current.useState(t)},G.useSyncExternalStore=function(t,e,n){return et.current.useSyncExternalStore(t,e,n)},G.useTransition=function(){return et.current.useTransition()},G.version="18.3.1",Eh.exports=G;var ne=Eh.exports;const tt=xh(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lx=ne,ax=Symbol.for("react.element"),ux=Symbol.for("react.fragment"),cx=Object.prototype.hasOwnProperty,fx=lx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dx={key:!0,ref:!0,__self:!0,__source:!0};function Lh(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)cx.call(e,r)&&!dx.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:ax,type:t,key:o,ref:s,props:i,_owner:fx.current}}qs.Fragment=ux,qs.jsx=Lh,qs.jsxs=Lh,Sh.exports=qs;var H=Sh.exports,Zu={},zh={exports:{}},vt={},Bh={exports:{}},_h={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,z){var $=R.length;R.push(z);e:for(;0<$;){var X=$-1>>>1,Z=R[X];if(0<i(Z,z))R[X]=z,R[$]=Z,$=X;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var z=R[0],$=R.pop();if($!==z){R[0]=$;e:for(var X=0,Z=R.length,Ze=Z>>>1;X<Ze;){var he=2*(X+1)-1,Be=R[he],Ae=he+1,en=R[Ae];if(0>i(Be,$))Ae<Z&&0>i(en,Be)?(R[X]=en,R[Ae]=$,X=Ae):(R[X]=Be,R[he]=$,X=he);else if(Ae<Z&&0>i(en,$))R[X]=en,R[Ae]=$,X=Ae;else break e}}return z}function i(R,z){var $=R.sortIndex-z.sortIndex;return $!==0?$:R.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,f=null,d=3,p=!1,h=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(R){for(var z=n(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=R)r(u),z.sortIndex=z.expirationTime,e(a,z);else break;z=n(u)}}function k(R){if(g=!1,w(R),!h)if(n(a)!==null)h=!0,J(S);else{var z=n(u);z!==null&&Q(k,z.startTime-R)}}function S(R,z){h=!1,g&&(g=!1,m(C),C=-1),p=!0;var $=d;try{for(w(z),f=n(a);f!==null&&(!(f.expirationTime>z)||R&&!_());){var X=f.callback;if(typeof X=="function"){f.callback=null,d=f.priorityLevel;var Z=X(f.expirationTime<=z);z=t.unstable_now(),typeof Z=="function"?f.callback=Z:f===n(a)&&r(a),w(z)}else r(a);f=n(a)}if(f!==null)var Ze=!0;else{var he=n(u);he!==null&&Q(k,he.startTime-z),Ze=!1}return Ze}finally{f=null,d=$,p=!1}}var x=!1,E=null,C=-1,A=5,M=-1;function _(){return!(t.unstable_now()-M<A)}function F(){if(E!==null){var R=t.unstable_now();M=R;var z=!0;try{z=E(!0,R)}finally{z?W():(x=!1,E=null)}}else x=!1}var W;if(typeof v=="function")W=function(){v(F)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,I=Y.port2;Y.port1.onmessage=F,W=function(){I.postMessage(null)}}else W=function(){y(F,0)};function J(R){E=R,x||(x=!0,W())}function Q(R,z){C=y(function(){R(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){h||p||(h=!0,J(S))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(R){switch(d){case 1:case 2:case 3:var z=3;break;default:z=d}var $=d;d=z;try{return R()}finally{d=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,z){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var $=d;d=R;try{return z()}finally{d=$}},t.unstable_scheduleCallback=function(R,z,$){var X=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?X+$:X):$=X,R){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=$+Z,R={id:c++,callback:z,priorityLevel:R,startTime:$,expirationTime:Z,sortIndex:-1},$>X?(R.sortIndex=$,e(u,R),n(a)===null&&R===n(u)&&(g?(m(C),C=-1):g=!0,Q(k,$-X))):(R.sortIndex=Z,e(a,R),h||p||(h=!0,J(S))),R},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(R){var z=d;return function(){var $=d;d=z;try{return R.apply(this,arguments)}finally{d=$}}}})(_h),Bh.exports=_h;var px=Bh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx=ne,kt=px;function N(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $h=new Set,po={};function br(t,e){ci(t,e),ci(t+"Capture",e)}function ci(t,e){for(po[t]=e,t=0;t<e.length;t++)$h.add(e[t])}var mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ec=Object.prototype.hasOwnProperty,mx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jh={},Fh={};function gx(t){return ec.call(Fh,t)?!0:ec.call(jh,t)?!1:mx.test(t)?Fh[t]=!0:(jh[t]=!0,!1)}function yx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vx(t,e,n,r){if(e===null||typeof e>"u"||yx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nt(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var _e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_e[t]=new nt(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_e[e]=new nt(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){_e[t]=new nt(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_e[t]=new nt(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_e[t]=new nt(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){_e[t]=new nt(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){_e[t]=new nt(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){_e[t]=new nt(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){_e[t]=new nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var tc=/[\-:]([a-z])/g;function nc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tc,nc);_e[e]=new nt(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tc,nc);_e[e]=new nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tc,nc);_e[e]=new nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){_e[t]=new nt(t,1,!1,t.toLowerCase(),null,!1,!1)}),_e.xlinkHref=new nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){_e[t]=new nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function rc(t,e,n,r){var i=_e.hasOwnProperty(e)?_e[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vx(e,n,i,r)&&(n=null),r||i===null?gx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gn=hx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ys=Symbol.for("react.element"),fi=Symbol.for("react.portal"),di=Symbol.for("react.fragment"),ic=Symbol.for("react.strict_mode"),oc=Symbol.for("react.profiler"),Hh=Symbol.for("react.provider"),Vh=Symbol.for("react.context"),sc=Symbol.for("react.forward_ref"),lc=Symbol.for("react.suspense"),ac=Symbol.for("react.suspense_list"),uc=Symbol.for("react.memo"),Bn=Symbol.for("react.lazy"),Uh=Symbol.for("react.offscreen"),Wh=Symbol.iterator;function ho(t){return t===null||typeof t!="object"?null:(t=Wh&&t[Wh]||t["@@iterator"],typeof t=="function"?t:null)}var me=Object.assign,cc;function mo(t){if(cc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cc=e&&e[1]||""}return`
`+cc+t}var fc=!1;function dc(t,e){if(!t||fc)return"";fc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=s&&0<=l);break}}}finally{fc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?mo(t):""}function kx(t){switch(t.tag){case 5:return mo(t.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 2:case 15:return t=dc(t.type,!1),t;case 11:return t=dc(t.type.render,!1),t;case 1:return t=dc(t.type,!0),t;default:return""}}function pc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case di:return"Fragment";case fi:return"Portal";case oc:return"Profiler";case ic:return"StrictMode";case lc:return"Suspense";case ac:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vh:return(t.displayName||"Context")+".Consumer";case Hh:return(t._context.displayName||"Context")+".Provider";case sc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uc:return e=t.displayName||null,e!==null?e:pc(t.type)||"Memo";case Bn:e=t._payload,t=t._init;try{return pc(t(e))}catch{}}return null}function wx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pc(e);case 8:return e===ic?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _n(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Kh(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xx(t){var e=Kh(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xs(t){t._valueTracker||(t._valueTracker=xx(t))}function qh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Kh(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Zs(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function hc(t,e){var n=e.checked;return me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_n(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Qh(t,e){e=e.checked,e!=null&&rc(t,"checked",e,!1)}function mc(t,e){Qh(t,e);var n=_n(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?gc(t,e.type,n):e.hasOwnProperty("defaultValue")&&gc(t,e.type,_n(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Gh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function gc(t,e,n){(e!=="number"||Zs(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var go=Array.isArray;function pi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_n(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function yc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Yh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(N(92));if(go(n)){if(1<n.length)throw Error(N(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_n(n)}}function Xh(t,e){var n=_n(e.value),r=_n(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Zh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function em(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?em(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var el,tm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(el=el||document.createElement("div"),el.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=el.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sx=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(t){Sx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vo[e]=vo[t]})});function nm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vo.hasOwnProperty(t)&&vo[t]?(""+e).trim():e+"px"}function rm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=nm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Ex=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kc(t,e){if(e){if(Ex[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function wc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xc=null;function Sc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ec=null,hi=null,mi=null;function im(t){if(t=jo(t)){if(typeof Ec!="function")throw Error(N(280));var e=t.stateNode;e&&(e=El(e),Ec(t.stateNode,t.type,e))}}function om(t){hi?mi?mi.push(t):mi=[t]:hi=t}function sm(){if(hi){var t=hi,e=mi;if(mi=hi=null,im(t),e)for(t=0;t<e.length;t++)im(e[t])}}function lm(t,e){return t(e)}function am(){}var Cc=!1;function um(t,e,n){if(Cc)return t(e,n);Cc=!0;try{return lm(t,e,n)}finally{Cc=!1,(hi!==null||mi!==null)&&(am(),sm())}}function ko(t,e){var n=t.stateNode;if(n===null)return null;var r=El(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(N(231,e,typeof n));return n}var bc=!1;if(mn)try{var wo={};Object.defineProperty(wo,"passive",{get:function(){bc=!0}}),window.addEventListener("test",wo,wo),window.removeEventListener("test",wo,wo)}catch{bc=!1}function Cx(t,e,n,r,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var xo=!1,tl=null,nl=!1,Tc=null,bx={onError:function(t){xo=!0,tl=t}};function Tx(t,e,n,r,i,o,s,l,a){xo=!1,tl=null,Cx.apply(bx,arguments)}function Mx(t,e,n,r,i,o,s,l,a){if(Tx.apply(this,arguments),xo){if(xo){var u=tl;xo=!1,tl=null}else throw Error(N(198));nl||(nl=!0,Tc=u)}}function Tr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function cm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fm(t){if(Tr(t)!==t)throw Error(N(188))}function Nx(t){var e=t.alternate;if(!e){if(e=Tr(t),e===null)throw Error(N(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return fm(i),t;if(o===r)return fm(i),e;o=o.sibling}throw Error(N(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(N(189))}}if(n.alternate!==r)throw Error(N(190))}if(n.tag!==3)throw Error(N(188));return n.stateNode.current===n?t:e}function dm(t){return t=Nx(t),t!==null?pm(t):null}function pm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pm(t);if(e!==null)return e;t=t.sibling}return null}var hm=kt.unstable_scheduleCallback,mm=kt.unstable_cancelCallback,Ox=kt.unstable_shouldYield,Ax=kt.unstable_requestPaint,Se=kt.unstable_now,Rx=kt.unstable_getCurrentPriorityLevel,Mc=kt.unstable_ImmediatePriority,gm=kt.unstable_UserBlockingPriority,rl=kt.unstable_NormalPriority,Dx=kt.unstable_LowPriority,ym=kt.unstable_IdlePriority,il=null,tn=null;function Ix(t){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(il,t,void 0,(t.current.flags&128)===128)}catch{}}var Vt=Math.clz32?Math.clz32:zx,Px=Math.log,Lx=Math.LN2;function zx(t){return t>>>=0,t===0?32:31-(Px(t)/Lx|0)|0}var ol=64,sl=4194304;function So(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ll(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var l=s&~i;l!==0?r=So(l):(o&=s,o!==0&&(r=So(o)))}else s=n&~i,s!==0?r=So(s):o!==0&&(r=So(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vt(e),i=1<<n,r|=t[n],e&=~i;return r}function Bx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _x(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Vt(o),l=1<<s,a=i[s];a===-1?(!(l&n)||l&r)&&(i[s]=Bx(l,e)):a<=e&&(t.expiredLanes|=l),o&=~l}}function Nc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vm(){var t=ol;return ol<<=1,!(ol&4194240)&&(ol=64),t}function Oc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Eo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vt(e),t[e]=n}function $x(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Vt(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Ac(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var re=0;function km(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wm,Rc,xm,Sm,Em,Dc=!1,al=[],$n=null,jn=null,Fn=null,Co=new Map,bo=new Map,Hn=[],jx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cm(t,e){switch(t){case"focusin":case"focusout":$n=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Co.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bo.delete(e.pointerId)}}function To(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=jo(e),e!==null&&Rc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Fx(t,e,n,r,i){switch(e){case"focusin":return $n=To($n,t,e,n,r,i),!0;case"dragenter":return jn=To(jn,t,e,n,r,i),!0;case"mouseover":return Fn=To(Fn,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Co.set(o,To(Co.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,bo.set(o,To(bo.get(o)||null,t,e,n,r,i)),!0}return!1}function bm(t){var e=Mr(t.target);if(e!==null){var n=Tr(e);if(n!==null){if(e=n.tag,e===13){if(e=cm(n),e!==null){t.blockedOn=e,Em(t.priority,function(){xm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ul(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Pc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);xc=r,n.target.dispatchEvent(r),xc=null}else return e=jo(n),e!==null&&Rc(e),t.blockedOn=n,!1;e.shift()}return!0}function Tm(t,e,n){ul(t)&&n.delete(e)}function Hx(){Dc=!1,$n!==null&&ul($n)&&($n=null),jn!==null&&ul(jn)&&(jn=null),Fn!==null&&ul(Fn)&&(Fn=null),Co.forEach(Tm),bo.forEach(Tm)}function Mo(t,e){t.blockedOn===e&&(t.blockedOn=null,Dc||(Dc=!0,kt.unstable_scheduleCallback(kt.unstable_NormalPriority,Hx)))}function No(t){function e(i){return Mo(i,t)}if(0<al.length){Mo(al[0],t);for(var n=1;n<al.length;n++){var r=al[n];r.blockedOn===t&&(r.blockedOn=null)}}for($n!==null&&Mo($n,t),jn!==null&&Mo(jn,t),Fn!==null&&Mo(Fn,t),Co.forEach(e),bo.forEach(e),n=0;n<Hn.length;n++)r=Hn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hn.length&&(n=Hn[0],n.blockedOn===null);)bm(n),n.blockedOn===null&&Hn.shift()}var gi=gn.ReactCurrentBatchConfig,cl=!0;function Vx(t,e,n,r){var i=re,o=gi.transition;gi.transition=null;try{re=1,Ic(t,e,n,r)}finally{re=i,gi.transition=o}}function Ux(t,e,n,r){var i=re,o=gi.transition;gi.transition=null;try{re=4,Ic(t,e,n,r)}finally{re=i,gi.transition=o}}function Ic(t,e,n,r){if(cl){var i=Pc(t,e,n,r);if(i===null)Yc(t,e,r,fl,n),Cm(t,r);else if(Fx(i,t,e,n,r))r.stopPropagation();else if(Cm(t,r),e&4&&-1<jx.indexOf(t)){for(;i!==null;){var o=jo(i);if(o!==null&&wm(o),o=Pc(t,e,n,r),o===null&&Yc(t,e,r,fl,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Yc(t,e,r,null,n)}}var fl=null;function Pc(t,e,n,r){if(fl=null,t=Sc(r),t=Mr(t),t!==null)if(e=Tr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=cm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fl=t,null}function Mm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rx()){case Mc:return 1;case gm:return 4;case rl:case Dx:return 16;case ym:return 536870912;default:return 16}default:return 16}}var Vn=null,Lc=null,dl=null;function Nm(){if(dl)return dl;var t,e=Lc,n=e.length,r,i="value"in Vn?Vn.value:Vn.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return dl=i.slice(t,1<r?1-r:void 0)}function pl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hl(){return!0}function Om(){return!1}function wt(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?hl:Om,this.isPropagationStopped=Om,this}return me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hl)},persist:function(){},isPersistent:hl}),e}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zc=wt(yi),Oo=me({},yi,{view:0,detail:0}),Wx=wt(Oo),Bc,_c,Ao,ml=me({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ao&&(Ao&&t.type==="mousemove"?(Bc=t.screenX-Ao.screenX,_c=t.screenY-Ao.screenY):_c=Bc=0,Ao=t),Bc)},movementY:function(t){return"movementY"in t?t.movementY:_c}}),Am=wt(ml),Kx=me({},ml,{dataTransfer:0}),qx=wt(Kx),Jx=me({},Oo,{relatedTarget:0}),$c=wt(Jx),Qx=me({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Gx=wt(Qx),Yx=me({},yi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Xx=wt(Yx),Zx=me({},yi,{data:0}),Rm=wt(Zx),eS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nS[t])?!!e[t]:!1}function jc(){return rS}var iS=me({},Oo,{key:function(t){if(t.key){var e=eS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jc,charCode:function(t){return t.type==="keypress"?pl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),oS=wt(iS),sS=me({},ml,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dm=wt(sS),lS=me({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jc}),aS=wt(lS),uS=me({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),cS=wt(uS),fS=me({},ml,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dS=wt(fS),pS=[9,13,27,32],Fc=mn&&"CompositionEvent"in window,Ro=null;mn&&"documentMode"in document&&(Ro=document.documentMode);var hS=mn&&"TextEvent"in window&&!Ro,Im=mn&&(!Fc||Ro&&8<Ro&&11>=Ro),Pm=" ",Lm=!1;function zm(t,e){switch(t){case"keyup":return pS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vi=!1;function mS(t,e){switch(t){case"compositionend":return Bm(e);case"keypress":return e.which!==32?null:(Lm=!0,Pm);case"textInput":return t=e.data,t===Pm&&Lm?null:t;default:return null}}function gS(t,e){if(vi)return t==="compositionend"||!Fc&&zm(t,e)?(t=Nm(),dl=Lc=Vn=null,vi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Im&&e.locale!=="ko"?null:e.data;default:return null}}var yS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _m(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yS[t.type]:e==="textarea"}function $m(t,e,n,r){om(r),e=wl(e,"onChange"),0<e.length&&(n=new zc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Do=null,Io=null;function vS(t){rg(t,0)}function gl(t){var e=Ei(t);if(qh(e))return t}function kS(t,e){if(t==="change")return e}var jm=!1;if(mn){var Hc;if(mn){var Vc="oninput"in document;if(!Vc){var Fm=document.createElement("div");Fm.setAttribute("oninput","return;"),Vc=typeof Fm.oninput=="function"}Hc=Vc}else Hc=!1;jm=Hc&&(!document.documentMode||9<document.documentMode)}function Hm(){Do&&(Do.detachEvent("onpropertychange",Vm),Io=Do=null)}function Vm(t){if(t.propertyName==="value"&&gl(Io)){var e=[];$m(e,Io,t,Sc(t)),um(vS,e)}}function wS(t,e,n){t==="focusin"?(Hm(),Do=e,Io=n,Do.attachEvent("onpropertychange",Vm)):t==="focusout"&&Hm()}function xS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gl(Io)}function SS(t,e){if(t==="click")return gl(e)}function ES(t,e){if(t==="input"||t==="change")return gl(e)}function CS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ut=typeof Object.is=="function"?Object.is:CS;function Po(t,e){if(Ut(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ec.call(e,i)||!Ut(t[i],e[i]))return!1}return!0}function Um(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wm(t,e){var n=Um(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Um(n)}}function Km(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Km(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qm(){for(var t=window,e=Zs();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Zs(t.document)}return e}function Uc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bS(t){var e=qm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Km(n.ownerDocument.documentElement,n)){if(r!==null&&Uc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Wm(n,o);var s=Wm(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var TS=mn&&"documentMode"in document&&11>=document.documentMode,ki=null,Wc=null,Lo=null,Kc=!1;function Jm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kc||ki==null||ki!==Zs(r)||(r=ki,"selectionStart"in r&&Uc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Lo&&Po(Lo,r)||(Lo=r,r=wl(Wc,"onSelect"),0<r.length&&(e=new zc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ki)))}function yl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:yl("Animation","AnimationEnd"),animationiteration:yl("Animation","AnimationIteration"),animationstart:yl("Animation","AnimationStart"),transitionend:yl("Transition","TransitionEnd")},qc={},Qm={};mn&&(Qm=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function vl(t){if(qc[t])return qc[t];if(!wi[t])return t;var e=wi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Qm)return qc[t]=e[n];return t}var Gm=vl("animationend"),Ym=vl("animationiteration"),Xm=vl("animationstart"),Zm=vl("transitionend"),eg=new Map,tg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Un(t,e){eg.set(t,e),br(e,[t])}for(var Jc=0;Jc<tg.length;Jc++){var Qc=tg[Jc],MS=Qc.toLowerCase(),NS=Qc[0].toUpperCase()+Qc.slice(1);Un(MS,"on"+NS)}Un(Gm,"onAnimationEnd"),Un(Ym,"onAnimationIteration"),Un(Xm,"onAnimationStart"),Un("dblclick","onDoubleClick"),Un("focusin","onFocus"),Un("focusout","onBlur"),Un(Zm,"onTransitionEnd"),ci("onMouseEnter",["mouseout","mouseover"]),ci("onMouseLeave",["mouseout","mouseover"]),ci("onPointerEnter",["pointerout","pointerover"]),ci("onPointerLeave",["pointerout","pointerover"]),br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),br("onBeforeInput",["compositionend","keypress","textInput","paste"]),br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OS=new Set("cancel close invalid load scroll toggle".split(" ").concat(zo));function ng(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Mx(r,e,void 0,t),t.currentTarget=null}function rg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;ng(i,l,u),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;ng(i,l,u),o=a}}}if(nl)throw t=Tc,nl=!1,Tc=null,t}function ae(t,e){var n=e[rf];n===void 0&&(n=e[rf]=new Set);var r=t+"__bubble";n.has(r)||(ig(e,t,2,!1),n.add(r))}function Gc(t,e,n){var r=0;e&&(r|=4),ig(n,t,r,e)}var kl="_reactListening"+Math.random().toString(36).slice(2);function Bo(t){if(!t[kl]){t[kl]=!0,$h.forEach(function(n){n!=="selectionchange"&&(OS.has(n)||Gc(n,!1,t),Gc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kl]||(e[kl]=!0,Gc("selectionchange",!1,e))}}function ig(t,e,n,r){switch(Mm(e)){case 1:var i=Vx;break;case 4:i=Ux;break;default:i=Ic}n=i.bind(null,e,n,t),i=void 0,!bc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Yc(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Mr(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}um(function(){var u=o,c=Sc(n),f=[];e:{var d=eg.get(t);if(d!==void 0){var p=zc,h=t;switch(t){case"keypress":if(pl(n)===0)break e;case"keydown":case"keyup":p=oS;break;case"focusin":h="focus",p=$c;break;case"focusout":h="blur",p=$c;break;case"beforeblur":case"afterblur":p=$c;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Am;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=qx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=aS;break;case Gm:case Ym:case Xm:p=Gx;break;case Zm:p=cS;break;case"scroll":p=Wx;break;case"wheel":p=dS;break;case"copy":case"cut":case"paste":p=Xx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Dm}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?d!==null?d+"Capture":null:d;g=[];for(var v=u,w;v!==null;){w=v;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,m!==null&&(k=ko(v,m),k!=null&&g.push(_o(v,k,w)))),y)break;v=v.return}0<g.length&&(d=new p(d,h,null,n,c),f.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&n!==xc&&(h=n.relatedTarget||n.fromElement)&&(Mr(h)||h[yn]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(h=n.relatedTarget||n.toElement,p=u,h=h?Mr(h):null,h!==null&&(y=Tr(h),h!==y||h.tag!==5&&h.tag!==6)&&(h=null)):(p=null,h=u),p!==h)){if(g=Am,k="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=Dm,k="onPointerLeave",m="onPointerEnter",v="pointer"),y=p==null?d:Ei(p),w=h==null?d:Ei(h),d=new g(k,v+"leave",p,n,c),d.target=y,d.relatedTarget=w,k=null,Mr(c)===u&&(g=new g(m,v+"enter",h,n,c),g.target=w,g.relatedTarget=y,k=g),y=k,p&&h)t:{for(g=p,m=h,v=0,w=g;w;w=xi(w))v++;for(w=0,k=m;k;k=xi(k))w++;for(;0<v-w;)g=xi(g),v--;for(;0<w-v;)m=xi(m),w--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=xi(g),m=xi(m)}g=null}else g=null;p!==null&&og(f,d,p,g,!1),h!==null&&y!==null&&og(f,y,h,g,!0)}}e:{if(d=u?Ei(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var S=kS;else if(_m(d))if(jm)S=ES;else{S=xS;var x=wS}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=SS);if(S&&(S=S(t,u))){$m(f,S,n,c);break e}x&&x(t,d,u),t==="focusout"&&(x=d._wrapperState)&&x.controlled&&d.type==="number"&&gc(d,"number",d.value)}switch(x=u?Ei(u):window,t){case"focusin":(_m(x)||x.contentEditable==="true")&&(ki=x,Wc=u,Lo=null);break;case"focusout":Lo=Wc=ki=null;break;case"mousedown":Kc=!0;break;case"contextmenu":case"mouseup":case"dragend":Kc=!1,Jm(f,n,c);break;case"selectionchange":if(TS)break;case"keydown":case"keyup":Jm(f,n,c)}var E;if(Fc)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else vi?zm(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Im&&n.locale!=="ko"&&(vi||C!=="onCompositionStart"?C==="onCompositionEnd"&&vi&&(E=Nm()):(Vn=c,Lc="value"in Vn?Vn.value:Vn.textContent,vi=!0)),x=wl(u,C),0<x.length&&(C=new Rm(C,t,null,n,c),f.push({event:C,listeners:x}),E?C.data=E:(E=Bm(n),E!==null&&(C.data=E)))),(E=hS?mS(t,n):gS(t,n))&&(u=wl(u,"onBeforeInput"),0<u.length&&(c=new Rm("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=E))}rg(f,e)})}function _o(t,e,n){return{instance:t,listener:e,currentTarget:n}}function wl(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=ko(t,n),o!=null&&r.unshift(_o(t,o,i)),o=ko(t,e),o!=null&&r.push(_o(t,o,i))),t=t.return}return r}function xi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function og(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=ko(n,o),a!=null&&s.unshift(_o(n,a,l))):i||(a=ko(n,o),a!=null&&s.push(_o(n,a,l)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var AS=/\r\n?/g,RS=/\u0000|\uFFFD/g;function sg(t){return(typeof t=="string"?t:""+t).replace(AS,`
`).replace(RS,"")}function xl(t,e,n){if(e=sg(e),sg(t)!==e&&n)throw Error(N(425))}function Sl(){}var Xc=null,Zc=null;function ef(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tf=typeof setTimeout=="function"?setTimeout:void 0,DS=typeof clearTimeout=="function"?clearTimeout:void 0,lg=typeof Promise=="function"?Promise:void 0,IS=typeof queueMicrotask=="function"?queueMicrotask:typeof lg<"u"?function(t){return lg.resolve(null).then(t).catch(PS)}:tf;function PS(t){setTimeout(function(){throw t})}function nf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),No(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);No(e)}function Wn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ag(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Si=Math.random().toString(36).slice(2),nn="__reactFiber$"+Si,$o="__reactProps$"+Si,yn="__reactContainer$"+Si,rf="__reactEvents$"+Si,LS="__reactListeners$"+Si,zS="__reactHandles$"+Si;function Mr(t){var e=t[nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yn]||n[nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ag(t);t!==null;){if(n=t[nn])return n;t=ag(t)}return e}t=n,n=t.parentNode}return null}function jo(t){return t=t[nn]||t[yn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ei(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(N(33))}function El(t){return t[$o]||null}var of=[],Ci=-1;function Kn(t){return{current:t}}function ue(t){0>Ci||(t.current=of[Ci],of[Ci]=null,Ci--)}function le(t,e){Ci++,of[Ci]=t.current,t.current=e}var qn={},We=Kn(qn),at=Kn(!1),Nr=qn;function bi(t,e){var n=t.type.contextTypes;if(!n)return qn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ut(t){return t=t.childContextTypes,t!=null}function Cl(){ue(at),ue(We)}function ug(t,e,n){if(We.current!==qn)throw Error(N(168));le(We,e),le(at,n)}function cg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(N(108,wx(t)||"Unknown",i));return me({},n,r)}function bl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qn,Nr=We.current,le(We,t),le(at,at.current),!0}function fg(t,e,n){var r=t.stateNode;if(!r)throw Error(N(169));n?(t=cg(t,e,Nr),r.__reactInternalMemoizedMergedChildContext=t,ue(at),ue(We),le(We,t)):ue(at),le(at,n)}var vn=null,Tl=!1,sf=!1;function dg(t){vn===null?vn=[t]:vn.push(t)}function BS(t){Tl=!0,dg(t)}function Jn(){if(!sf&&vn!==null){sf=!0;var t=0,e=re;try{var n=vn;for(re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}vn=null,Tl=!1}catch(i){throw vn!==null&&(vn=vn.slice(t+1)),hm(Mc,Jn),i}finally{re=e,sf=!1}}return null}var Ti=[],Mi=0,Ml=null,Nl=0,Mt=[],Nt=0,Or=null,kn=1,wn="";function Ar(t,e){Ti[Mi++]=Nl,Ti[Mi++]=Ml,Ml=t,Nl=e}function pg(t,e,n){Mt[Nt++]=kn,Mt[Nt++]=wn,Mt[Nt++]=Or,Or=t;var r=kn;t=wn;var i=32-Vt(r)-1;r&=~(1<<i),n+=1;var o=32-Vt(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,kn=1<<32-Vt(e)+i|n<<i|r,wn=o+t}else kn=1<<o|n<<i|r,wn=t}function lf(t){t.return!==null&&(Ar(t,1),pg(t,1,0))}function af(t){for(;t===Ml;)Ml=Ti[--Mi],Ti[Mi]=null,Nl=Ti[--Mi],Ti[Mi]=null;for(;t===Or;)Or=Mt[--Nt],Mt[Nt]=null,wn=Mt[--Nt],Mt[Nt]=null,kn=Mt[--Nt],Mt[Nt]=null}var xt=null,St=null,fe=!1,Wt=null;function hg(t,e){var n=Dt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xt=t,St=Wn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xt=t,St=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Or!==null?{id:kn,overflow:wn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Dt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xt=t,St=null,!0):!1;default:return!1}}function uf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cf(t){if(fe){var e=St;if(e){var n=e;if(!mg(t,e)){if(uf(t))throw Error(N(418));e=Wn(n.nextSibling);var r=xt;e&&mg(t,e)?hg(r,n):(t.flags=t.flags&-4097|2,fe=!1,xt=t)}}else{if(uf(t))throw Error(N(418));t.flags=t.flags&-4097|2,fe=!1,xt=t}}}function gg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xt=t}function Ol(t){if(t!==xt)return!1;if(!fe)return gg(t),fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ef(t.type,t.memoizedProps)),e&&(e=St)){if(uf(t))throw yg(),Error(N(418));for(;e;)hg(t,e),e=Wn(e.nextSibling)}if(gg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(N(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){St=Wn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}St=null}}else St=xt?Wn(t.stateNode.nextSibling):null;return!0}function yg(){for(var t=St;t;)t=Wn(t.nextSibling)}function Ni(){St=xt=null,fe=!1}function ff(t){Wt===null?Wt=[t]:Wt.push(t)}var _S=gn.ReactCurrentBatchConfig;function Fo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(N(309));var r=n.stateNode}if(!r)throw Error(N(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(N(284));if(!n._owner)throw Error(N(290,t))}return t}function Al(t,e){throw t=Object.prototype.toString.call(e),Error(N(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vg(t){var e=t._init;return e(t._payload)}function kg(t){function e(m,v){if(t){var w=m.deletions;w===null?(m.deletions=[v],m.flags|=16):w.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=nr(m,v),m.index=0,m.sibling=null,m}function o(m,v,w){return m.index=w,t?(w=m.alternate,w!==null?(w=w.index,w<v?(m.flags|=2,v):w):(m.flags|=2,v)):(m.flags|=1048576,v)}function s(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,v,w,k){return v===null||v.tag!==6?(v=nd(w,m.mode,k),v.return=m,v):(v=i(v,w),v.return=m,v)}function a(m,v,w,k){var S=w.type;return S===di?c(m,v,w.props.children,k,w.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Bn&&vg(S)===v.type)?(k=i(v,w.props),k.ref=Fo(m,v,w),k.return=m,k):(k=ea(w.type,w.key,w.props,null,m.mode,k),k.ref=Fo(m,v,w),k.return=m,k)}function u(m,v,w,k){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=rd(w,m.mode,k),v.return=m,v):(v=i(v,w.children||[]),v.return=m,v)}function c(m,v,w,k,S){return v===null||v.tag!==7?(v=_r(w,m.mode,k,S),v.return=m,v):(v=i(v,w),v.return=m,v)}function f(m,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=nd(""+v,m.mode,w),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ys:return w=ea(v.type,v.key,v.props,null,m.mode,w),w.ref=Fo(m,null,v),w.return=m,w;case fi:return v=rd(v,m.mode,w),v.return=m,v;case Bn:var k=v._init;return f(m,k(v._payload),w)}if(go(v)||ho(v))return v=_r(v,m.mode,w,null),v.return=m,v;Al(m,v)}return null}function d(m,v,w,k){var S=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:l(m,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ys:return w.key===S?a(m,v,w,k):null;case fi:return w.key===S?u(m,v,w,k):null;case Bn:return S=w._init,d(m,v,S(w._payload),k)}if(go(w)||ho(w))return S!==null?null:c(m,v,w,k,null);Al(m,w)}return null}function p(m,v,w,k,S){if(typeof k=="string"&&k!==""||typeof k=="number")return m=m.get(w)||null,l(v,m,""+k,S);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ys:return m=m.get(k.key===null?w:k.key)||null,a(v,m,k,S);case fi:return m=m.get(k.key===null?w:k.key)||null,u(v,m,k,S);case Bn:var x=k._init;return p(m,v,w,x(k._payload),S)}if(go(k)||ho(k))return m=m.get(w)||null,c(v,m,k,S,null);Al(v,k)}return null}function h(m,v,w,k){for(var S=null,x=null,E=v,C=v=0,A=null;E!==null&&C<w.length;C++){E.index>C?(A=E,E=null):A=E.sibling;var M=d(m,E,w[C],k);if(M===null){E===null&&(E=A);break}t&&E&&M.alternate===null&&e(m,E),v=o(M,v,C),x===null?S=M:x.sibling=M,x=M,E=A}if(C===w.length)return n(m,E),fe&&Ar(m,C),S;if(E===null){for(;C<w.length;C++)E=f(m,w[C],k),E!==null&&(v=o(E,v,C),x===null?S=E:x.sibling=E,x=E);return fe&&Ar(m,C),S}for(E=r(m,E);C<w.length;C++)A=p(E,m,C,w[C],k),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?C:A.key),v=o(A,v,C),x===null?S=A:x.sibling=A,x=A);return t&&E.forEach(function(_){return e(m,_)}),fe&&Ar(m,C),S}function g(m,v,w,k){var S=ho(w);if(typeof S!="function")throw Error(N(150));if(w=S.call(w),w==null)throw Error(N(151));for(var x=S=null,E=v,C=v=0,A=null,M=w.next();E!==null&&!M.done;C++,M=w.next()){E.index>C?(A=E,E=null):A=E.sibling;var _=d(m,E,M.value,k);if(_===null){E===null&&(E=A);break}t&&E&&_.alternate===null&&e(m,E),v=o(_,v,C),x===null?S=_:x.sibling=_,x=_,E=A}if(M.done)return n(m,E),fe&&Ar(m,C),S;if(E===null){for(;!M.done;C++,M=w.next())M=f(m,M.value,k),M!==null&&(v=o(M,v,C),x===null?S=M:x.sibling=M,x=M);return fe&&Ar(m,C),S}for(E=r(m,E);!M.done;C++,M=w.next())M=p(E,m,C,M.value,k),M!==null&&(t&&M.alternate!==null&&E.delete(M.key===null?C:M.key),v=o(M,v,C),x===null?S=M:x.sibling=M,x=M);return t&&E.forEach(function(F){return e(m,F)}),fe&&Ar(m,C),S}function y(m,v,w,k){if(typeof w=="object"&&w!==null&&w.type===di&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ys:e:{for(var S=w.key,x=v;x!==null;){if(x.key===S){if(S=w.type,S===di){if(x.tag===7){n(m,x.sibling),v=i(x,w.props.children),v.return=m,m=v;break e}}else if(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Bn&&vg(S)===x.type){n(m,x.sibling),v=i(x,w.props),v.ref=Fo(m,x,w),v.return=m,m=v;break e}n(m,x);break}else e(m,x);x=x.sibling}w.type===di?(v=_r(w.props.children,m.mode,k,w.key),v.return=m,m=v):(k=ea(w.type,w.key,w.props,null,m.mode,k),k.ref=Fo(m,v,w),k.return=m,m=k)}return s(m);case fi:e:{for(x=w.key;v!==null;){if(v.key===x)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(m,v.sibling),v=i(v,w.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=rd(w,m.mode,k),v.return=m,m=v}return s(m);case Bn:return x=w._init,y(m,v,x(w._payload),k)}if(go(w))return h(m,v,w,k);if(ho(w))return g(m,v,w,k);Al(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,w),v.return=m,m=v):(n(m,v),v=nd(w,m.mode,k),v.return=m,m=v),s(m)):n(m,v)}return y}var Oi=kg(!0),wg=kg(!1),Rl=Kn(null),Dl=null,Ai=null,df=null;function pf(){df=Ai=Dl=null}function hf(t){var e=Rl.current;ue(Rl),t._currentValue=e}function mf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ri(t,e){Dl=t,df=Ai=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ct=!0),t.firstContext=null)}function Ot(t){var e=t._currentValue;if(df!==t)if(t={context:t,memoizedValue:e,next:null},Ai===null){if(Dl===null)throw Error(N(308));Ai=t,Dl.dependencies={lanes:0,firstContext:t}}else Ai=Ai.next=t;return e}var Rr=null;function gf(t){Rr===null?Rr=[t]:Rr.push(t)}function xg(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,gf(e)):(n.next=i.next,i.next=n),e.interleaved=n,xn(t,r)}function xn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Qn=!1;function yf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ee&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,xn(t,n)}return i=r.interleaved,i===null?(e.next=e,gf(r)):(e.next=i.next,i.next=e),r.interleaved=e,xn(t,n)}function Il(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ac(t,n)}}function Eg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Pl(t,e,n,r){var i=t.updateQueue;Qn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,c=u=a=null,l=o;do{var d=l.lane,p=l.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=t,g=l;switch(d=e,p=n,g.tag){case 1:if(h=g.payload,typeof h=="function"){f=h.call(p,f,d);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,d=typeof h=="function"?h.call(p,f,d):h,d==null)break e;f=me({},f,d);break e;case 2:Qn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=p,a=f):c=c.next=p,s|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Pr|=s,t.lanes=s,t.memoizedState=f}}function Cg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(N(191,i));i.call(r)}}}var Ho={},rn=Kn(Ho),Vo=Kn(Ho),Uo=Kn(Ho);function Dr(t){if(t===Ho)throw Error(N(174));return t}function vf(t,e){switch(le(Uo,e),le(Vo,t),le(rn,Ho),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vc(e,t)}ue(rn),le(rn,e)}function Di(){ue(rn),ue(Vo),ue(Uo)}function bg(t){Dr(Uo.current);var e=Dr(rn.current),n=vc(e,t.type);e!==n&&(le(Vo,t),le(rn,n))}function kf(t){Vo.current===t&&(ue(rn),ue(Vo))}var ge=Kn(0);function Ll(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wf=[];function xf(){for(var t=0;t<wf.length;t++)wf[t]._workInProgressVersionPrimary=null;wf.length=0}var zl=gn.ReactCurrentDispatcher,Sf=gn.ReactCurrentBatchConfig,Ir=0,ye=null,Ne=null,Re=null,Bl=!1,Wo=!1,Ko=0,$S=0;function Ke(){throw Error(N(321))}function Ef(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ut(t[n],e[n]))return!1;return!0}function Cf(t,e,n,r,i,o){if(Ir=o,ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zl.current=t===null||t.memoizedState===null?VS:US,t=n(r,i),Wo){o=0;do{if(Wo=!1,Ko=0,25<=o)throw Error(N(301));o+=1,Re=Ne=null,e.updateQueue=null,zl.current=WS,t=n(r,i)}while(Wo)}if(zl.current=jl,e=Ne!==null&&Ne.next!==null,Ir=0,Re=Ne=ye=null,Bl=!1,e)throw Error(N(300));return t}function bf(){var t=Ko!==0;return Ko=0,t}function on(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Re===null?ye.memoizedState=Re=t:Re=Re.next=t,Re}function At(){if(Ne===null){var t=ye.alternate;t=t!==null?t.memoizedState:null}else t=Ne.next;var e=Re===null?ye.memoizedState:Re.next;if(e!==null)Re=e,Ne=t;else{if(t===null)throw Error(N(310));Ne=t,t={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},Re===null?ye.memoizedState=Re=t:Re=Re.next=t}return Re}function qo(t,e){return typeof e=="function"?e(t):e}function Tf(t){var e=At(),n=e.queue;if(n===null)throw Error(N(311));n.lastRenderedReducer=t;var r=Ne,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,u=o;do{var c=u.lane;if((Ir&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,s=r):a=a.next=f,ye.lanes|=c,Pr|=c}u=u.next}while(u!==null&&u!==o);a===null?s=r:a.next=l,Ut(r,e.memoizedState)||(ct=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,ye.lanes|=o,Pr|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Mf(t){var e=At(),n=e.queue;if(n===null)throw Error(N(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Ut(o,e.memoizedState)||(ct=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Tg(){}function Mg(t,e){var n=ye,r=At(),i=e(),o=!Ut(r.memoizedState,i);if(o&&(r.memoizedState=i,ct=!0),r=r.queue,Nf(Ag.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Re!==null&&Re.memoizedState.tag&1){if(n.flags|=2048,Jo(9,Og.bind(null,n,r,i,e),void 0,null),De===null)throw Error(N(349));Ir&30||Ng(n,e,i)}return i}function Ng(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ye.updateQueue,e===null?(e={lastEffect:null,stores:null},ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Og(t,e,n,r){e.value=n,e.getSnapshot=r,Rg(e)&&Dg(t)}function Ag(t,e,n){return n(function(){Rg(e)&&Dg(t)})}function Rg(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ut(t,n)}catch{return!0}}function Dg(t){var e=xn(t,1);e!==null&&Qt(e,t,1,-1)}function Ig(t){var e=on();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:t},e.queue=t,t=t.dispatch=HS.bind(null,ye,t),[e.memoizedState,t]}function Jo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ye.updateQueue,e===null?(e={lastEffect:null,stores:null},ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Pg(){return At().memoizedState}function _l(t,e,n,r){var i=on();ye.flags|=t,i.memoizedState=Jo(1|e,n,void 0,r===void 0?null:r)}function $l(t,e,n,r){var i=At();r=r===void 0?null:r;var o=void 0;if(Ne!==null){var s=Ne.memoizedState;if(o=s.destroy,r!==null&&Ef(r,s.deps)){i.memoizedState=Jo(e,n,o,r);return}}ye.flags|=t,i.memoizedState=Jo(1|e,n,o,r)}function Lg(t,e){return _l(8390656,8,t,e)}function Nf(t,e){return $l(2048,8,t,e)}function zg(t,e){return $l(4,2,t,e)}function Bg(t,e){return $l(4,4,t,e)}function _g(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $g(t,e,n){return n=n!=null?n.concat([t]):null,$l(4,4,_g.bind(null,e,t),n)}function Of(){}function jg(t,e){var n=At();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Fg(t,e){var n=At();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ef(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Hg(t,e,n){return Ir&21?(Ut(n,e)||(n=vm(),ye.lanes|=n,Pr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ct=!0),t.memoizedState=n)}function jS(t,e){var n=re;re=n!==0&&4>n?n:4,t(!0);var r=Sf.transition;Sf.transition={};try{t(!1),e()}finally{re=n,Sf.transition=r}}function Vg(){return At().memoizedState}function FS(t,e,n){var r=er(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ug(t))Wg(e,n);else if(n=xg(t,e,n,r),n!==null){var i=it();Qt(n,t,r,i),Kg(n,e,r)}}function HS(t,e,n){var r=er(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ug(t))Wg(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,n);if(i.hasEagerState=!0,i.eagerState=l,Ut(l,s)){var a=e.interleaved;a===null?(i.next=i,gf(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=xg(t,e,i,r),n!==null&&(i=it(),Qt(n,t,r,i),Kg(n,e,r))}}function Ug(t){var e=t.alternate;return t===ye||e!==null&&e===ye}function Wg(t,e){Wo=Bl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Kg(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ac(t,n)}}var jl={readContext:Ot,useCallback:Ke,useContext:Ke,useEffect:Ke,useImperativeHandle:Ke,useInsertionEffect:Ke,useLayoutEffect:Ke,useMemo:Ke,useReducer:Ke,useRef:Ke,useState:Ke,useDebugValue:Ke,useDeferredValue:Ke,useTransition:Ke,useMutableSource:Ke,useSyncExternalStore:Ke,useId:Ke,unstable_isNewReconciler:!1},VS={readContext:Ot,useCallback:function(t,e){return on().memoizedState=[t,e===void 0?null:e],t},useContext:Ot,useEffect:Lg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_l(4194308,4,_g.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _l(4194308,4,t,e)},useInsertionEffect:function(t,e){return _l(4,2,t,e)},useMemo:function(t,e){var n=on();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=on();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FS.bind(null,ye,t),[r.memoizedState,t]},useRef:function(t){var e=on();return t={current:t},e.memoizedState=t},useState:Ig,useDebugValue:Of,useDeferredValue:function(t){return on().memoizedState=t},useTransition:function(){var t=Ig(!1),e=t[0];return t=jS.bind(null,t[1]),on().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ye,i=on();if(fe){if(n===void 0)throw Error(N(407));n=n()}else{if(n=e(),De===null)throw Error(N(349));Ir&30||Ng(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Lg(Ag.bind(null,r,o,t),[t]),r.flags|=2048,Jo(9,Og.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=on(),e=De.identifierPrefix;if(fe){var n=wn,r=kn;n=(r&~(1<<32-Vt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ko++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$S++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},US={readContext:Ot,useCallback:jg,useContext:Ot,useEffect:Nf,useImperativeHandle:$g,useInsertionEffect:zg,useLayoutEffect:Bg,useMemo:Fg,useReducer:Tf,useRef:Pg,useState:function(){return Tf(qo)},useDebugValue:Of,useDeferredValue:function(t){var e=At();return Hg(e,Ne.memoizedState,t)},useTransition:function(){var t=Tf(qo)[0],e=At().memoizedState;return[t,e]},useMutableSource:Tg,useSyncExternalStore:Mg,useId:Vg,unstable_isNewReconciler:!1},WS={readContext:Ot,useCallback:jg,useContext:Ot,useEffect:Nf,useImperativeHandle:$g,useInsertionEffect:zg,useLayoutEffect:Bg,useMemo:Fg,useReducer:Mf,useRef:Pg,useState:function(){return Mf(qo)},useDebugValue:Of,useDeferredValue:function(t){var e=At();return Ne===null?e.memoizedState=t:Hg(e,Ne.memoizedState,t)},useTransition:function(){var t=Mf(qo)[0],e=At().memoizedState;return[t,e]},useMutableSource:Tg,useSyncExternalStore:Mg,useId:Vg,unstable_isNewReconciler:!1};function Kt(t,e){if(t&&t.defaultProps){e=me({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Af(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:me({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fl={isMounted:function(t){return(t=t._reactInternals)?Tr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=it(),i=er(t),o=Sn(r,i);o.payload=e,n!=null&&(o.callback=n),e=Gn(t,o,i),e!==null&&(Qt(e,t,i,r),Il(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=it(),i=er(t),o=Sn(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Gn(t,o,i),e!==null&&(Qt(e,t,i,r),Il(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=it(),r=er(t),i=Sn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Gn(t,i,r),e!==null&&(Qt(e,t,r,n),Il(e,t,r))}};function qg(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Po(n,r)||!Po(i,o):!0}function Jg(t,e,n){var r=!1,i=qn,o=e.contextType;return typeof o=="object"&&o!==null?o=Ot(o):(i=ut(e)?Nr:We.current,r=e.contextTypes,o=(r=r!=null)?bi(t,i):qn),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Qg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fl.enqueueReplaceState(e,e.state,null)}function Rf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},yf(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ot(o):(o=ut(e)?Nr:We.current,i.context=bi(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Af(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Fl.enqueueReplaceState(i,i.state,null),Pl(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ii(t,e){try{var n="",r=e;do n+=kx(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Df(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function If(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var KS=typeof WeakMap=="function"?WeakMap:Map;function Gg(t,e,n){n=Sn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Jl||(Jl=!0,Jf=r),If(t,e)},n}function Yg(t,e,n){n=Sn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){If(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){If(t,e),typeof r!="function"&&(Xn===null?Xn=new Set([this]):Xn.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Xg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new KS;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=sE.bind(null,t,e,n),e.then(t,t))}function Zg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ey(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Sn(-1,1),e.tag=2,Gn(n,e,1))),n.lanes|=1),t)}var qS=gn.ReactCurrentOwner,ct=!1;function rt(t,e,n,r){e.child=t===null?wg(e,null,n,r):Oi(e,t.child,n,r)}function ty(t,e,n,r,i){n=n.render;var o=e.ref;return Ri(e,i),r=Cf(t,e,n,r,o,i),n=bf(),t!==null&&!ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,En(t,e,i)):(fe&&n&&lf(e),e.flags|=1,rt(t,e,r,i),e.child)}function ny(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!td(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,ry(t,e,o,r,i)):(t=ea(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Po,n(s,r)&&t.ref===e.ref)return En(t,e,i)}return e.flags|=1,t=nr(o,r),t.ref=e.ref,t.return=e,e.child=t}function ry(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Po(o,r)&&t.ref===e.ref)if(ct=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(ct=!0);else return e.lanes=t.lanes,En(t,e,i)}return Pf(t,e,n,r,i)}function iy(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},le(Li,Et),Et|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,le(Li,Et),Et|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,le(Li,Et),Et|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,le(Li,Et),Et|=r;return rt(t,e,i,n),e.child}function oy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pf(t,e,n,r,i){var o=ut(n)?Nr:We.current;return o=bi(e,o),Ri(e,i),n=Cf(t,e,n,r,o,i),r=bf(),t!==null&&!ct?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,En(t,e,i)):(fe&&r&&lf(e),e.flags|=1,rt(t,e,n,i),e.child)}function sy(t,e,n,r,i){if(ut(n)){var o=!0;bl(e)}else o=!1;if(Ri(e,i),e.stateNode===null)Vl(t,e),Jg(e,n,r),Rf(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ot(u):(u=ut(n)?Nr:We.current,u=bi(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Qg(e,s,r,u),Qn=!1;var d=e.memoizedState;s.state=d,Pl(e,r,s,i),a=e.memoizedState,l!==r||d!==a||at.current||Qn?(typeof c=="function"&&(Af(e,n,c,r),a=e.memoizedState),(l=Qn||qg(e,n,l,r,d,a,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,Sg(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Kt(e.type,l),s.props=u,f=e.pendingProps,d=s.context,a=n.contextType,typeof a=="object"&&a!==null?a=Ot(a):(a=ut(n)?Nr:We.current,a=bi(e,a));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||d!==a)&&Qg(e,s,r,a),Qn=!1,d=e.memoizedState,s.state=d,Pl(e,r,s,i);var h=e.memoizedState;l!==f||d!==h||at.current||Qn?(typeof p=="function"&&(Af(e,n,p,r),h=e.memoizedState),(u=Qn||qg(e,n,u,r,d,h,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,h,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,h,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),s.props=r,s.state=h,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Lf(t,e,n,r,o,i)}function Lf(t,e,n,r,i,o){oy(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&fg(e,n,!1),En(t,e,o);r=e.stateNode,qS.current=e;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Oi(e,t.child,null,o),e.child=Oi(e,null,l,o)):rt(t,e,l,o),e.memoizedState=r.state,i&&fg(e,n,!0),e.child}function ly(t){var e=t.stateNode;e.pendingContext?ug(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ug(t,e.context,!1),vf(t,e.containerInfo)}function ay(t,e,n,r,i){return Ni(),ff(i),e.flags|=256,rt(t,e,n,r),e.child}var zf={dehydrated:null,treeContext:null,retryLane:0};function Bf(t){return{baseLanes:t,cachePool:null,transitions:null}}function uy(t,e,n){var r=e.pendingProps,i=ge.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),le(ge,i&1),t===null)return cf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ta(s,r,0,null),t=_r(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Bf(n),e.memoizedState=zf,t):_f(e,s));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return JS(t,e,s,r,l,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=nr(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=nr(l,o):(o=_r(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Bf(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=zf,r}return o=t.child,t=o.sibling,r=nr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function _f(t,e){return e=ta({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hl(t,e,n,r){return r!==null&&ff(r),Oi(e,t.child,null,n),t=_f(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function JS(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Df(Error(N(422))),Hl(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=ta({mode:"visible",children:r.children},i,0,null),o=_r(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Oi(e,t.child,null,s),e.child.memoizedState=Bf(s),e.memoizedState=zf,o);if(!(e.mode&1))return Hl(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(N(419)),r=Df(o,r,void 0),Hl(t,e,s,r)}if(l=(s&t.childLanes)!==0,ct||l){if(r=De,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,xn(t,i),Qt(r,t,i,-1))}return ed(),r=Df(Error(N(421))),Hl(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=lE.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,St=Wn(i.nextSibling),xt=e,fe=!0,Wt=null,t!==null&&(Mt[Nt++]=kn,Mt[Nt++]=wn,Mt[Nt++]=Or,kn=t.id,wn=t.overflow,Or=e),e=_f(e,r.children),e.flags|=4096,e)}function cy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),mf(t.return,e,n)}function $f(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function fy(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(rt(t,e,r.children,n),r=ge.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cy(t,n,e);else if(t.tag===19)cy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(le(ge,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ll(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),$f(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ll(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}$f(e,!0,n,null,o);break;case"together":$f(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function En(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Pr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(N(153));if(e.child!==null){for(t=e.child,n=nr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=nr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function QS(t,e,n){switch(e.tag){case 3:ly(e),Ni();break;case 5:bg(e);break;case 1:ut(e.type)&&bl(e);break;case 4:vf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;le(Rl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(le(ge,ge.current&1),e.flags|=128,null):n&e.child.childLanes?uy(t,e,n):(le(ge,ge.current&1),t=En(t,e,n),t!==null?t.sibling:null);le(ge,ge.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return fy(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),le(ge,ge.current),r)break;return null;case 22:case 23:return e.lanes=0,iy(t,e,n)}return En(t,e,n)}var dy,jf,py,hy;dy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},jf=function(){},py=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Dr(rn.current);var o=null;switch(n){case"input":i=hc(t,i),r=hc(t,r),o=[];break;case"select":i=me({},i,{value:void 0}),r=me({},r,{value:void 0}),o=[];break;case"textarea":i=yc(t,i),r=yc(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Sl)}kc(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(po.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(n||(n={}),n[s]=a[s])}else n||(o||(o=[]),o.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(po.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&ae("scroll",t),o||l===a||(o=[])):(o=o||[]).push(u,a))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}},hy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Qo(t,e){if(!fe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GS(t,e,n){var r=e.pendingProps;switch(af(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qe(e),null;case 1:return ut(e.type)&&Cl(),qe(e),null;case 3:return r=e.stateNode,Di(),ue(at),ue(We),xf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ol(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wt!==null&&(Yf(Wt),Wt=null))),jf(t,e),qe(e),null;case 5:kf(e);var i=Dr(Uo.current);if(n=e.type,t!==null&&e.stateNode!=null)py(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(N(166));return qe(e),null}if(t=Dr(rn.current),Ol(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[nn]=e,r[$o]=o,t=(e.mode&1)!==0,n){case"dialog":ae("cancel",r),ae("close",r);break;case"iframe":case"object":case"embed":ae("load",r);break;case"video":case"audio":for(i=0;i<zo.length;i++)ae(zo[i],r);break;case"source":ae("error",r);break;case"img":case"image":case"link":ae("error",r),ae("load",r);break;case"details":ae("toggle",r);break;case"input":Jh(r,o),ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ae("invalid",r);break;case"textarea":Yh(r,o),ae("invalid",r)}kc(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&xl(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&xl(r.textContent,l,t),i=["children",""+l]):po.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&ae("scroll",r)}switch(n){case"input":Xs(r),Gh(r,o,!0);break;case"textarea":Xs(r),Zh(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Sl)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=em(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[nn]=e,t[$o]=r,dy(t,e,!1,!1),e.stateNode=t;e:{switch(s=wc(n,r),n){case"dialog":ae("cancel",t),ae("close",t),i=r;break;case"iframe":case"object":case"embed":ae("load",t),i=r;break;case"video":case"audio":for(i=0;i<zo.length;i++)ae(zo[i],t);i=r;break;case"source":ae("error",t),i=r;break;case"img":case"image":case"link":ae("error",t),ae("load",t),i=r;break;case"details":ae("toggle",t),i=r;break;case"input":Jh(t,r),i=hc(t,r),ae("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=me({},r,{value:void 0}),ae("invalid",t);break;case"textarea":Yh(t,r),i=yc(t,r),ae("invalid",t);break;default:i=r}kc(n,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?rm(t,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&tm(t,a)):o==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&yo(t,a):typeof a=="number"&&yo(t,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(po.hasOwnProperty(o)?a!=null&&o==="onScroll"&&ae("scroll",t):a!=null&&rc(t,o,a,s))}switch(n){case"input":Xs(t),Gh(t,r,!1);break;case"textarea":Xs(t),Zh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_n(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?pi(t,!!r.multiple,o,!1):r.defaultValue!=null&&pi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Sl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qe(e),null;case 6:if(t&&e.stateNode!=null)hy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(N(166));if(n=Dr(Uo.current),Dr(rn.current),Ol(e)){if(r=e.stateNode,n=e.memoizedProps,r[nn]=e,(o=r.nodeValue!==n)&&(t=xt,t!==null))switch(t.tag){case 3:xl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nn]=e,e.stateNode=r}return qe(e),null;case 13:if(ue(ge),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(fe&&St!==null&&e.mode&1&&!(e.flags&128))yg(),Ni(),e.flags|=98560,o=!1;else if(o=Ol(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(N(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(N(317));o[nn]=e}else Ni(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qe(e),o=!1}else Wt!==null&&(Yf(Wt),Wt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ge.current&1?Oe===0&&(Oe=3):ed())),e.updateQueue!==null&&(e.flags|=4),qe(e),null);case 4:return Di(),jf(t,e),t===null&&Bo(e.stateNode.containerInfo),qe(e),null;case 10:return hf(e.type._context),qe(e),null;case 17:return ut(e.type)&&Cl(),qe(e),null;case 19:if(ue(ge),o=e.memoizedState,o===null)return qe(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Qo(o,!1);else{if(Oe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Ll(t),s!==null){for(e.flags|=128,Qo(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return le(ge,ge.current&1|2),e.child}t=t.sibling}o.tail!==null&&Se()>zi&&(e.flags|=128,r=!0,Qo(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ll(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Qo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!fe)return qe(e),null}else 2*Se()-o.renderingStartTime>zi&&n!==1073741824&&(e.flags|=128,r=!0,Qo(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Se(),e.sibling=null,n=ge.current,le(ge,r?n&1|2:n&1),e):(qe(e),null);case 22:case 23:return Zf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Et&1073741824&&(qe(e),e.subtreeFlags&6&&(e.flags|=8192)):qe(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function YS(t,e){switch(af(e),e.tag){case 1:return ut(e.type)&&Cl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Di(),ue(at),ue(We),xf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kf(e),null;case 13:if(ue(ge),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(N(340));Ni()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ue(ge),null;case 4:return Di(),null;case 10:return hf(e.type._context),null;case 22:case 23:return Zf(),null;case 24:return null;default:return null}}var Ul=!1,Je=!1,XS=typeof WeakSet=="function"?WeakSet:Set,P=null;function Pi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ve(t,e,r)}else n.current=null}function Ff(t,e,n){try{n()}catch(r){ve(t,e,r)}}var my=!1;function ZS(t,e){if(Xc=cl,t=qm(),Uc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,l=-1,a=-1,u=0,c=0,f=t,d=null;t:for(;;){for(var p;f!==n||i!==0&&f.nodeType!==3||(l=s+i),f!==o||r!==0&&f.nodeType!==3||(a=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===t)break t;if(d===n&&++u===i&&(l=s),d===o&&++c===r&&(a=s),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zc={focusedElem:t,selectionRange:n},cl=!1,P=e;P!==null;)if(e=P,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,P=t;else for(;P!==null;){e=P;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var g=h.memoizedProps,y=h.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Kt(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(k){ve(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,P=t;break}P=e.return}return h=my,my=!1,h}function Go(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ff(e,n,o)}i=i.next}while(i!==r)}}function Wl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Hf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gy(t){var e=t.alternate;e!==null&&(t.alternate=null,gy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nn],delete e[$o],delete e[rf],delete e[LS],delete e[zS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yy(t){return t.tag===5||t.tag===3||t.tag===4}function vy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Sl));else if(r!==4&&(t=t.child,t!==null))for(Vf(t,e,n),t=t.sibling;t!==null;)Vf(t,e,n),t=t.sibling}function Uf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Uf(t,e,n),t=t.sibling;t!==null;)Uf(t,e,n),t=t.sibling}var $e=null,qt=!1;function Yn(t,e,n){for(n=n.child;n!==null;)ky(t,e,n),n=n.sibling}function ky(t,e,n){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(il,n)}catch{}switch(n.tag){case 5:Je||Pi(n,e);case 6:var r=$e,i=qt;$e=null,Yn(t,e,n),$e=r,qt=i,$e!==null&&(qt?(t=$e,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$e.removeChild(n.stateNode));break;case 18:$e!==null&&(qt?(t=$e,n=n.stateNode,t.nodeType===8?nf(t.parentNode,n):t.nodeType===1&&nf(t,n),No(t)):nf($e,n.stateNode));break;case 4:r=$e,i=qt,$e=n.stateNode.containerInfo,qt=!0,Yn(t,e,n),$e=r,qt=i;break;case 0:case 11:case 14:case 15:if(!Je&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Ff(n,e,s),i=i.next}while(i!==r)}Yn(t,e,n);break;case 1:if(!Je&&(Pi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ve(n,e,l)}Yn(t,e,n);break;case 21:Yn(t,e,n);break;case 22:n.mode&1?(Je=(r=Je)||n.memoizedState!==null,Yn(t,e,n),Je=r):Yn(t,e,n);break;default:Yn(t,e,n)}}function wy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new XS),e.forEach(function(r){var i=aE.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Jt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:$e=l.stateNode,qt=!1;break e;case 3:$e=l.stateNode.containerInfo,qt=!0;break e;case 4:$e=l.stateNode.containerInfo,qt=!0;break e}l=l.return}if($e===null)throw Error(N(160));ky(o,s,i),$e=null,qt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){ve(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xy(e,t),e=e.sibling}function xy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jt(e,t),sn(t),r&4){try{Go(3,t,t.return),Wl(3,t)}catch(g){ve(t,t.return,g)}try{Go(5,t,t.return)}catch(g){ve(t,t.return,g)}}break;case 1:Jt(e,t),sn(t),r&512&&n!==null&&Pi(n,n.return);break;case 5:if(Jt(e,t),sn(t),r&512&&n!==null&&Pi(n,n.return),t.flags&32){var i=t.stateNode;try{yo(i,"")}catch(g){ve(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Qh(i,o),wc(l,s);var u=wc(l,o);for(s=0;s<a.length;s+=2){var c=a[s],f=a[s+1];c==="style"?rm(i,f):c==="dangerouslySetInnerHTML"?tm(i,f):c==="children"?yo(i,f):rc(i,c,f,u)}switch(l){case"input":mc(i,o);break;case"textarea":Xh(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?pi(i,!!o.multiple,p,!1):d!==!!o.multiple&&(o.defaultValue!=null?pi(i,!!o.multiple,o.defaultValue,!0):pi(i,!!o.multiple,o.multiple?[]:"",!1))}i[$o]=o}catch(g){ve(t,t.return,g)}}break;case 6:if(Jt(e,t),sn(t),r&4){if(t.stateNode===null)throw Error(N(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(g){ve(t,t.return,g)}}break;case 3:if(Jt(e,t),sn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{No(e.containerInfo)}catch(g){ve(t,t.return,g)}break;case 4:Jt(e,t),sn(t);break;case 13:Jt(e,t),sn(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(qf=Se())),r&4&&wy(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Je=(u=Je)||c,Jt(e,t),Je=u):Jt(e,t),sn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(P=t,c=t.child;c!==null;){for(f=P=c;P!==null;){switch(d=P,p=d.child,d.tag){case 0:case 11:case 14:case 15:Go(4,d,d.return);break;case 1:Pi(d,d.return);var h=d.stateNode;if(typeof h.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(g){ve(r,n,g)}}break;case 5:Pi(d,d.return);break;case 22:if(d.memoizedState!==null){Cy(f);continue}}p!==null?(p.return=d,P=p):Cy(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=nm("display",s))}catch(g){ve(t,t.return,g)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){ve(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jt(e,t),sn(t),r&4&&wy(t);break;case 21:break;default:Jt(e,t),sn(t)}}function sn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yy(n)){var r=n;break e}n=n.return}throw Error(N(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(yo(i,""),r.flags&=-33);var o=vy(t);Uf(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=vy(t);Vf(t,l,s);break;default:throw Error(N(161))}}catch(a){ve(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eE(t,e,n){P=t,Sy(t)}function Sy(t,e,n){for(var r=(t.mode&1)!==0;P!==null;){var i=P,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Ul;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Je;l=Ul;var u=Je;if(Ul=s,(Je=a)&&!u)for(P=i;P!==null;)s=P,a=s.child,s.tag===22&&s.memoizedState!==null?by(i):a!==null?(a.return=s,P=a):by(i);for(;o!==null;)P=o,Sy(o),o=o.sibling;P=i,Ul=l,Je=u}Ey(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,P=o):Ey(t)}}function Ey(t){for(;P!==null;){var e=P;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Je||Wl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Je)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Cg(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Cg(e,s,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&No(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}Je||e.flags&512&&Hf(e)}catch(d){ve(e,e.return,d)}}if(e===t){P=null;break}if(n=e.sibling,n!==null){n.return=e.return,P=n;break}P=e.return}}function Cy(t){for(;P!==null;){var e=P;if(e===t){P=null;break}var n=e.sibling;if(n!==null){n.return=e.return,P=n;break}P=e.return}}function by(t){for(;P!==null;){var e=P;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Wl(4,e)}catch(a){ve(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){ve(e,i,a)}}var o=e.return;try{Hf(e)}catch(a){ve(e,o,a)}break;case 5:var s=e.return;try{Hf(e)}catch(a){ve(e,s,a)}}}catch(a){ve(e,e.return,a)}if(e===t){P=null;break}var l=e.sibling;if(l!==null){l.return=e.return,P=l;break}P=e.return}}var tE=Math.ceil,Kl=gn.ReactCurrentDispatcher,Wf=gn.ReactCurrentOwner,Rt=gn.ReactCurrentBatchConfig,ee=0,De=null,Ce=null,je=0,Et=0,Li=Kn(0),Oe=0,Yo=null,Pr=0,ql=0,Kf=0,Xo=null,ft=null,qf=0,zi=1/0,Cn=null,Jl=!1,Jf=null,Xn=null,Ql=!1,Zn=null,Gl=0,Zo=0,Qf=null,Yl=-1,Xl=0;function it(){return ee&6?Se():Yl!==-1?Yl:Yl=Se()}function er(t){return t.mode&1?ee&2&&je!==0?je&-je:_S.transition!==null?(Xl===0&&(Xl=vm()),Xl):(t=re,t!==0||(t=window.event,t=t===void 0?16:Mm(t.type)),t):1}function Qt(t,e,n,r){if(50<Zo)throw Zo=0,Qf=null,Error(N(185));Eo(t,n,r),(!(ee&2)||t!==De)&&(t===De&&(!(ee&2)&&(ql|=n),Oe===4&&tr(t,je)),dt(t,r),n===1&&ee===0&&!(e.mode&1)&&(zi=Se()+500,Tl&&Jn()))}function dt(t,e){var n=t.callbackNode;_x(t,e);var r=ll(t,t===De?je:0);if(r===0)n!==null&&mm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&mm(n),e===1)t.tag===0?BS(My.bind(null,t)):dg(My.bind(null,t)),IS(function(){!(ee&6)&&Jn()}),n=null;else{switch(km(r)){case 1:n=Mc;break;case 4:n=gm;break;case 16:n=rl;break;case 536870912:n=ym;break;default:n=rl}n=Ly(n,Ty.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ty(t,e){if(Yl=-1,Xl=0,ee&6)throw Error(N(327));var n=t.callbackNode;if(Bi()&&t.callbackNode!==n)return null;var r=ll(t,t===De?je:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zl(t,r);else{e=r;var i=ee;ee|=2;var o=Oy();(De!==t||je!==e)&&(Cn=null,zi=Se()+500,zr(t,e));do try{iE();break}catch(l){Ny(t,l)}while(!0);pf(),Kl.current=o,ee=i,Ce!==null?e=0:(De=null,je=0,e=Oe)}if(e!==0){if(e===2&&(i=Nc(t),i!==0&&(r=i,e=Gf(t,i))),e===1)throw n=Yo,zr(t,0),tr(t,r),dt(t,Se()),n;if(e===6)tr(t,r);else{if(i=t.current.alternate,!(r&30)&&!nE(i)&&(e=Zl(t,r),e===2&&(o=Nc(t),o!==0&&(r=o,e=Gf(t,o))),e===1))throw n=Yo,zr(t,0),tr(t,r),dt(t,Se()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(N(345));case 2:Br(t,ft,Cn);break;case 3:if(tr(t,r),(r&130023424)===r&&(e=qf+500-Se(),10<e)){if(ll(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){it(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=tf(Br.bind(null,t,ft,Cn),e);break}Br(t,ft,Cn);break;case 4:if(tr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Vt(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Se()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tE(r/1960))-r,10<r){t.timeoutHandle=tf(Br.bind(null,t,ft,Cn),r);break}Br(t,ft,Cn);break;case 5:Br(t,ft,Cn);break;default:throw Error(N(329))}}}return dt(t,Se()),t.callbackNode===n?Ty.bind(null,t):null}function Gf(t,e){var n=Xo;return t.current.memoizedState.isDehydrated&&(zr(t,e).flags|=256),t=Zl(t,e),t!==2&&(e=ft,ft=n,e!==null&&Yf(e)),t}function Yf(t){ft===null?ft=t:ft.push.apply(ft,t)}function nE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ut(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tr(t,e){for(e&=~Kf,e&=~ql,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vt(e),r=1<<n;t[n]=-1,e&=~r}}function My(t){if(ee&6)throw Error(N(327));Bi();var e=ll(t,0);if(!(e&1))return dt(t,Se()),null;var n=Zl(t,e);if(t.tag!==0&&n===2){var r=Nc(t);r!==0&&(e=r,n=Gf(t,r))}if(n===1)throw n=Yo,zr(t,0),tr(t,e),dt(t,Se()),n;if(n===6)throw Error(N(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Br(t,ft,Cn),dt(t,Se()),null}function Xf(t,e){var n=ee;ee|=1;try{return t(e)}finally{ee=n,ee===0&&(zi=Se()+500,Tl&&Jn())}}function Lr(t){Zn!==null&&Zn.tag===0&&!(ee&6)&&Bi();var e=ee;ee|=1;var n=Rt.transition,r=re;try{if(Rt.transition=null,re=1,t)return t()}finally{re=r,Rt.transition=n,ee=e,!(ee&6)&&Jn()}}function Zf(){Et=Li.current,ue(Li)}function zr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,DS(n)),Ce!==null)for(n=Ce.return;n!==null;){var r=n;switch(af(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cl();break;case 3:Di(),ue(at),ue(We),xf();break;case 5:kf(r);break;case 4:Di();break;case 13:ue(ge);break;case 19:ue(ge);break;case 10:hf(r.type._context);break;case 22:case 23:Zf()}n=n.return}if(De=t,Ce=t=nr(t.current,null),je=Et=e,Oe=0,Yo=null,Kf=ql=Pr=0,ft=Xo=null,Rr!==null){for(e=0;e<Rr.length;e++)if(n=Rr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Rr=null}return t}function Ny(t,e){do{var n=Ce;try{if(pf(),zl.current=jl,Bl){for(var r=ye.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Bl=!1}if(Ir=0,Re=Ne=ye=null,Wo=!1,Ko=0,Wf.current=null,n===null||n.return===null){Oe=1,Yo=e,Ce=null;break}e:{var o=t,s=n.return,l=n,a=e;if(e=je,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=Zg(s);if(p!==null){p.flags&=-257,ey(p,s,l,o,e),p.mode&1&&Xg(o,u,e),e=p,a=u;var h=e.updateQueue;if(h===null){var g=new Set;g.add(a),e.updateQueue=g}else h.add(a);break e}else{if(!(e&1)){Xg(o,u,e),ed();break e}a=Error(N(426))}}else if(fe&&l.mode&1){var y=Zg(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),ey(y,s,l,o,e),ff(Ii(a,l));break e}}o=a=Ii(a,l),Oe!==4&&(Oe=2),Xo===null?Xo=[o]:Xo.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=Gg(o,a,e);Eg(o,m);break e;case 1:l=a;var v=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Xn===null||!Xn.has(w)))){o.flags|=65536,e&=-e,o.lanes|=e;var k=Yg(o,l,e);Eg(o,k);break e}}o=o.return}while(o!==null)}Ry(n)}catch(S){e=S,Ce===n&&n!==null&&(Ce=n=n.return);continue}break}while(!0)}function Oy(){var t=Kl.current;return Kl.current=jl,t===null?jl:t}function ed(){(Oe===0||Oe===3||Oe===2)&&(Oe=4),De===null||!(Pr&268435455)&&!(ql&268435455)||tr(De,je)}function Zl(t,e){var n=ee;ee|=2;var r=Oy();(De!==t||je!==e)&&(Cn=null,zr(t,e));do try{rE();break}catch(i){Ny(t,i)}while(!0);if(pf(),ee=n,Kl.current=r,Ce!==null)throw Error(N(261));return De=null,je=0,Oe}function rE(){for(;Ce!==null;)Ay(Ce)}function iE(){for(;Ce!==null&&!Ox();)Ay(Ce)}function Ay(t){var e=Py(t.alternate,t,Et);t.memoizedProps=t.pendingProps,e===null?Ry(t):Ce=e,Wf.current=null}function Ry(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=YS(n,e),n!==null){n.flags&=32767,Ce=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Oe=6,Ce=null;return}}else if(n=GS(n,e,Et),n!==null){Ce=n;return}if(e=e.sibling,e!==null){Ce=e;return}Ce=e=t}while(e!==null);Oe===0&&(Oe=5)}function Br(t,e,n){var r=re,i=Rt.transition;try{Rt.transition=null,re=1,oE(t,e,n,r)}finally{Rt.transition=i,re=r}return null}function oE(t,e,n,r){do Bi();while(Zn!==null);if(ee&6)throw Error(N(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(N(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if($x(t,o),t===De&&(Ce=De=null,je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ql||(Ql=!0,Ly(rl,function(){return Bi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Rt.transition,Rt.transition=null;var s=re;re=1;var l=ee;ee|=4,Wf.current=null,ZS(t,n),xy(n,t),bS(Zc),cl=!!Xc,Zc=Xc=null,t.current=n,eE(n),Ax(),ee=l,re=s,Rt.transition=o}else t.current=n;if(Ql&&(Ql=!1,Zn=t,Gl=i),o=t.pendingLanes,o===0&&(Xn=null),Ix(n.stateNode),dt(t,Se()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Jl)throw Jl=!1,t=Jf,Jf=null,t;return Gl&1&&t.tag!==0&&Bi(),o=t.pendingLanes,o&1?t===Qf?Zo++:(Zo=0,Qf=t):Zo=0,Jn(),null}function Bi(){if(Zn!==null){var t=km(Gl),e=Rt.transition,n=re;try{if(Rt.transition=null,re=16>t?16:t,Zn===null)var r=!1;else{if(t=Zn,Zn=null,Gl=0,ee&6)throw Error(N(331));var i=ee;for(ee|=4,P=t.current;P!==null;){var o=P,s=o.child;if(P.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(P=u;P!==null;){var c=P;switch(c.tag){case 0:case 11:case 15:Go(8,c,o)}var f=c.child;if(f!==null)f.return=c,P=f;else for(;P!==null;){c=P;var d=c.sibling,p=c.return;if(gy(c),c===u){P=null;break}if(d!==null){d.return=p,P=d;break}P=p}}}var h=o.alternate;if(h!==null){var g=h.child;if(g!==null){h.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}P=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,P=s;else e:for(;P!==null;){if(o=P,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Go(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,P=m;break e}P=o.return}}var v=t.current;for(P=v;P!==null;){s=P;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,P=w;else e:for(s=v;P!==null;){if(l=P,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Wl(9,l)}}catch(S){ve(l,l.return,S)}if(l===s){P=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,P=k;break e}P=l.return}}if(ee=i,Jn(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(il,t)}catch{}r=!0}return r}finally{re=n,Rt.transition=e}}return!1}function Dy(t,e,n){e=Ii(n,e),e=Gg(t,e,1),t=Gn(t,e,1),e=it(),t!==null&&(Eo(t,1,e),dt(t,e))}function ve(t,e,n){if(t.tag===3)Dy(t,t,n);else for(;e!==null;){if(e.tag===3){Dy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xn===null||!Xn.has(r))){t=Ii(n,t),t=Yg(e,t,1),e=Gn(e,t,1),t=it(),e!==null&&(Eo(e,1,t),dt(e,t));break}}e=e.return}}function sE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=it(),t.pingedLanes|=t.suspendedLanes&n,De===t&&(je&n)===n&&(Oe===4||Oe===3&&(je&130023424)===je&&500>Se()-qf?zr(t,0):Kf|=n),dt(t,e)}function Iy(t,e){e===0&&(t.mode&1?(e=sl,sl<<=1,!(sl&130023424)&&(sl=4194304)):e=1);var n=it();t=xn(t,e),t!==null&&(Eo(t,e,n),dt(t,n))}function lE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Iy(t,n)}function aE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(N(314))}r!==null&&r.delete(e),Iy(t,n)}var Py;Py=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||at.current)ct=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ct=!1,QS(t,e,n);ct=!!(t.flags&131072)}else ct=!1,fe&&e.flags&1048576&&pg(e,Nl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vl(t,e),t=e.pendingProps;var i=bi(e,We.current);Ri(e,n),i=Cf(null,e,r,t,i,n);var o=bf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ut(r)?(o=!0,bl(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yf(e),i.updater=Fl,e.stateNode=i,i._reactInternals=e,Rf(e,r,t,n),e=Lf(null,e,r,!0,o,n)):(e.tag=0,fe&&o&&lf(e),rt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vl(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=cE(r),t=Kt(r,t),i){case 0:e=Pf(null,e,r,t,n);break e;case 1:e=sy(null,e,r,t,n);break e;case 11:e=ty(null,e,r,t,n);break e;case 14:e=ny(null,e,r,Kt(r.type,t),n);break e}throw Error(N(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kt(r,i),Pf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kt(r,i),sy(t,e,r,i,n);case 3:e:{if(ly(e),t===null)throw Error(N(387));r=e.pendingProps,o=e.memoizedState,i=o.element,Sg(t,e),Pl(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Ii(Error(N(423)),e),e=ay(t,e,r,n,i);break e}else if(r!==i){i=Ii(Error(N(424)),e),e=ay(t,e,r,n,i);break e}else for(St=Wn(e.stateNode.containerInfo.firstChild),xt=e,fe=!0,Wt=null,n=wg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ni(),r===i){e=En(t,e,n);break e}rt(t,e,r,n)}e=e.child}return e;case 5:return bg(e),t===null&&cf(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,ef(r,i)?s=null:o!==null&&ef(r,o)&&(e.flags|=32),oy(t,e),rt(t,e,s,n),e.child;case 6:return t===null&&cf(e),null;case 13:return uy(t,e,n);case 4:return vf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Oi(e,null,r,n):rt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kt(r,i),ty(t,e,r,i,n);case 7:return rt(t,e,e.pendingProps,n),e.child;case 8:return rt(t,e,e.pendingProps.children,n),e.child;case 12:return rt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,le(Rl,r._currentValue),r._currentValue=s,o!==null)if(Ut(o.value,s)){if(o.children===i.children&&!at.current){e=En(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=Sn(-1,n&-n),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),mf(o.return,n,e),l.lanes|=n;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(N(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),mf(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}rt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ri(e,n),i=Ot(i),r=r(i),e.flags|=1,rt(t,e,r,n),e.child;case 14:return r=e.type,i=Kt(r,e.pendingProps),i=Kt(r.type,i),ny(t,e,r,i,n);case 15:return ry(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kt(r,i),Vl(t,e),e.tag=1,ut(r)?(t=!0,bl(e)):t=!1,Ri(e,n),Jg(e,r,i),Rf(e,r,i,n),Lf(null,e,r,!0,t,n);case 19:return fy(t,e,n);case 22:return iy(t,e,n)}throw Error(N(156,e.tag))};function Ly(t,e){return hm(t,e)}function uE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dt(t,e,n,r){return new uE(t,e,n,r)}function td(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cE(t){if(typeof t=="function")return td(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sc)return 11;if(t===uc)return 14}return 2}function nr(t,e){var n=t.alternate;return n===null?(n=Dt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ea(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")td(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case di:return _r(n.children,i,o,e);case ic:s=8,i|=8;break;case oc:return t=Dt(12,n,e,i|2),t.elementType=oc,t.lanes=o,t;case lc:return t=Dt(13,n,e,i),t.elementType=lc,t.lanes=o,t;case ac:return t=Dt(19,n,e,i),t.elementType=ac,t.lanes=o,t;case Uh:return ta(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hh:s=10;break e;case Vh:s=9;break e;case sc:s=11;break e;case uc:s=14;break e;case Bn:s=16,r=null;break e}throw Error(N(130,t==null?t:typeof t,""))}return e=Dt(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function _r(t,e,n,r){return t=Dt(7,t,r,e),t.lanes=n,t}function ta(t,e,n,r){return t=Dt(22,t,r,e),t.elementType=Uh,t.lanes=n,t.stateNode={isHidden:!1},t}function nd(t,e,n){return t=Dt(6,t,null,e),t.lanes=n,t}function rd(t,e,n){return e=Dt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fE(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oc(0),this.expirationTimes=Oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function id(t,e,n,r,i,o,s,l,a){return t=new fE(t,e,n,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Dt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yf(o),t}function dE(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function zy(t){if(!t)return qn;t=t._reactInternals;e:{if(Tr(t)!==t||t.tag!==1)throw Error(N(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ut(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(t.tag===1){var n=t.type;if(ut(n))return cg(t,n,e)}return e}function By(t,e,n,r,i,o,s,l,a){return t=id(n,r,!0,t,i,o,s,l,a),t.context=zy(null),n=t.current,r=it(),i=er(n),o=Sn(r,i),o.callback=e??null,Gn(n,o,i),t.current.lanes=i,Eo(t,i,r),dt(t,r),t}function na(t,e,n,r){var i=e.current,o=it(),s=er(i);return n=zy(n),e.context===null?e.context=n:e.pendingContext=n,e=Sn(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Gn(i,e,s),t!==null&&(Qt(t,i,s,o),Il(t,i,s)),s}function ra(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _y(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function od(t,e){_y(t,e),(t=t.alternate)&&_y(t,e)}function pE(){return null}var $y=typeof reportError=="function"?reportError:function(t){console.error(t)};function sd(t){this._internalRoot=t}ia.prototype.render=sd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(N(409));na(t,e,null,null)},ia.prototype.unmount=sd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Lr(function(){na(null,t,null,null)}),e[yn]=null}};function ia(t){this._internalRoot=t}ia.prototype.unstable_scheduleHydration=function(t){if(t){var e=Sm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hn.length&&e!==0&&e<Hn[n].priority;n++);Hn.splice(n,0,t),n===0&&bm(t)}};function ld(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function oa(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jy(){}function hE(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=ra(s);o.call(u)}}var s=By(e,r,t,0,null,!1,!1,"",jy);return t._reactRootContainer=s,t[yn]=s.current,Bo(t.nodeType===8?t.parentNode:t),Lr(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=ra(a);l.call(u)}}var a=id(t,0,!1,null,null,!1,!1,"",jy);return t._reactRootContainer=a,t[yn]=a.current,Bo(t.nodeType===8?t.parentNode:t),Lr(function(){na(e,a,n,r)}),a}function sa(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=ra(s);l.call(a)}}na(e,s,t,i)}else s=hE(n,e,t,i,r);return ra(s)}wm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=So(e.pendingLanes);n!==0&&(Ac(e,n|1),dt(e,Se()),!(ee&6)&&(zi=Se()+500,Jn()))}break;case 13:Lr(function(){var r=xn(t,1);if(r!==null){var i=it();Qt(r,t,1,i)}}),od(t,1)}},Rc=function(t){if(t.tag===13){var e=xn(t,134217728);if(e!==null){var n=it();Qt(e,t,134217728,n)}od(t,134217728)}},xm=function(t){if(t.tag===13){var e=er(t),n=xn(t,e);if(n!==null){var r=it();Qt(n,t,e,r)}od(t,e)}},Sm=function(){return re},Em=function(t,e){var n=re;try{return re=t,e()}finally{re=n}},Ec=function(t,e,n){switch(e){case"input":if(mc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=El(r);if(!i)throw Error(N(90));qh(r),mc(r,i)}}}break;case"textarea":Xh(t,n);break;case"select":e=n.value,e!=null&&pi(t,!!n.multiple,e,!1)}},lm=Xf,am=Lr;var mE={usingClientEntryPoint:!1,Events:[jo,Ei,El,om,sm,Xf]},es={findFiberByHostInstance:Mr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gE={bundleType:es.bundleType,version:es.version,rendererPackageName:es.rendererPackageName,rendererConfig:es.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=dm(t),t===null?null:t.stateNode},findFiberByHostInstance:es.findFiberByHostInstance||pE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var la=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!la.isDisabled&&la.supportsFiber)try{il=la.inject(gE),tn=la}catch{}}vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE,vt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ld(e))throw Error(N(200));return dE(t,e,null,n)},vt.createRoot=function(t,e){if(!ld(t))throw Error(N(299));var n=!1,r="",i=$y;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=id(t,1,!1,null,null,n,!1,r,i),t[yn]=e.current,Bo(t.nodeType===8?t.parentNode:t),new sd(e)},vt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(N(188)):(t=Object.keys(t).join(","),Error(N(268,t)));return t=dm(e),t=t===null?null:t.stateNode,t},vt.flushSync=function(t){return Lr(t)},vt.hydrate=function(t,e,n){if(!oa(e))throw Error(N(200));return sa(null,t,e,!0,n)},vt.hydrateRoot=function(t,e,n){if(!ld(t))throw Error(N(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=$y;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=By(e,null,t,1,n??null,i,!1,o,s),t[yn]=e.current,Bo(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ia(e)},vt.render=function(t,e,n){if(!oa(e))throw Error(N(200));return sa(null,t,e,!1,n)},vt.unmountComponentAtNode=function(t){if(!oa(t))throw Error(N(40));return t._reactRootContainer?(Lr(function(){sa(null,null,t,!1,function(){t._reactRootContainer=null,t[yn]=null})}),!0):!1},vt.unstable_batchedUpdates=Xf,vt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!oa(n))throw Error(N(200));if(t==null||t._reactInternals===void 0)throw Error(N(38));return sa(t,e,n,!1,r)},vt.version="18.3.1-next-f1338f8080-20240426";function Fy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fy)}catch(t){console.error(t)}}Fy(),zh.exports=vt;var ad=zh.exports;const yE=xh(ad);var Hy=ad;Zu.createRoot=Hy.createRoot,Zu.hydrateRoot=Hy.hydrateRoot;var Vy={exports:{}},Uy={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _i=ne;function vE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kE=typeof Object.is=="function"?Object.is:vE,wE=_i.useState,xE=_i.useEffect,SE=_i.useLayoutEffect,EE=_i.useDebugValue;function CE(t,e){var n=e(),r=wE({inst:{value:n,getSnapshot:e}}),i=r[0].inst,o=r[1];return SE(function(){i.value=n,i.getSnapshot=e,ud(i)&&o({inst:i})},[t,n,e]),xE(function(){return ud(i)&&o({inst:i}),t(function(){ud(i)&&o({inst:i})})},[t]),EE(n),n}function ud(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!kE(t,n)}catch{return!0}}function bE(t,e){return e()}var TE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?bE:CE;Uy.useSyncExternalStore=_i.useSyncExternalStore!==void 0?_i.useSyncExternalStore:TE,Vy.exports=Uy;var cd=Vy.exports;function Fe(t){this.content=t}Fe.prototype={constructor:Fe,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new Fe(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Fe(n)},addToStart:function(t,e){return new Fe([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Fe(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new Fe(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Fe.from(t),t.size?new Fe(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Fe.from(t),t.size?new Fe(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Fe.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}},Fe.from=function(t){if(t instanceof Fe)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Fe(e)};function Wy(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=Wy(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function Ky(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){n-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:n,b:r};if(s.isText&&s.text!=l.text){let u=0,c=Math.min(s.text.length,l.text.length);for(;u<c&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||l.content.size){let u=Ky(s.content,l.content,n-1,r-1);if(u)return u}n-=a,r-=a}}class T{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,l=0;l<n;s++){let a=this.content[s],u=l+a.nodeSize;if(u>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,n-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new T(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,n-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,n-s-1))),r.push(l),i+=l.nodeSize),s=a}return new T(r,i)}cutByIndex(e,n){return e==n?T.empty:e==0&&n==this.content.length?this:new T(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new T(i,o)}addToStart(e){return new T([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new T(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return Wy(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return Ky(this,e,n,r)}findIndex(e){if(e==0)return aa(0,e);if(e==this.size)return aa(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),o=r+i.nodeSize;if(o>=e)return o==e?aa(n+1,o):aa(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return T.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new T(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return T.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new T(n||e,r)}static from(e){if(!e)return T.empty;if(e instanceof T)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new T([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}T.empty=new T([],0);const fd={index:0,offset:0};function aa(t,e){return fd.index=t,fd.offset=e,fd}function ua(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!ua(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!ua(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let se=class kh{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ua(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return kh.none;if(e instanceof kh)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};se.none=[];class ca extends Error{}class D{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=Jy(this.content,e+this.openStart,n);return r&&new D(r,this.openStart,this.openEnd)}removeBetween(e,n){return new D(qy(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return D.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new D(T.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new D(e,r,i)}}D.empty=new D(T.empty,0,0);function qy(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:l}=t.findIndex(n);if(i==e||o.isText){if(l!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(qy(o.content,e-i-1,n-i-1)))}function Jy(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=Jy(s.content,e-o-1,n,s);return l&&t.replaceChild(i,s.copy(l))}function ME(t,e,n){if(n.openStart>t.depth)throw new ca("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new ca("Inconsistent open depths");return Qy(t,e,n,0)}function Qy(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=Qy(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,l=s.content;return jr(s,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=NE(n,t);return jr(o,Yy(t,s,l,e,r))}else return jr(o,fa(t,e,r))}function Gy(t,e){if(!e.type.compatibleContent(t.type))throw new ca("Cannot join "+e.type.name+" onto "+t.type.name)}function dd(t,e,n){let r=t.node(n);return Gy(r,e.node(n)),r}function $r(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ts(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&($r(t.nodeAfter,r),o++));for(let l=o;l<s;l++)$r(i.child(l),r);e&&e.depth==n&&e.textOffset&&$r(e.nodeBefore,r)}function jr(t,e){return t.type.checkContent(e),t.copy(e)}function Yy(t,e,n,r,i){let o=t.depth>i&&dd(t,e,i+1),s=r.depth>i&&dd(n,r,i+1),l=[];return ts(null,t,i,l),o&&s&&e.index(i)==n.index(i)?(Gy(o,s),$r(jr(o,Yy(t,e,n,r,i+1)),l)):(o&&$r(jr(o,fa(t,e,i+1)),l),ts(e,n,i,l),s&&$r(jr(s,fa(n,r,i+1)),l)),ts(r,null,i,l),new T(l)}function fa(t,e,n){let r=[];if(ts(null,t,n,r),t.depth>n){let i=dd(t,e,n+1);$r(jr(i,fa(t,e,n+1)),r)}return ts(e,null,n,r),new T(r)}function NE(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(T.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class ns{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return se.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new da(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),u=o-a;if(r.push(s,l,i+a),!u||(s=s.child(l),s.isText))break;o=u-1,i+=a+1}return new ns(n,r,o)}static resolveCached(e,n){let r=Xy.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else Xy.set(e,r=new OE);let i=r.elts[r.i]=ns.resolve(e,n);return r.i=(r.i+1)%AE,i}}class OE{constructor(){this.elts=[],this.i=0}}const AE=12,Xy=new WeakMap;class da{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const RE=Object.create(null);class Gt{constructor(e,n,r,i=se.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||T.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&ua(this.attrs,n||e.defaultAttrs||RE)&&se.sameSet(this.marks,r||se.none)}copy(e=null){return e==this.content?this:new Gt(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Gt(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return D.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),l=i.start(s),u=i.node(s).content.cut(i.pos-l,o.pos-l);return new D(u,i.depth-s,o.depth-s)}replace(e,n,r){return ME(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return ns.resolveCached(this,e)}resolveNoCache(e){return ns.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Zy(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=T.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=se.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!se.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=T.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}}Gt.prototype.text=void 0;class pa extends Gt{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Zy(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new pa(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new pa(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Zy(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Fr{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new DE(e,n);if(r.next==null)return Fr.empty;let i=e0(r);r.next&&r.err("Unexpected trailing text");let o=$E(_E(i));return jE(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!n||a.validEnd))return T.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,l.concat(c));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Fr.empty=new Fr(!0);class DE{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function e0(t){let e=[];do e.push(IE(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function IE(t){let e=[];do e.push(PE(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function PE(t){let e=BE(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=LE(t,e);else break;return e}function t0(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function LE(t,e){let n=t0(t),r=n;return t.eat(",")&&(t.next!="}"?r=t0(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function zE(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function BE(t){if(t.eat("(")){let e=e0(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=zE(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function _E(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,l,a){let u={term:a,to:l};return e[s].push(u),u}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,u)=>a.concat(o(u,l)),[]);if(s.type=="seq")for(let a=0;;a++){let u=o(s.exprs[a],l);if(a==s.exprs.length-1)return u;i(u,l=n())}else if(s.type=="star"){let a=n();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=n();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let u=0;u<s.min;u++){let c=n();i(o(s.expr,a),c),a=c}if(s.max==-1)i(o(s.expr,a),a);else for(let u=s.min;u<s.max;u++){let c=n();r(a,c),i(o(s.expr,a),c),a=c}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function n0(t,e){return e-t}function r0(t,e){let n=[];return r(e),n.sort(n0);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&n.indexOf(a)==-1&&r(a)}}}function $E(t){let e=Object.create(null);return n(r0(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);r0(t,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new Fr(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(n0);o.next.push({type:i[s][0],next:e[l.join(",")]||n(l)})}return o}}function jE(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function i0(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function o0(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function s0(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function l0(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new HE(t,r,e[r]);return n}let a0=class jw{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=l0(e,r.attrs),this.defaultAttrs=i0(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Fr.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:o0(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Gt(this,this.computeAttrs(e),T.from(n),se.setFrom(r))}createChecked(e=null,n,r){return n=T.from(n),this.checkContent(n),new Gt(this,this.computeAttrs(e),n,se.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=T.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(T.empty,!0);return o?new Gt(this,e,n.append(o),se.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){s0(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:se.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new jw(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function FE(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class HE{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?FE(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ha{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=l0(e,i.attrs),this.excluded=null;let o=i0(this.attrs);this.instance=o?new se(this,o):null}create(e=null){return!e&&this.instance?this.instance:new se(this,o0(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new ha(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){s0(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class u0{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=Fe.from(e.nodes),n.marks=Fe.from(e.marks||{}),this.nodes=a0.compile(this.spec.nodes,this),this.marks=ha.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Fr.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?c0(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:c0(this,s.split(" "))}this.nodeFromJSON=i=>Gt.fromJSON(this,i),this.markFromJSON=i=>se.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof a0){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new pa(r,r.defaultAttrs,e,se.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function c0(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function VE(t){return t.tag!=null}function UE(t){return t.style!=null}class rr{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(VE(i))this.tags.push(i);else if(UE(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new h0(this,n,!1);return r.addAll(e,se.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new h0(this,n,!0);return r.addAll(e,se.none,n.from,n.to),D.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(qE(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(s.getAttrs){let a=s.getAttrs(n);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let l=n[s];if((l.priority==null?50:l.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=m0(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=m0(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new rr(e,rr.schemaRules(e)))}}const f0={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},WE={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},d0={ol:!0,ul:!0},rs=1,pd=2,is=4;function p0(t,e,n){return e!=null?(e?rs:0)|(e==="full"?pd:0):t&&t.whitespace=="pre"?rs|pd:n&~is}class ma{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=se.none,this.match=o||(s&is?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(T.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&rs)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=T.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(T.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!f0.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class h0{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=p0(null,n.preserveWhitespace,0)|(r?is:0);i?o=new ma(i.type,i.attrs,se.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new ma(null,null,se.none,!0,null,s):o=new ma(e.schema.topNodeType,null,se.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&pd?"full":this.localPreserveWS||(i.options&rs)>0,{schema:s}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(s.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let a=0;a<l.length;a++)a&&this.insertNode(s.linebreakReplacement.create(),n,!0),l[a]&&this.insertNode(s.text(l[a]),n,!/\S/.test(l[a]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],a=e.previousSibling;(!l||a&&a.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(s.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),l;d0.hasOwnProperty(s)&&this.parser.normalizeLists&&KE(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:WE.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let u,c=this.needsBlock;if(f0.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),u=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let f=a&&a.skip?n:this.readStyles(e,n);f&&this.addAll(e,f),u&&this.sync(o),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,a,u,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(o,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?n=n.filter(u=>!a.clearMark(u)):n=n.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(s,n.attrs||null,r,n.preserveWhitespace);a&&(o=!0,r=a)}else{let a=this.parser.schema.marks[n.mark];r=r.concat(a.create(n.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}o&&this.sync(l)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];s!=l;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n,r){let i,o;for(let s=this.open,l=0;s>=0;s--){let a=this.nodes[s],u=a.findWrapping(e);if(u&&(!i||i.length>u.length+l)&&(i=u,o=a,!u.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)n=this.enterInner(i[s],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=se.none;for(let l of i.concat(e.marks))(o.type?o.type.allowsMarkType(l.type):g0(l.type,e.type))&&(s=l.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r,!1);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let l=p0(e,o,s.options);s.options&is&&s.content.length==0&&(l|=is);let a=se.none;return r=r.filter(u=>(s.type?s.type.allowsMarkType(u.type):g0(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new ma(e,n,a,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=rs)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let u=n[l];if(u==""){if(l==n.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;a--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function KE(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&d0.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function qE(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function m0(t){let e={};for(let n in t)e[n]=t[n];return e}function g0(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Hr{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=hd(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let u=s.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(o[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let u=s.marks[a++],c=this.serializeMark(u,s.isInline,n);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=ga(hd(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&ga(hd(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return ga(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Hr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=y0(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return y0(e.marks)}}function y0(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function hd(t){return t.document||window.document}const v0=new WeakMap;function JE(t){let e=v0.get(t);return e===void 0&&v0.set(t,e=QE(t)),e}function QE(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function ga(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=JE(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let l,a=n?t.createElementNS(n,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let f in u)if(u[f]!=null){let d=f.indexOf(" ");d>0?a.setAttributeNS(f.slice(0,d),f.slice(d+1),u[f]):f=="style"&&a.style?a.style.cssText=u[f]:a.setAttribute(f,u[f])}}for(let f=c;f<e.length;f++){let d=e[f];if(d===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:p,contentDOM:h}=ga(t,d,n,r);if(a.appendChild(p),h){if(l)throw new RangeError("Multiple content holes");l=h}}}return{dom:a,contentDOM:l}}const k0=65535,w0=Math.pow(2,16);function GE(t,e){return t+e*w0}function x0(t){return t&k0}function YE(t){return(t-(t&k0))/w0}const S0=1,E0=2,ya=4,C0=8;class md{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&C0)>0}get deletedBefore(){return(this.delInfo&(S0|ya))>0}get deletedAfter(){return(this.delInfo&(E0|ya))>0}get deletedAcross(){return(this.delInfo&ya)>0}}class Ct{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Ct.empty)return Ct.empty}recover(e){let n=0,r=x0(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+YE(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:n:n,p=a+i+(d<0?0:c);if(r)return p;let h=e==(n<0?a:f)?null:GE(l/3,e-a),g=e==a?E0:e==f?S0:ya;return(n<0?e!=a:e!=f)&&(g|=C0),new md(p,g,h)}i+=c-u}return r?e+i:new md(e+i,0,null)}touches(e,n){let r=0,i=x0(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+n],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Ct(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ct.empty:new Ct(e<0?[0,-e,0]:[0,0,e])}}Ct.empty=new Ct([]);class ss{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new ss(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new ss;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],l=s.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new md(e,i,null)}}const gd=Object.create(null);class Qe{getMap(){return Ct.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=gd[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in gd)throw new RangeError("Duplicate use of step JSON ID "+e);return gd[e]=n,n.prototype.jsonID=e,n}}class be{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new be(e,null)}static fail(e){return new be(null,e)}static fromReplace(e,n,r,i){try{return be.ok(e.replace(n,r,i))}catch(o){if(o instanceof ca)return be.fail(o.message);throw o}}}function yd(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(yd(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return T.fromArray(r)}class ir extends Qe{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new D(yd(n.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return be.fromReplace(e,this.from,this.to,o)}invert(){return new Yt(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ir(n.pos,r.pos,this.mark)}merge(e){return e instanceof ir&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ir(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ir(n.from,n.to,e.markFromJSON(n.mark))}}Qe.jsonID("addMark",ir);class Yt extends Qe{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new D(yd(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return be.fromReplace(e,this.from,this.to,r)}invert(){return new ir(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Yt(n.pos,r.pos,this.mark)}merge(e){return e instanceof Yt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Yt(n.from,n.to,e.markFromJSON(n.mark))}}Qe.jsonID("removeMark",Yt);class or extends Qe{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return be.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return be.fromReplace(e,this.pos,this.pos+1,new D(T.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new or(this.pos,n.marks[i]);return new or(this.pos,this.mark)}}return new Vr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new or(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new or(n.pos,e.markFromJSON(n.mark))}}Qe.jsonID("addNodeMark",or);class Vr extends Qe{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return be.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return be.fromReplace(e,this.pos,this.pos+1,new D(T.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new or(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Vr(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Vr(n.pos,e.markFromJSON(n.mark))}}Qe.jsonID("removeNodeMark",Vr);class Ie extends Qe{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&vd(e,this.from,this.to)?be.fail("Structure replace would overwrite content"):be.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ct([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ie(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Ie(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ie)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?D.empty:new D(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ie(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?D.empty:new D(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ie(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ie(n.from,n.to,D.fromJSON(e,n.slice),!!n.structure)}}Qe.jsonID("replace",Ie);class Pe extends Qe{constructor(e,n,r,i,o,s,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(vd(e,this.from,this.gapFrom)||vd(e,this.gapTo,this.to)))return be.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return be.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?be.fromReplace(e,this.from,this.to,r):be.fail("Content does not fit in gap")}getMap(){return new Ct([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Pe(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new Pe(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Pe(n.from,n.to,n.gapFrom,n.gapTo,D.fromJSON(e,n.slice),n.insert,!!n.structure)}}Qe.jsonID("replaceAround",Pe);function vd(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function XE(t,e,n,r){let i=[],o=[],s,l;t.doc.nodesBetween(e,n,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),p=Math.min(u+a.nodeSize,n),h=r.addToSet(f);for(let g=0;g<f.length;g++)f[g].isInSet(h)||(s&&s.to==d&&s.mark.eq(f[g])?s.to=p:i.push(s=new Yt(d,p,f[g])));l&&l.to==d?l.to=p:o.push(l=new ir(d,p,r))}}),i.forEach(a=>t.step(a)),o.forEach(a=>t.step(a))}function ZE(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof ha){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,n);for(let c=0;c<a.length;c++){let f=a[c],d;for(let p=0;p<i.length;p++){let h=i[p];h.step==o-1&&f.eq(i[p].style)&&(d=h)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>t.step(new Yt(s.from,s.to,s.style)))}function kd(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],l=e+1;for(let a=0;a<o.childCount;a++){let u=o.child(a),c=l+u.nodeSize,f=r.matchType(u.type);if(!f)s.push(new Ie(l,c,D.empty));else{r=f;for(let d=0;d<u.marks.length;d++)n.allowsMarkType(u.marks[d].type)||t.step(new Yt(l,c,u.marks[d]));if(i&&u.isText&&n.whitespace!="pre"){let d,p=/\r?\n|\r/g,h;for(;d=p.exec(u.text);)h||(h=new D(T.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),s.push(new Ie(l+d.index,l+d.index+d[0].length,h))}}l=c}if(!r.validEnd){let a=r.fillBefore(T.empty,!0);t.replace(l,l,new D(a,0,0))}for(let a=s.length-1;a>=0;a--)t.step(s[a])}function eC(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function $i(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,o=0;;--r){let s=t.$from.node(r),l=t.$from.index(r)+i,a=t.$to.indexAfter(r)-o;if(r<t.depth&&s.canReplace(l,a,n))return r;if(r==0||s.type.spec.isolating||!eC(s,l,a))break;l&&(i=1),a<s.childCount&&(o=1)}return null}function tC(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=T.empty,f=0;for(let h=o,g=!1;h>n;h--)g||r.index(h)>0?(g=!0,c=T.from(r.node(h).copy(c)),f++):a--;let d=T.empty,p=0;for(let h=o,g=!1;h>n;h--)g||i.after(h+1)<i.end(h)?(g=!0,d=T.from(i.node(h).copy(d)),p++):u++;t.step(new Pe(a,u,s,l,new D(c.append(d),f,p),c.size-f,!0))}function wd(t,e,n=null,r=t){let i=nC(t,e),o=i&&rC(r,e);return o?i.map(b0).concat({type:e,attrs:n}).concat(o.map(b0)):null}function b0(t){return{type:t,attrs:null}}function nC(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function rC(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(n.child(u).type);return!a||!a.validEnd?null:s}function iC(t,e,n){let r=T.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let l=n[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=T.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new Pe(i,o,i,o,new D(r,0,0),n.length,!0))}function oC(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,l)=>{let a=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,a)&&sC(t.doc,t.mapping.slice(o).map(l),r)){let u=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",h=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!h?u=!1:!p&&h&&(u=!0)}u===!1&&M0(t,s,l,o),kd(t,t.mapping.slice(o).map(l,1),r,void 0,u===null);let c=t.mapping.slice(o),f=c.map(l,1),d=c.map(l+s.nodeSize,1);return t.step(new Pe(f,d,f+1,d-1,new D(T.from(r.create(a,null,s.marks)),0,0),1,!0)),u===!0&&T0(t,s,l,o),!1}})}function T0(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(i.text);){let a=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function M0(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function sC(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function lC(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Pe(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new D(T.from(s),0,0),1,!0))}function bn(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>o;u--,c--){let f=i.node(u),d=i.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(d,f.childCount),h=r&&r[c+1];h&&(p=p.replaceChild(0,h.type.create(h.attrs)));let g=r&&r[c]||f;if(!f.canReplace(d+1,f.childCount)||!g.type.validContent(p))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function aC(t,e,n=1,r){let i=t.doc.resolve(e),o=T.empty,s=T.empty;for(let l=i.depth,a=i.depth-n,u=n-1;l>a;l--,u--){o=T.from(i.node(l).copy(o));let c=r&&r[u];s=T.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}t.step(new Ie(e,e,new D(o.append(s),n,n),!0))}function sr(t,e){let n=t.resolve(e),r=n.index();return N0(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function uC(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function N0(t,e){return!!(t&&e&&!t.isLeaf&&uC(t,e))}function va(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,l=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),l++,s=r.node(i).maybeChild(l)):(o=r.node(i).maybeChild(l-1),s=r.node(i+1)),o&&!o.isTextblock&&N0(o,s)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function cC(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);c&&!f?r=!1:!c&&f&&(r=!0)}let l=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);M0(t,c.node(),c.before(),l)}s.inlineContent&&kd(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let a=t.mapping.slice(l),u=a.map(e-n);if(t.step(new Ie(u,a.map(e+n,-1),D.empty,!0)),r===!0){let c=t.doc.resolve(u);T0(t,c.node(),c.before(),t.steps.length)}return t}function fC(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function O0(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}function ka(t,e,n=e,r=D.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return A0(i,o,r)?new Ie(e,n,r):new dC(i,o,r).fit()}function A0(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class dC{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=T.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=T.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new D(o,s,l);return e>-1?new Pe(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new Ie(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=xd(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(n==1&&(s?u.matchType(s.type)||(f=u.fillBefore(T.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(n==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=xd(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new D(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=xd(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new D(ls(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new D(ls(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)c.push(i.child(g));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let g=l.child(u),y=f.matchType(g.type);if(!y)break;u++,(u>1||a==0||g.content.size)&&(f=y,c.push(R0(g.mark(d.allowedMarks(g.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=as(this.placed,n,T.from(c)),this.frontier[n].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,y=l;g<p;g++){let m=y.lastChild;this.frontier.push({type:m.type,match:m.contentMatchAt(m.childCount)}),y=m.content}this.unplaced=h?e==0?D.empty:new D(ls(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new D(ls(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Sd(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=Sd(e,n,i,r,o);if(s){for(let l=n-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Sd(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=as(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=as(this.placed,this.depth,T.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(T.empty,!0);n.childCount&&(this.placed=as(this.placed,this.frontier.length,n))}}function ls(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(ls(t.firstChild.content,e-1,n)))}function as(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(as(t.lastChild.content,e-1,n)))}function xd(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function R0(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,R0(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(T.empty,!0)))),t.copy(r)}function Sd(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!pC(n,o.content,s)?l:null}function pC(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function hC(t){return t.spec.defining||t.spec.definingForContent}function mC(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(A0(i,o,r))return t.step(new Ie(e,n,r));let s=I0(i,o);s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,p=i.pos-1;d>0;d--,p--){let h=i.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==p&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(u.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=u[d],h=hC(p.type);if(h&&!p.sameMarkup(i.node(Math.abs(l)-1)))c=d;else if(h||!p.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=u[p];if(h)for(let g=0;g<s.length;g++){let y=s[(g+a)%s.length],m=!0;y<0&&(m=!1,y=-y);let v=i.node(y-1),w=i.index(y-1);if(v.canReplaceWith(w,w,h.type,h.marks))return t.replace(i.before(y),m?o.after(y):n,new D(D0(r.content,0,r.openStart,p),p,r.openEnd))}}let f=t.steps.length;for(let d=s.length-1;d>=0&&(t.replace(e,n,r),!(t.steps.length>f));d--){let p=s[d];p<0||(e=i.before(p),n=o.after(p))}}function D0(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(D0(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(T.empty,!0))}return t}function gC(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=fC(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new D(T.from(r),0,0))}function yC(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=I0(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function I0(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class ji extends Qe{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return be.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return be.fromReplace(e,this.pos,this.pos+1,new D(T.from(i),0,n.isLeaf?0:1))}getMap(){return Ct.empty}invert(e){return new ji(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ji(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ji(n.pos,n.attr,n.value)}}Qe.jsonID("attr",ji);class us extends Qe{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return be.ok(r)}getMap(){return Ct.empty}invert(e){return new us(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new us(n.attr,n.value)}}Qe.jsonID("docAttr",us);let Fi=class extends Error{};Fi=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n},Fi.prototype=Object.create(Error.prototype),Fi.prototype.constructor=Fi,Fi.prototype.name="TransformError";class P0{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ss}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Fi(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=D.empty){let i=ka(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new D(T.from(r),0,0))}delete(e,n){return this.replace(e,n,D.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return mC(this,e,n,r),this}replaceRangeWith(e,n,r){return gC(this,e,n,r),this}deleteRange(e,n){return yC(this,e,n),this}lift(e,n){return tC(this,e,n),this}join(e,n=1){return cC(this,e,n),this}wrap(e,n){return iC(this,e,n),this}setBlockType(e,n=e,r,i=null){return oC(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return lC(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new ji(e,n,r)),this}setDocAttribute(e,n){return this.step(new us(e,n)),this}addNodeMark(e,n){return this.step(new or(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof se)n.isInSet(r.marks)&&this.step(new Vr(e,n));else{let i=r.marks,o,s=[];for(;o=n.isInSet(i);)s.push(new Vr(e,o)),i=o.removeFromSet(i);for(let l=s.length-1;l>=0;l--)this.step(s[l])}return this}split(e,n=1,r){return aC(this,e,n,r),this}addMark(e,n,r){return XE(this,e,n,r),this}removeMark(e,n,r){return ZE(this,e,n,r),this}clearIncompatible(e,n,r){return kd(this,e,n,r),this}}const Ed=Object.create(null);class K{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new vC(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=D.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:u}=s[l],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(u.pos),l?D.empty:n),l==0&&B0(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),u=a.map(s.pos),c=a.map(l.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),B0(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new V(e):Hi(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?Hi(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):Hi(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new bt(e.node(0))}static atStart(e){return Hi(e,e,0,0,1)||new bt(e)}static atEnd(e){return Hi(e,e,e.content.size,e.childCount,-1)||new bt(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Ed[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Ed)throw new RangeError("Duplicate use of selection JSON ID "+e);return Ed[e]=n,n.prototype.jsonID=e,n}getBookmark(){return V.between(this.$anchor,this.$head).getBookmark()}}K.prototype.visible=!0;class vC{constructor(e,n){this.$from=e,this.$to=n}}let L0=!1;function z0(t){!L0&&!t.parent.inlineContent&&(L0=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class V extends K{constructor(e,n=e){z0(e),z0(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return K.near(r);let i=e.resolve(n.map(this.anchor));return new V(i.parent.inlineContent?i:r,r)}replace(e,n=D.empty){if(super.replace(e,n),n==D.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof V&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new wa(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new V(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=K.findFrom(n,r,!0)||K.findFrom(n,-r,!0);if(o)n=o.$head;else return K.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(K.findFrom(e,-r,!0)||K.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new V(e,n)}}K.jsonID("text",V);class wa{constructor(e,n){this.anchor=e,this.head=n}map(e){return new wa(e.map(this.anchor),e.map(this.head))}resolve(e){return V.between(e.resolve(this.anchor),e.resolve(this.head))}}class j extends K{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?K.near(o):new j(o)}content(){return new D(T.from(this.node),0,0)}eq(e){return e instanceof j&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Cd(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new j(e.resolve(n.anchor))}static create(e,n){return new j(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}j.prototype.visible=!1,K.jsonID("node",j);class Cd{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new wa(r,r):new Cd(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&j.isSelectable(r)?new j(n):K.near(n)}}class bt extends K{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=D.empty){if(n==D.empty){e.delete(0,e.doc.content.size);let r=K.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new bt(e)}map(e){return new bt(e)}eq(e){return e instanceof bt}getBookmark(){return kC}}K.jsonID("all",bt);const kC={map(){return this},resolve(t){return new bt(t)}};function Hi(t,e,n,r,i,o=!1){if(e.inlineContent)return V.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&j.isSelectable(l))return j.create(t,n-(i<0?l.nodeSize:0))}else{let a=Hi(t,l,n+i,i<0?l.childCount:0,i,o);if(a)return a}n+=l.nodeSize*i}return null}function B0(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Ie||i instanceof Pe))return;let o=t.mapping.maps[r],s;o.forEach((l,a,u,c)=>{s==null&&(s=c)}),t.setSelection(K.near(t.doc.resolve(s),n))}const _0=1,xa=2,$0=4;class wC extends P0{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|_0)&~xa,this.storedMarks=null,this}get selectionSet(){return(this.updated&_0)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=xa,this}ensureMarks(e){return se.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&xa)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~xa,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||se.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(K.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=$0,this}get scrolledIntoView(){return(this.updated&$0)>0}}function j0(t,e){return!e||!t?t:t.bind(e)}class cs{constructor(e,n,r){this.name=e,this.init=j0(n.init,r),this.apply=j0(n.apply,r)}}const xC=[new cs("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new cs("selection",{init(t,e){return t.selection||K.atStart(e.doc)},apply(t){return t.selection}}),new cs("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new cs("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class bd{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=xC.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new cs(r.key,r.spec.state,r))})}}class Vi{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,u=i?i[s].state:this,c=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Vi(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new wC(this)}static create(e){let n=new bd(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Vi(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new bd(this.schema,e.plugins),r=n.fields,i=new Vi(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new bd(e.schema,e.plugins),o=new Vi(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Gt.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=K.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){o[s.name]=u.fromJSON.call(a,e,n[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function F0(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=F0(i,e,{})),n[r]=i}return n}class de{constructor(e){this.spec=e,this.props={},e.props&&F0(e.props,this,this.props),this.key=e.key?e.key.key:H0("plugin")}getState(e){return e[this.key]}}const Td=Object.create(null);function H0(t){return t in Td?t+"$"+ ++Td[t]:(Td[t]=0,t+"$")}class Te{constructor(e="key"){this.key=H0(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Md=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function V0(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const U0=(t,e,n)=>{let r=V0(t,n);if(!r)return!1;let i=Nd(r);if(!i){let s=r.blockRange(),l=s&&$i(s);return l==null?!1:(e&&e(t.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(Z0(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Ui(o,"end")||j.isSelectable(o)))for(let s=r.depth;;s--){let l=ka(t.doc,r.before(s),r.after(s),D.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=t.tr.step(l);a.setSelection(Ui(o,"end")?K.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):j.create(a.doc,i.pos-o.nodeSize)),e(a.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},SC=(t,e,n)=>{let r=V0(t,n);if(!r)return!1;let i=Nd(r);return i?W0(t,i,e):!1},EC=(t,e,n)=>{let r=q0(t,n);if(!r)return!1;let i=Od(r);return i?W0(t,i,e):!1};function W0(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,l=s,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let c=l.firstChild;if(!c)return!1;l=c}let u=ka(t.doc,o,a,D.empty);if(!u||u.from!=o||u instanceof Ie&&u.slice.size>=a-o)return!1;if(n){let c=t.tr.step(u);c.setSelection(V.create(c.doc,o)),n(c.scrollIntoView())}return!0}function Ui(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const K0=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=Nd(r)}let s=o&&o.nodeBefore;return!s||!j.isSelectable(s)?!1:(e&&e(t.tr.setSelection(j.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Nd(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function q0(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const J0=(t,e,n)=>{let r=q0(t,n);if(!r)return!1;let i=Od(r);if(!i)return!1;let o=i.nodeAfter;if(Z0(t,i,e,1))return!0;if(r.parent.content.size==0&&(Ui(o,"start")||j.isSelectable(o))){let s=ka(t.doc,r.before(),r.after(),D.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=t.tr.step(s);l.setSelection(Ui(o,"start")?K.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):j.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Q0=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=Od(r)}let s=o&&o.nodeAfter;return!s||!j.isSelectable(s)?!1:(e&&e(t.tr.setSelection(j.create(t.doc,o.pos)).scrollIntoView()),!0)};function Od(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const CC=(t,e)=>{let n=t.selection,r=n instanceof j,i;if(r){if(n.node.isTextblock||!sr(t.doc,n.from))return!1;i=n.from}else if(i=va(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(j.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},bC=(t,e)=>{let n=t.selection,r;if(n instanceof j){if(n.node.isTextblock||!sr(t.doc,n.to))return!1;r=n.to}else if(r=va(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},TC=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&$i(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},G0=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Ad(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const MC=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=Ad(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,s.createAndFill());a.setSelection(K.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Y0=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof bt||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Ad(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(s,o.createAndFill());l.setSelection(V.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},X0=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(bn(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&$i(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function NC(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof j&&e.selection.node.isBlock)return!r.parentOffset||!bn(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,l,a=!1,u=!1;for(let p=r.depth;;p--)if(r.node(p).isBlock){a=r.end(p)==r.pos+(r.depth-p),u=r.start(p)==r.pos-(r.depth-p),l=Ad(r.node(p-1).contentMatchAt(r.indexAfter(p-1))),o.unshift(a&&l?{type:l}:null),s=p;break}else{if(p==1)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof V||e.selection instanceof bt)&&c.deleteSelection();let f=c.mapping.map(r.pos),d=bn(c.doc,f,o.length,o);if(d||(o[0]=l?{type:l}:null,d=bn(c.doc,f,o.length,o)),!d)return!1;if(c.split(f,o.length,o),!a&&u&&r.node(s).type!=l){let p=c.mapping.map(r.before(s)),h=c.doc.resolve(p);l&&r.node(s-1).canReplaceWith(h.index(),h.index()+1,l)&&c.setNodeMarkup(c.mapping.map(r.before(s)),l)}return n&&n(c.scrollIntoView()),!0}}const OC=NC(),AC=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(j.create(t.doc,i))),!0)};function RC(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||sr(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Z0(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,l,a=i.type.spec.isolating||o.type.spec.isolating;if(!a&&RC(t,e,n))return!0;let u=!a&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(l=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&l.matchType(s[0]||o.type).validEnd){if(n){let p=e.pos+o.nodeSize,h=T.empty;for(let m=s.length-1;m>=0;m--)h=T.from(s[m].create(null,h));h=T.from(i.copy(h));let g=t.tr.step(new Pe(e.pos-1,p,e.pos,p,new D(h,1,0),s.length,!0)),y=g.doc.resolve(p+2*s.length);y.nodeAfter&&y.nodeAfter.type==i.type&&sr(g.doc,y.pos)&&g.join(y.pos),n(g.scrollIntoView())}return!0}let c=o.type.spec.isolating||r>0&&a?null:K.findFrom(e,1),f=c&&c.$from.blockRange(c.$to),d=f&&$i(f);if(d!=null&&d>=e.depth)return n&&n(t.tr.lift(f,d).scrollIntoView()),!0;if(u&&Ui(o,"start",!0)&&Ui(i,"end")){let p=i,h=[];for(;h.push(p),!p.isTextblock;)p=p.lastChild;let g=o,y=1;for(;!g.isTextblock;g=g.firstChild)y++;if(p.canReplace(p.childCount,p.childCount,g.content)){if(n){let m=T.empty;for(let w=h.length-1;w>=0;w--)m=T.from(h[w].copy(m));let v=t.tr.step(new Pe(e.pos-h.length,e.pos+o.nodeSize,e.pos+y,e.pos+o.nodeSize-y,new D(m,h.length,0),0,!0));n(v.scrollIntoView())}return!0}}return!1}function ev(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection(V.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const DC=ev(-1),IC=ev(1);function PC(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),l=s&&wd(s,t,e);return l?(r&&r(n.tr.wrap(s,l).scrollIntoView()),!0):!1}}function tv(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:l}}=n.selection.ranges[o];n.doc.nodesBetween(s,l,(a,u)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let c=n.doc.resolve(u),f=c.index();i=c.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[s];o.setBlockType(l,a,t,e)}r(o.scrollIntoView())}return!0}}function Rd(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Rd(Md,U0,K0),Rd(Md,J0,Q0),Rd(G0,Y0,X0,OC),typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function LC(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let l=r?n.tr:null;return zC(l,s,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function zC(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=s.resolve(e.start-2);o=new da(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new da(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=wd(o,n,r,e);return l?(t&&BC(t,e,l,i,n),!0):!1}function BC(t,e,n,r,i){let o=T.empty;for(let c=n.length-1;c>=0;c--)o=T.from(n[c].type.create(n[c].attrs,o));t.step(new Pe(e.start-(r?2:0),e.end,e.start,e.end,new D(o,0,0),n.length,!0));let s=0;for(let c=0;c<n.length;c++)n[c].type==i&&(s=c+1);let l=n.length-s,a=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,f=e.endIndex,d=!0;c<f;c++,d=!1)!d&&bn(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=u.child(c).nodeSize;return t}function _C(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?$C(e,n,t,o):jC(e,n,o):!0:!1}}function $C(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new Pe(o-1,s,o,s,new D(T.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new da(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const l=$i(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(o,-1)-1);return sr(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function jC(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,h=n.endIndex-1,g=n.startIndex;h>g;h--)p-=i.child(h).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,u=o.node(-1),c=o.index(-1);if(!u.canReplace(c+(l?0:1),c+1,s.content.append(a?T.empty:T.from(i))))return!1;let f=o.pos,d=f+s.nodeSize;return r.step(new Pe(f-(l?1:0),d+(a?1:0),f+1,d-1,new D((l?T.empty:T.from(i.copy(T.empty))).append(a?T.empty:T.from(i.copy(T.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function FC(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let l=o.parent,a=l.child(s-1);if(a.type!=t)return!1;if(n){let u=a.lastChild&&a.lastChild.type==l.type,c=T.from(u?t.create():null),f=new D(T.from(t.create(null,T.from(l.type.create(null,c)))),u?3:1,0),d=o.start,p=o.end;n(e.tr.step(new Pe(d-(u?3:1),p,d,p,f,1,!0)).scrollIntoView())}return!0}}const He=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Wi=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Dd=null;const Tn=function(t,e,n){let r=Dd||(Dd=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},HC=function(){Dd=null},Ur=function(t,e,n,r){return n&&(nv(t,e,n,r,-1)||nv(t,e,n,r,1))},VC=/^(img|br|input|textarea|hr)$/i;function nv(t,e,n,r,i){for(var o;;){if(t==n&&e==r)return!0;if(e==(i<0?0:It(t))){let s=t.parentNode;if(!s||s.nodeType!=1||fs(t)||VC.test(t.nodeName)||t.contentEditable=="false")return!1;e=He(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?It(t):0}else return!1}}function It(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function UC(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=It(t)}else if(t.parentNode&&!fs(t))e=He(t),t=t.parentNode;else return null}}function WC(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!fs(t))e=He(t)+1,t=t.parentNode;else return null}}function KC(t,e,n){for(let r=e==0,i=e==It(t);r||i;){if(t==n)return!0;let o=He(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==It(t)}}function fs(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Sa=function(t){return t.focusNode&&Ur(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Wr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function qC(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function JC(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(It(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(It(r.startContainer),r.startOffset)}}}const ln=typeof navigator<"u"?navigator:null,rv=typeof document<"u"?document:null,lr=ln&&ln.userAgent||"",Id=/Edge\/(\d+)/.exec(lr),iv=/MSIE \d/.exec(lr),Pd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(lr),pt=!!(iv||Pd||Id),ar=iv?document.documentMode:Pd?+Pd[1]:Id?+Id[1]:0,Pt=!pt&&/gecko\/(\d+)/i.test(lr);Pt&&+(/Firefox\/(\d+)/.exec(lr)||[0,0])[1];const Ld=!pt&&/Chrome\/(\d+)/.exec(lr),Le=!!Ld,ov=Ld?+Ld[1]:0,Ge=!pt&&!!ln&&/Apple Computer/.test(ln.vendor),Ki=Ge&&(/Mobile\/\w+/.test(lr)||!!ln&&ln.maxTouchPoints>2),Lt=Ki||(ln?/Mac/.test(ln.platform):!1),sv=ln?/Win/.test(ln.platform):!1,Mn=/Android \d/.test(lr),ds=!!rv&&"webkitFontSmoothing"in rv.documentElement.style,QC=ds?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function GC(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Nn(t,e){return typeof t=="number"?t:t[e]}function YC(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function lv(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=Wi(s);continue}let l=s,a=l==o.body,u=a?GC(o):YC(l),c=0,f=0;if(e.top<u.top+Nn(r,"top")?f=-(u.top-e.top+Nn(i,"top")):e.bottom>u.bottom-Nn(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+Nn(i,"top")-u.top:e.bottom-u.bottom+Nn(i,"bottom")),e.left<u.left+Nn(r,"left")?c=-(u.left-e.left+Nn(i,"left")):e.right>u.right-Nn(r,"right")&&(c=e.right-u.right+Nn(i,"right")),c||f)if(a)o.defaultView.scrollBy(c,f);else{let p=l.scrollLeft,h=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let g=l.scrollLeft-p,y=l.scrollTop-h;e={left:e.left-g,top:e.top-y,right:e.right-g,bottom:e.bottom-y}}let d=a?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(d))break;s=d=="absolute"?s.offsetParent:Wi(s)}}function XC(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=t.root.elementFromPoint(o,s);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:av(t.dom)}}function av(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Wi(r));return e}function ZC({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;uv(n,r==0?0:r-e)}function uv(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let qi=null;function eb(t){if(t.setActive)return t.setActive();if(qi)return t.focus(qi);let e=av(t);t.focus(qi==null?{get preventScroll(){return qi={preventScroll:!0},!0}}:void 0),qi||(qi=!1,uv(e,0))}function cv(t,e){let n,r=2e8,i,o=0,s=e.top,l=e.top,a,u;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Tn(c).getClientRects();else continue;for(let p=0;p<d.length;p++){let h=d[p];if(h.top<=s&&h.bottom>=l){s=Math.max(h.bottom,s),l=Math.min(h.top,l);let g=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(g<r){n=c,r=g,i=g&&n.nodeType==3?{left:h.right<e.left?h.right:h.left,top:e.top}:e,c.nodeType==1&&g&&(o=f+(e.left>=(h.left+h.right)/2?1:0));continue}}else h.top>e.top&&!a&&h.left<=e.left&&h.right>=e.left&&(a=c,u={left:Math.max(h.left,Math.min(h.right,e.left)),top:h.top});!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(o=f+1)}}return!n&&a&&(n=a,i=u,r=0),n&&n.nodeType==3?tb(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:cv(n,i)}function tb(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=ur(r,1);if(s.top!=s.bottom&&zd(e,s)){i={node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function zd(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function nb(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function rb(t,e,n){let{node:r,offset:i}=cv(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function ib(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let l=t.docView.nearestDesc(o,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!s&&a.left>r.left||a.top>r.top?i=l.posBefore:(!s&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),s=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;o=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function fv(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(zd(e,u))return fv(s,e,u)}}if((o=(o+1)%r)==i)break}return t}function ob(t,e){let n=t.dom.ownerDocument,r,i=0,o=JC(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!zd(e,u)||(s=fv(t.dom,e,u),!s))return null}if(Ge)for(let u=s;r&&u;u=Wi(u))u.draggable&&(r=void 0);if(s=nb(s,e),r){if(Pt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;ds&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=ib(t,r,i,e))}l==null&&(l=rb(t,s,e));let a=t.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function dv(t){return t.top<t.bottom||t.left<t.right}function ur(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(dv(r))return r}return Array.prototype.find.call(n,dv)||t.getBoundingClientRect()}const sb=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function pv(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=ds||Pt;if(r.nodeType==3)if(s&&(sb.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=ur(Tn(r,i,i),n);if(Pt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=ur(Tn(r,i-1,i-1),-1);if(u.top==a.top){let c=ur(Tn(r,i,i+1),-1);if(c.top!=a.top)return ps(c,c.left<u.left)}}return a}else{let a=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(a--,c=1):n<0?a--:u++,ps(ur(Tn(r,a,u),c),c<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==It(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Bd(a.getBoundingClientRect(),!1)}if(o==null&&i<It(r)){let a=r.childNodes[i];if(a.nodeType==1)return Bd(a.getBoundingClientRect(),!0)}return Bd(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==It(r))){let a=r.childNodes[i-1],u=a.nodeType==3?Tn(a,It(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return ps(ur(u,1),!1)}if(o==null&&i<It(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?Tn(a,0,s?0:1):a.nodeType==1?a:null:null;if(u)return ps(ur(u,-1),!0)}return ps(ur(r.nodeType==3?Tn(r):r,-n),n>=0)}function ps(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Bd(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function hv(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function lb(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return hv(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=pv(t,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Tn(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(n=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const ab=/[\u0590-\u08ac]/;function ub(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=t.domSelection();return l?!ab.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?o:s:hv(t,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),d=l.caretBidiLevel;l.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:h,focusOffset:g}=t.domSelectionRange(),y=h&&!p.contains(h.nodeType==1?h:h.parentNode)||a==h&&u==g;try{l.collapse(c,f),a&&(a!=c||u!=f)&&l.extend&&l.extend(a,u)}catch{}return d!=null&&(l.caretBidiLevel=d),y}):r.pos==r.start()||r.pos==r.end()}let mv=null,gv=null,yv=!1;function cb(t,e,n){return mv==e&&gv==n?yv:(mv=e,gv=n,yv=n=="up"||n=="down"?lb(t,e,n):ub(t,e,n))}const zt=0,vv=1,Kr=2,an=3;class hs{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=zt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>He(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let l=i.children[s];if(l.size){i=l;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof xv){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof kv&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?He(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?He(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],u=s+a.size;if(i==-1&&e<=u){let c=s+a.border;if(e>=c&&n<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,c);e=s;for(let f=l;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=He(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>n||l==this.children.length-1)){n=u;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=He(f.dom);break}n+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let p=0,h=0;p<this.children.length;p++){let g=this.children[p],y=h+g.size;if(o>h&&s<y)return g.setSelection(e-h-g.border,n-h-g.border,r,i);h=y}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),f=!1;if((Pt||Ge)&&e==n){let{node:p,offset:h}=l;if(p.nodeType==3){if(f=!!(h&&p.nodeValue[h-1]==`
`),f&&h==p.nodeValue.length)for(let g=p,y;g;g=g.parentNode){if(y=g.nextSibling){y.nodeName=="BR"&&(l=a={node:y.parentNode,offset:He(y)+1});break}let m=g.pmViewDesc;if(m&&m.node&&m.node.isBlock)break}}else{let g=p.childNodes[h-1];f=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(Pt&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||f&&Ge)&&Ur(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Ur(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((u.extend||e==n)&&!(f&&Pt)){u.collapse(l.node,l.offset);try{e!=n&&u.extend(a.node,a.offset),d=!0}catch{}}if(!d){if(e>n){let h=l;l=a,a=h}let p=document.createRange();p.setEnd(a.node,a.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let l=r+o.border,a=s-o.border;if(e>=l&&n<=a){this.dirty=e==r||n==s?Kr:vv,e==l&&n==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=an:o.markDirty(e-l,n-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Kr:an}r=s}this.dirty=Kr}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Kr:vv;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class kv extends hs{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==zt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class fb extends hs{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class qr extends hs{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Hr.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new qr(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&an||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=an&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=zt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=zt}}slice(e,n,r){let i=qr.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=$d(o,n,s,r)),e>0&&(o=$d(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class cr extends hs{constructor(e,n,r,i,o,s,l,a,u){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,o,s){let l=o.nodeViews[n.type.name],a,u=l&&l(n,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,f=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Hr.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!f&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Cv(c,r,n),u?a=new db(e,n,r,i,c,f||null,d,u,o,s+1):n.isText?new Ea(e,n,r,i,c,d,o):new cr(e,n,r,i,c,f||null,d,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>T.empty)}return e}matchesNode(e,n,r){return this.dirty==zt&&e.eq(this.node)&&Ca(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new hb(this,s&&s.node,e);yb(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?se.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,f,d)=>{a.syncToMarks(u.marks,r,e);let p;a.findNodeMatch(u,c,f,d)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(p=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(u,c,f,p,e)||a.updateNextNode(u,c,f,e,d,i)||a.addNode(u,c,f,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==Kr)&&(s&&this.protectLocalComposition(e,s),Sv(this.contentDOM,this.children,e),Ki&&vb(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof V)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,l=kb(this.node.content,s,r-n,i-n);return l<0?null:{node:o,pos:l,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new fb(this,o,n,i);e.input.compositionNodes.push(s),this.children=$d(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==an||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=zt}updateOuterDeco(e){if(Ca(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ev(this.dom,this.nodeDOM,_d(this.outerDeco,this.node,n),_d(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function wv(t,e,n,r,i){Cv(r,e,t);let o=new cr(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Ea extends cr{constructor(e,n,r,i,o,s,l){super(e,n,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==an||this.dirty!=zt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=zt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=zt,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new Ea(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=an)}get domAtom(){return!1}isText(e){return this.node.text==e}}class xv extends hs{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==zt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class db extends cr{constructor(e,n,r,i,o,s,l,a,u,c){super(e,n,r,i,o,s,l,u,c),this.spec=a}update(e,n,r,i){if(this.dirty==an)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Sv(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==t){for(;l!=r;)r=bv(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(s instanceof qr){let a=r?r.previousSibling:t.lastChild;Sv(s.contentDOM,s.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=bv(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const ms=function(t){t&&(this.nodeName=t)};ms.prototype=Object.create(null);const Jr=[new ms];function _d(t,e,n){if(t.length==0)return Jr;let r=n?Jr[0]:new ms,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new ms(s.nodeName));for(let l in s){let a=s[l];a!=null&&(n&&i.length==1&&i.push(r=new ms(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Ev(t,e,n,r){if(n==Jr&&r==Jr)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=n[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=Jr[0]),i=a}pb(i,l||Jr[0],s)}return i}function pb(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function Cv(t,e,n){return Ev(t,t,Jr,_d(e,n,t.nodeType!=1))}function Ca(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function bv(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class hb{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=mb(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=zt,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=qr.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==an&&s.dom==s.contentDOM&&(s.dirty=Kr),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof cr){let u=this.preMatch.matched.get(a);if(u!=null&&u!=o)return!1;let c=a.dom,f,d=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=an&&Ca(n,a.outerDeco));if(!d&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(a,e,n,r,i,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Kr,f.updateChildren(i,s+1),f.dirty=zt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Ca(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=cr.create(this.top,n,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,o){let s=cr.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new kv(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof qr;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Ea)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ge||Le)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new xv(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function mb(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let u=n.children[r-1];if(u instanceof qr)n=u,r=u.children.length;else{l=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function gb(t,e){return t.type.side-e.type.side}function yb(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,l=[],a=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==o;){let y=i[s++];y.widget&&(c?(f||(f=[c])).push(y):c=y)}if(c)if(f){f.sort(gb);for(let y=0;y<f.length;y++)n(f[y],u,!!a)}else n(c,u,!!a);let d,p;if(a)p=-1,d=a,a=null;else if(u<t.childCount)p=u,d=t.child(u++);else break;for(let y=0;y<l.length;y++)l[y].to<=o&&l.splice(y--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let h=o+d.nodeSize;if(d.isText){let y=h;s<i.length&&i[s].from<y&&(y=i[s].from);for(let m=0;m<l.length;m++)l[m].to<y&&(y=l[m].to);y<h&&(a=d.cut(y-o),d=d.cut(0,y-o),h=y,p=-1)}else for(;s<i.length&&i[s].to<h;)s++;let g=d.isInline&&!d.isLeaf?l.filter(y=>!y.inline):l.slice();r(d,g,e.forChild(o,d),p),o=h}}function vb(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function kb(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<t.childCount;){let u=t.child(i++);if(o+=u.nodeSize,!u.isText)break;a+=u.text}if(o>=n){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=n)return l+u;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function $d(t,e,n,r,i){let o=[];for(let s=0,l=0;s<t.length;s++){let a=t[s],u=l,c=l+=a.size;u>=n||c<=e?o.push(a):(u<e&&o.push(a.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>n&&o.push(a.slice(n-u,a.size,r)))}return o}function jd(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(Sa(n)){for(a=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&j.isSelectable(f)&&i.parent&&!(f.isInline&&KC(n.focusNode,n.focusOffset,i.dom))){let d=i.posBefore;u=new j(s==d?l:r.resolve(d))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=s,d=s;for(let p=0;p<n.rangeCount;p++){let h=n.getRangeAt(p);f=Math.min(f,t.docView.posFromDOM(h.startContainer,h.startOffset,1)),d=Math.max(d,t.docView.posFromDOM(h.endContainer,h.endOffset,-1))}if(f<0)return null;[a,s]=d==t.state.selection.anchor?[d,f]:[f,d],l=r.resolve(s)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let c=r.resolve(a);if(!u){let f=e=="pointer"||t.state.selection.head<l.pos&&!o?1:-1;u=Hd(t,c,l,f)}return u}function Tv(t){return t.editable?t.hasFocus():Iv(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function On(t,e=!1){let n=t.state.selection;if(Av(t,n),!!Tv(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Le){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ur(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)xb(t);else{let{anchor:r,head:i}=n,o,s;Mv&&!(n instanceof V)&&(n.$from.parent.inlineContent||(o=Nv(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=Nv(t,n.to))),t.docView.setSelection(r,i,t,e),Mv&&(o&&Ov(o),s&&Ov(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&wb(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Mv=Ge||Le&&ov<63;function Nv(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(Ge&&i&&i.contentEditable=="false")return Fd(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Fd(i);if(o)return Fd(o)}}function Fd(t){return t.contentEditable="true",Ge&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Ov(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function wb(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Tv(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function xb(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,He(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&pt&&ar<=11&&(n.disabled=!0,n.disabled=!1)}function Av(t,e){if(e instanceof j){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Rv(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Rv(t)}function Rv(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Hd(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||V.between(e,n,r)}function Dv(t){return t.editable&&!t.hasFocus()?!1:Iv(t)}function Iv(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Sb(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Ur(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Vd(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&K.findFrom(o,e)}function fr(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Pv(t,e,n){let r=t.state.selection;if(r instanceof V)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return fr(t,new V(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Vd(t.state,e);return i&&i instanceof j?fr(t,i):!1}else if(!(Lt&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM?j.isSelectable(o)?fr(t,new j(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):ds?fr(t,new V(t.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof j&&r.node.isInline)return fr(t,new V(e>0?r.$to:r.$from));{let i=Vd(t.state,e);return i?fr(t,i):!1}}}function ba(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function gs(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ji(t,e){return e<0?Eb(t):Cb(t)}function Eb(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(Pt&&n.nodeType==1&&r<ba(n)&&gs(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(gs(l,-1))i=n,o=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(Lv(n))break;{let l=n.previousSibling;for(;l&&gs(l,-1);)i=n.parentNode,o=He(l),l=l.previousSibling;if(l)n=l,r=ba(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?Ud(t,n,r):i&&Ud(t,i,o)}function Cb(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=ba(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(gs(l,1))o=n,s=++r;else break}else{if(Lv(n))break;{let l=n.nextSibling;for(;l&&gs(l,1);)o=l.parentNode,s=He(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=ba(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&Ud(t,o,s)}function Lv(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function bb(t,e){for(;t&&e==t.childNodes.length&&!fs(t);)e=He(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function Tb(t,e){for(;t&&!e&&!fs(t);)e=He(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Ud(t,e,n){if(e.nodeType!=3){let o,s;(s=bb(e,n))?(e=s,n=0):(o=Tb(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Sa(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&On(t)},50)}function zv(t,e){let n=t.state.doc.resolve(e);if(!(Le||sv)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Bv(t,e,n){let r=t.state.selection;if(r instanceof V&&!r.empty||n.indexOf("s")>-1||Lt&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Vd(t.state,e);if(s&&s instanceof j)return fr(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof bt?K.near(s,e):K.findFrom(s,e);return l?fr(t,l):!1}return!1}function _v(t,e){if(!(t.state.selection instanceof V))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function $v(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Mb(t){if(!Ge||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;$v(t,r,"true"),setTimeout(()=>$v(t,r,"false"),20)}return!1}function Nb(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Ob(t,e){let n=e.keyCode,r=Nb(e);if(n==8||Lt&&n==72&&r=="c")return _v(t,-1)||Ji(t,-1);if(n==46&&!e.shiftKey||Lt&&n==68&&r=="c")return _v(t,1)||Ji(t,1);if(n==13||n==27)return!0;if(n==37||Lt&&n==66&&r=="c"){let i=n==37?zv(t,t.state.selection.from)=="ltr"?-1:1:-1;return Pv(t,i,r)||Ji(t,i)}else if(n==39||Lt&&n==70&&r=="c"){let i=n==39?zv(t,t.state.selection.from)=="ltr"?1:-1:1;return Pv(t,i,r)||Ji(t,i)}else{if(n==38||Lt&&n==80&&r=="c")return Bv(t,-1,r)||Ji(t,-1);if(n==40||Lt&&n==78&&r=="c")return Mb(t)||Bv(t,1,r)||Ji(t,1);if(r==(Lt?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Wd(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=t.someProp("clipboardSerializer")||Hr.fromSchema(t.state.schema),l=qv(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=Wv[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let h=l.createElement(c[p]);for(;a.firstChild;)h.appendChild(a.firstChild);a.appendChild(h),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(n)}`);let d=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d,slice:e}}function jv(t,e,n,r,i){let o=i.parent.type.spec.code,s,l;if(!n&&!e)return null;let a=!!e&&(r||o||!n);if(a){if(t.someProp("transformPastedText",d=>{e=d(e,o||r,t)}),o)return l=new D(T.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",d=>{l=d(l,t,!0)}),l;let f=t.someProp("clipboardTextParser",d=>d(e,i,r,t));if(f)l=f;else{let d=i.marks(),{schema:p}=t.state,h=Hr.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let y=s.appendChild(document.createElement("p"));g&&y.appendChild(h.serializeNode(p.text(g,d)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),s=Ib(n),ds&&Pb(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||rr.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!Ab.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=Lb(Uv(l,+c[1],+c[2]),c[4]);else if(l=D.maxOpen(Rb(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;d<l.openEnd&&!p.type.spec.isolating;d++,p=p.lastChild);l=Uv(l,f,d)}return t.someProp("transformPasted",f=>{l=f(l,t,a)}),l}const Ab=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Rb(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&Hv(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=Vv(s[s.length-1],o.length));let c=Fv(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return T.from(s)}return t}function Fv(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,T.from(t));return t}function Hv(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=Hv(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(T.from(Fv(n,t,i+1))))}}function Vv(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,Vv(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(T.empty,!0);return t.copy(n.append(r))}function Kd(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,l=s.content;return t.childCount>1&&(o=0),i<r-1&&(l=Kd(l,e,n,r,i+1,o)),i>=n&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(T.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(l))}function Uv(t,e,n){return e<t.openStart&&(t=new D(Kd(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new D(Kd(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const Wv={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Kv=null;function qv(){return Kv||(Kv=document.implementation.createHTMLDocument("title"))}let qd=null;function Db(t){let e=window.trustedTypes;return e?(qd||(qd=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),qd.createHTML(t)):t}function Ib(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=qv().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&Wv[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=Db(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function Pb(t){let e=t.querySelectorAll(Le?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Lb(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=T.from(a.create(r[l+1],i)),o++,s++}return new D(i,o,s)}const ot={},st={},zb={touchstart:!0,touchmove:!0};class Bb{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function _b(t){for(let e in ot){let n=ot[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{jb(t,r)&&!Qd(t,r)&&(t.editable||!(r.type in st))&&n(t,r)},zb[e]?{passive:!0}:void 0)}Ge&&t.dom.addEventListener("input",()=>null),Jd(t)}function dr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function $b(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Jd(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Qd(t,r))})}function Qd(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function jb(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Fb(t,e){!Qd(t,e)&&ot[e.type]&&(t.editable||!(e.type in st))&&ot[e.type](t,e)}st.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Qv(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Mn&&Le&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Ki&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Wr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Ob(t,n)?n.preventDefault():dr(t,"key")},st.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)},st.keypress=(t,e)=>{let n=e;if(Qv(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Lt&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof V)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i,o))&&t.dispatch(o()),n.preventDefault()}};function Ta(t){return{left:t.clientX,top:t.clientY}}function Hb(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Gd(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,l=>s>o.depth?l(t,n,o.nodeAfter,o.before(s),i,!0):l(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function Qi(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Vb(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&j.isSelectable(r)?(Qi(t,new j(n)),!0):!1}function Ub(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof j&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(j.isSelectable(l)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(Qi(t,j.create(t.state.doc,i)),!0):!1}function Wb(t,e,n,r,i){return Gd(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?Ub(t,n):Vb(t,n))}function Kb(t,e,n,r){return Gd(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function qb(t,e,n,r){return Gd(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||Jb(t,n,r)}function Jb(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Qi(t,V.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)Qi(t,V.create(r,l+1,l+1+s.content.size));else if(j.isSelectable(s))Qi(t,j.create(r,l));else continue;return!0}}function Yd(t){return Ma(t)}const Jv=Lt?"metaKey":"ctrlKey";ot.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Yd(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&Hb(n,t.input.lastClick)&&!n[Jv]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o,button:n.button};let s=t.posAtCoords(Ta(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Qb(t,s,n,!!r)):(o=="doubleClick"?Kb:qb)(t,s.pos,s.inside,n)?n.preventDefault():dr(t,"pointer"))};class Qb{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Jv],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let c=e.state.doc.resolve(n.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.nodeDOM.nodeType==1?a.nodeDOM:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof j&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Pt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),dr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>On(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Ta(e))),this.updateAllowDefault(e),this.allowDefault||!n?dr(this.view,"pointer"):Wb(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ge&&this.mightDrag&&!this.mightDrag.node.isAtom||Le&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Qi(this.view,K.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):dr(this.view,"pointer")}move(e){this.updateAllowDefault(e),dr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ot.touchstart=t=>{t.input.lastTouch=Date.now(),Yd(t),dr(t,"pointer")},ot.touchmove=t=>{t.input.lastTouch=Date.now(),dr(t,"pointer")},ot.contextmenu=t=>Yd(t);function Qv(t,e){return t.composing?!0:Ge&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Gb=Mn?5e3:-1;st.compositionstart=st.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof V&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Le&&sv&&Yb(t)))t.markCursor=t.state.storedMarks||n.marks(),Ma(t,!0),t.markCursor=null;else if(Ma(t,!e.selection.empty),Pt&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=t.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}Gv(t,Gb)};function Yb(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}st.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Gv(t,20))};function Gv(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Ma(t),e))}function Yv(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=Zb());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Xb(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=UC(e.focusNode,e.focusOffset),r=WC(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function Zb(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Ma(t,e=!1){if(!(Mn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Yv(t),e||t.docView&&t.docView.dirty){let n=jd(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function eT(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const ys=pt&&ar<15||Ki&&QC<604;ot.copy=st.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=ys?null:n.clipboardData,s=r.content(),{dom:l,text:a}=Wd(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):eT(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function tT(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function nT(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?vs(t,r.value,null,i,e):vs(t,r.textContent,r.innerHTML,i,e)},50)}function vs(t,e,n,r,i){let o=jv(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,o||D.empty)))return!0;if(!o)return!1;let s=tT(o),l=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Xv(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}st.paste=(t,e)=>{let n=e;if(t.composing&&!Mn)return;let r=ys?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&vs(t,Xv(r),r.getData("text/html"),i,n)?n.preventDefault():nT(t,n)};class Zv{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const rT=Lt?"altKey":"ctrlKey";function e1(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[rT]}ot.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Ta(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof j?i.to-1:i.to))){if(r&&r.mightDrag)s=j.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=j.create(t.state.doc,f.posBefore))}}let l=(s||t.state.selection).content(),{dom:a,text:u,slice:c}=Wd(t,l);(!n.dataTransfer.files.length||!Le||ov>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(ys?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",ys||n.dataTransfer.setData("text/plain",u),t.dragging=new Zv(c,e1(t,n),s)},ot.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},st.dragover=st.dragenter=(t,e)=>e.preventDefault(),st.drop=(t,e)=>{try{iT(t,e,t.dragging)}finally{t.dragging=null}};function iT(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Ta(e));if(!r)return;let i=t.state.doc.resolve(r.pos),o=n&&n.slice;o?t.someProp("transformPasted",p=>{o=p(o,t,!1)}):o=jv(t,Xv(e.dataTransfer),ys?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(n&&e1(t,e));if(t.someProp("handleDrop",p=>p(t,e,o||D.empty,s))){e.preventDefault();return}if(!o)return;e.preventDefault();let l=o?O0(t.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(s){let{node:p}=n;p?p.replace(a):a.deleteSelection()}let u=a.mapping.map(l),c=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=a.doc;if(c?a.replaceRangeWith(u,u,o.content.firstChild):a.replaceRange(u,u,o),a.doc.eq(f))return;let d=a.doc.resolve(u);if(c&&j.isSelectable(o.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(o.content.firstChild))a.setSelection(new j(d));else{let p=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((h,g,y,m)=>p=m),a.setSelection(Hd(t,d,a.doc.resolve(p)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))}ot.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&On(t)},20))},ot.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},ot.beforeinput=(t,e)=>{if(Le&&Mn&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,Wr(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in st)ot[t]=st[t];function ks(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Na{constructor(e,n){this.toDOM=e,this.spec=n||Qr,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new Ye(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Na&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&ks(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class pr{constructor(e,n){this.attrs=e,this.spec=n||Qr}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Ye(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof pr&&ks(this.attrs,e.attrs)&&ks(this.spec,e.spec)}static is(e){return e.type instanceof pr}destroy(){}}class Xd{constructor(e,n){this.attrs=e,this.spec=n||Qr}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Ye(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof Xd&&ks(this.attrs,e.attrs)&&ks(this.spec,e.spec)}destroy(){}}class Ye{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Ye(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Ye(e,e,new Na(n,r))}static inline(e,n,r,i){return new Ye(e,n,new pr(r,i))}static node(e,n,r,i){return new Ye(e,n,new Xd(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof pr}get widget(){return this.type instanceof Na}}const Gi=[],Qr={};class pe{constructor(e,n){this.local=e.length?e:Gi,this.children=n.length?n:Gi}static create(e,n){return n.length?Oa(n,e,0,Qr):Xe}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=n&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,n-l,r,i+l,o)}}map(e,n,r){return this==Xe||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Qr)}mapInner(e,n,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?oT(this.children,s||[],e,n,r,i,o):s?new pe(s.sort(Gr),Gi):Xe}add(e,n){return n.length?this==Xe?pe.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=n1(n,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,Oa(c,l,u+1,Qr)),o+=3}});let s=t1(o?r1(n):n,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new pe(s.length?this.local.concat(s).sort(Gr):this.local,i||this.children)}remove(e){return e.length==0||this==Xe?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+n,a=r[o+1]+n;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=Xe?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new pe(i,r):Xe}forChild(e,n){if(this==Xe)return this;if(n.isLeaf)return pe.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof pr){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new pe(i.sort(Gr),Gi);return r?new hr([l,r]):l}return r||Xe}eq(e){if(this==e)return!0;if(!(e instanceof pe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Zd(this.localsInner(e))}localsInner(e){if(this==Xe)return Gi;if(e.inlineContent||!this.local.some(pr.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof pr||n.push(this.local[r]);return n}forEachSet(e){e(this)}}pe.empty=new pe([],[]),pe.removeOverlap=Zd;const Xe=pe.empty;class hr{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,Qr));return hr.from(r)}forChild(e,n){if(n.isLeaf)return pe.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=Xe&&(o instanceof hr?r=r.concat(o.members):r.push(o))}return hr.from(r)}eq(e){if(!(e instanceof hr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?Zd(r?n:n.sort(Gr)):Gi}static from(e){switch(e.length){case 0:return Xe;case 1:return e[0];default:return new hr(e.every(n=>n instanceof pe)?e:e.reduce((n,r)=>n.concat(r instanceof pe?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function oT(t,e,n,r,i,o,s){let l=t.slice();for(let u=0,c=o;u<n.maps.length;u++){let f=0;n.maps[u].forEach((d,p,h,g)=>{let y=g-h-(p-d);for(let m=0;m<l.length;m+=3){let v=l[m+1];if(v<0||d>v+c-f)continue;let w=l[m]+c-f;p>=w?l[m+1]=d<=w?-2:-1:d>=c&&y&&(l[m]+=y,l[m+1]+=y)}f+=y}),c=n.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=n.map(t[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=n.map(t[u+1]+o,-1),p=d-i,{index:h,offset:g}=r.content.findIndex(f),y=r.maybeChild(h);if(y&&g==f&&g+y.nodeSize==p){let m=l[u+2].mapInner(n,y,c+1,t[u]+o+1,s);m!=Xe?(l[u]=f,l[u+1]=p,l[u+2]=m):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=sT(l,t,e,n,i,o,s),c=Oa(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let p=c.children[f];for(;d<l.length&&l[d]<p;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new pe(e.sort(Gr),l)}function t1(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new Ye(i.from+e,i.to+e,i.type))}return n}function sT(t,e,n,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?n.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+o+1);return n}function n1(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function r1(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Oa(t,e,n,r){let i=[],o=!1;e.forEach((l,a)=>{let u=n1(t,l,a+n);if(u){o=!0;let c=Oa(u,l,n+a+1,r);c!=Xe&&i.push(a,a+l.nodeSize,c)}});let s=t1(o?r1(t):t,-n).sort(Gr);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new pe(s,i):Xe}function Gr(t,e){return t.from-e.from||t.to-e.to}function Zd(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),i1(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),i1(e,i,r.copy(o.from,r.to)));break}}}return e}function i1(t,e,n){for(;e<t.length&&Gr(n,t[e])>0;)e++;t.splice(e,0,n)}function ep(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Xe&&e.push(r)}),t.cursorWrapper&&e.push(pe.create(t.state.doc,[t.cursorWrapper.deco])),hr.from(e)}const lT={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},aT=pt&&ar<=11;class uT{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class cT{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new uT,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);pt&&ar<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),aT&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,lT)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Dv(this.view)){if(this.suppressingSelectionUpdates)return On(this.view);if(pt&&ar<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ur(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Wi(o))n.add(o);for(let o=e.anchorNode;o;o=Wi(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Dv(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let c=0;c<n.length;c++){let f=this.registerMutation(n[c],a);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(Pt&&a.length){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,d]=c;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of c){let p=d.parentNode;p&&p.nodeName=="LI"&&(!f||pT(e,f)!=p)&&d.remove()}}}else if((Le||Ge)&&a.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of a)if(c.nodeName=="BR"&&c.parentNode){let f=c.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Sa(r)&&(u=jd(e))&&u.eq(K.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,On(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),fT(e)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||On(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(pt&&ar<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:d}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==e.target?He(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?He(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let o1=new WeakMap,s1=!1;function fT(t){if(!o1.has(t)&&(o1.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Pt,s1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),s1=!0}}function l1(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Ur(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function dT(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return l1(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?l1(t,n):null}function pT(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function hT(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),u,c=a.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],Sa(a)||u.push({node:a.focusNode,offset:a.focusOffset})),Le&&t.input.lastKeyCode===8)for(let y=o;y>i;y--){let m=r.childNodes[y-1],v=m.pmViewDesc;if(m.nodeName=="BR"&&!v){o=y;break}if(!v||v.size)break}let f=t.state.doc,d=t.someProp("domParser")||rr.fromSchema(t.state.schema),p=f.resolve(s),h=null,g=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:mT,context:p});if(u&&u[0].pos!=null){let y=u[0].pos,m=u[1]&&u[1].pos;m==null&&(m=y),h={anchor:y+s,head:m+s}}return{doc:g,sel:h,from:s,to:l}}function mT(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Ge&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Ge&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const gT=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function yT(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let E=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,C=jd(t,E);if(C&&!t.state.selection.eq(C)){if(Le&&Mn&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",M=>M(t,Wr(13,"Enter"))))return;let A=t.state.tr.setSelection(C);E=="pointer"?A.setMeta("pointer",!0):E=="key"&&A.scrollIntoView(),o&&A.setMeta("composition",o),t.dispatch(A)}return}let s=t.state.doc.resolve(e),l=s.sharedDepth(n);e=s.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,u=hT(t,e,n),c=t.state.doc,f=c.slice(u.from,u.to),d,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(d=t.state.selection.to,p="end"):(d=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let h=wT(f.content,u.doc.content,u.from,d,p);if(h&&t.input.domChangeCount++,(Ki&&t.input.lastIOSEnter>Date.now()-225||Mn)&&i.some(E=>E.nodeType==1&&!gT.test(E.nodeName))&&(!h||h.endA>=h.endB)&&t.someProp("handleKeyDown",E=>E(t,Wr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!h)if(r&&a instanceof V&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))h={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let E=a1(t,t.state.doc,u.sel);if(E&&!E.eq(t.state.selection)){let C=t.state.tr.setSelection(E);o&&C.setMeta("composition",o),t.dispatch(C)}}return}t.state.selection.from<t.state.selection.to&&h.start==h.endB&&t.state.selection instanceof V&&(h.start>t.state.selection.from&&h.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?h.start=t.state.selection.from:h.endA<t.state.selection.to&&h.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(h.endB+=t.state.selection.to-h.endA,h.endA=t.state.selection.to)),pt&&ar<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>u.from&&u.doc.textBetween(h.start-u.from-1,h.start-u.from+1)=="  "&&(h.start--,h.endA--,h.endB--);let g=u.doc.resolveNoCache(h.start-u.from),y=u.doc.resolveNoCache(h.endB-u.from),m=c.resolve(h.start),v=g.sameParent(y)&&g.parent.inlineContent&&m.end()>=h.endA;if((Ki&&t.input.lastIOSEnter>Date.now()-225&&(!v||i.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!v&&g.pos<u.doc.content.size&&(!g.sameParent(y)||!g.parent.inlineContent)&&g.pos<y.pos&&!/\S/.test(u.doc.textBetween(g.pos,y.pos,"","")))&&t.someProp("handleKeyDown",E=>E(t,Wr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>h.start&&kT(c,h.start,h.endA,g,y)&&t.someProp("handleKeyDown",E=>E(t,Wr(8,"Backspace")))){Mn&&Le&&t.domObserver.suppressSelectionUpdates();return}Le&&h.endB==h.start&&(t.input.lastChromeDelete=Date.now()),Mn&&!v&&g.start()!=y.start()&&y.parentOffset==0&&g.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==h.endA&&(h.endB-=2,y=u.doc.resolveNoCache(h.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(E){return E(t,Wr(13,"Enter"))})},20));let w=h.start,k=h.endA,S=E=>{let C=E||t.state.tr.replace(w,k,u.doc.slice(h.start-u.from,h.endB-u.from));if(u.sel){let A=a1(t,C.doc,u.sel);A&&!(Le&&t.composing&&A.empty&&(h.start!=h.endB||t.input.lastChromeDelete<Date.now()-100)&&(A.head==w||A.head==C.mapping.map(k)-1)||pt&&A.empty&&A.head==w)&&C.setSelection(A)}return o&&C.setMeta("composition",o),C.scrollIntoView()},x;if(v)if(g.pos==y.pos){pt&&ar<=11&&g.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>On(t),20));let E=S(t.state.tr.delete(w,k)),C=c.resolve(h.start).marksAcross(c.resolve(h.endA));C&&E.ensureMarks(C),t.dispatch(E)}else if(h.endA==h.endB&&(x=vT(g.parent.content.cut(g.parentOffset,y.parentOffset),m.parent.content.cut(m.parentOffset,h.endA-m.start())))){let E=S(t.state.tr);x.type=="add"?E.addMark(w,k,x.mark):E.removeMark(w,k,x.mark),t.dispatch(E)}else if(g.parent.child(g.index()).isText&&g.index()==y.index()-(y.textOffset?0:1)){let E=g.parent.textBetween(g.parentOffset,y.parentOffset),C=()=>S(t.state.tr.insertText(E,w,k));t.someProp("handleTextInput",A=>A(t,w,k,E,C))||t.dispatch(C())}else t.dispatch(S());else t.dispatch(S())}function a1(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Hd(t,e.resolve(n.anchor),e.resolve(n.head))}function vT(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)o=n[c].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(T.from(u).eq(t))return{mark:l,type:s}}function kT(t,e,n,r,i){if(n-e<=i.pos-r.pos||tp(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let l=o.nodeAfter;return l!=null&&n==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(tp(o,!0,!0));return!s.parent.isTextblock||s.pos>n||tp(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function tp(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function wT(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&t.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&u1(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<t.size&&u1(t.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function u1(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class c1{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Bb,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(m1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=p1(this),d1(this),this.nodeViews=h1(this),this.docView=wv(this.state.doc,f1(this),ep(this),this.dom,this),this.domObserver=new cT(this,(r,i,o,s)=>yT(this,r,i,o,s)),this.domObserver.start(),_b(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Jd(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(m1),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Yv(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=h1(this);ST(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Jd(this),this.editable=p1(this),d1(this);let a=ep(this),u=f1(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,u,a);(f||!e.selection.eq(i.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&XC(this);if(s){this.domObserver.stop();let p=f&&(pt||Le)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&xT(i.selection,e.selection);if(f){let h=Le?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Xb(this)),(o||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=wv(e.doc,u,a,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Sb(this))?On(this,p):(Av(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&ZC(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof j){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&lv(this,n.getBoundingClientRect(),e)}else lv(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Zv(e.slice,e.move,i<0?void 0:j.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=n?n(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(pt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&eb(this.dom),On(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return ob(this,e)}coordsAtPos(e,n=1){return pv(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return cb(this,n||this.state,e)}pasteHTML(e,n){return vs(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return vs(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Wd(this,e)}destroy(){this.docView&&($b(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ep(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,HC())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Fb(this,e)}domSelectionRange(){let e=this.domSelection();return e?Ge&&this.root.nodeType===11&&qC(this.dom.ownerDocument)==this.dom&&dT(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}c1.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function f1(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Ye.node(0,t.state.doc.content.size,e)]}function d1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Ye.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function p1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function xT(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function h1(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function ST(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function m1(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var mr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Aa={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ET=typeof navigator<"u"&&/Mac/.test(navigator.platform),CT=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ve=0;Ve<10;Ve++)mr[48+Ve]=mr[96+Ve]=String(Ve);for(var Ve=1;Ve<=24;Ve++)mr[Ve+111]="F"+Ve;for(var Ve=65;Ve<=90;Ve++)mr[Ve]=String.fromCharCode(Ve+32),Aa[Ve]=String.fromCharCode(Ve);for(var np in mr)Aa.hasOwnProperty(np)||(Aa[np]=mr[np]);function bT(t){var e=ET&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||CT&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Aa:mr)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const TT=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),MT=typeof navigator<"u"&&/Win/.test(navigator.platform);function NT(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))TT?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function OT(t){let e=Object.create(null);for(let n in t)e[NT(n)]=t[n];return e}function rp(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function AT(t){return new de({props:{handleKeyDown:g1(t)}})}function g1(t){let e=OT(t);return function(n,r){let i=bT(r),o,s=e[rp(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[rp(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(MT&&r.ctrlKey&&r.altKey)&&(o=mr[r.keyCode])&&o!=i){let l=e[rp(o,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}var RT=Object.defineProperty,ip=(t,e)=>{for(var n in e)RT(t,n,{get:e[n],enumerable:!0})};function Ra(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}var Da=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,l])=>[s,(...u)=>{const c=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s=[],l=!!t,a=t||i.tr,u=()=>(!l&&e&&!a.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(a),s.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(n).map(([f,d])=>[f,(...h)=>{const g=this.buildProps(a,e),y=d(...h)(g);return s.push(y),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:n}=this,r=!1,i=t||n.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...u)=>a(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s={tr:t,editor:r,view:o,state:Ra({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([l,a])=>[l,(...u)=>a(...u)(s)]))}};return s}},y1={};ip(y1,{blur:()=>DT,clearContent:()=>IT,clearNodes:()=>PT,command:()=>LT,createParagraphNear:()=>zT,cut:()=>BT,deleteCurrentNode:()=>_T,deleteNode:()=>$T,deleteRange:()=>jT,deleteSelection:()=>FT,enter:()=>HT,exitCode:()=>VT,extendMarkRange:()=>UT,first:()=>WT,focus:()=>qT,forEach:()=>JT,insertContent:()=>QT,insertContentAt:()=>XT,joinBackward:()=>tM,joinDown:()=>eM,joinForward:()=>nM,joinItemBackward:()=>rM,joinItemForward:()=>iM,joinTextblockBackward:()=>oM,joinTextblockForward:()=>sM,joinUp:()=>ZT,keyboardShortcut:()=>aM,lift:()=>uM,liftEmptyBlock:()=>cM,liftListItem:()=>fM,newlineInCode:()=>dM,resetAttributes:()=>pM,scrollIntoView:()=>hM,selectAll:()=>mM,selectNodeBackward:()=>gM,selectNodeForward:()=>yM,selectParentNode:()=>vM,selectTextblockEnd:()=>kM,selectTextblockStart:()=>wM,setContent:()=>xM,setMark:()=>FM,setMeta:()=>HM,setNode:()=>VM,setNodeSelection:()=>UM,setTextDirection:()=>WM,setTextSelection:()=>KM,sinkListItem:()=>qM,splitBlock:()=>JM,splitListItem:()=>QM,toggleList:()=>GM,toggleMark:()=>YM,toggleNode:()=>XM,toggleWrap:()=>ZM,undoInputRule:()=>eN,unsetAllMarks:()=>tN,unsetMark:()=>nN,unsetTextDirection:()=>rN,updateAttributes:()=>iN,wrapIn:()=>oN,wrapInList:()=>sN});var DT=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),IT=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),PT=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(l,a)=>{if(l.type.isText)return;const{doc:u,mapping:c}=e,f=u.resolve(c.map(a)),d=u.resolve(c.map(a+l.nodeSize)),p=f.blockRange(d);if(!p)return;const h=$i(p);if(l.type.isTextblock){const{defaultType:g}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(p.start,g)}(h||h===0)&&e.lift(p,h)})}),!0},LT=t=>e=>t(e),zT=()=>({state:t,dispatch:e})=>Y0(t,e),BT=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new V(r.doc.resolve(Math.max(s-1,0)))),!0},_T=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const l=i.before(o),a=i.after(o);t.delete(l,a).scrollIntoView()}return!0}return!1};function Me(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var $T=t=>({tr:e,state:n,dispatch:r})=>{const i=Me(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const a=o.before(s),u=o.after(s);e.delete(a,u).scrollIntoView()}return!0}return!1},jT=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},FT=()=>({state:t,dispatch:e})=>Md(t,e),HT=()=>({commands:t})=>t.keyboardShortcut("Enter"),VT=()=>({state:t,dispatch:e})=>MC(t,e);function op(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ia(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:op(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function v1(t,e,n={}){return t.find(r=>r.type===e&&Ia(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function k1(t,e,n={}){return!!v1(t,e,n)}function sp(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(n=n||((r=i.node.marks[0])==null?void 0:r.attrs),!v1([...i.node.marks],e,n)))return;let s=i.index,l=t.start()+i.offset,a=s+1,u=l+i.node.nodeSize;for(;s>0&&k1([...t.parent.child(s-1).marks],e,n);)s-=1,l-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&k1([...t.parent.child(a).marks],e,n);)u+=t.parent.child(a).nodeSize,a+=1;return{from:l,to:u}}function An(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var UT=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=An(t,r.schema),{doc:s,selection:l}=n,{$from:a,from:u,to:c}=l;if(i){const f=sp(a,o,e);if(f&&f.from<=u&&f.to>=c){const d=V.create(s,f.from,f.to);n.setSelection(d)}}return!0},WT=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function w1(t){return t instanceof V}function Yr(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function x1(t,e=null){if(!e)return null;const n=K.atStart(t),r=K.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?V.create(t,Yr(0,i,o),Yr(t.content.size,i,o)):V.create(t,Yr(e,i,o),Yr(e,i,o))}function KT(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function lp(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var qT=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(lp()||KT())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!w1(n.state.selection))return s(),!0;const l=x1(i.doc,t)||n.state.selection,a=n.state.selection.eq(l);return o&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},JT=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),QT=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),S1=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&S1(r)}return t};function Pa(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return S1(n)}function ws(t,e,n){if(t instanceof Gt||t instanceof T)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return T.fromArray(t.map(l=>e.nodeFromJSON(l)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),ws("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,l="";const a=new u0({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?rr.fromSchema(a).parseSlice(Pa(t),n.parseOptions):rr.fromSchema(a).parse(Pa(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const o=rr.fromSchema(e);return n.slice?o.parseSlice(Pa(t),n.parseOptions).content:o.parse(Pa(t),n.parseOptions)}return ws("",e,n)}function GT(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Ie||i instanceof Pe))return;const o=t.mapping.maps[r];let s=0;o.forEach((l,a,u,c)=>{s===0&&(s=c)}),t.setSelection(K.near(t.doc.resolve(s),n))}var YT=t=>!("type"in t),XT=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const a=y=>{o.emit("contentError",{editor:o,error:y,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{ws(e,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(y){a(y)}try{l=ws(e,o.schema,{parseOptions:u,errorOnInvalidContent:(s=n.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(y){return a(y),!1}let{from:c,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},d=!0,p=!0;if((YT(l)?l:[l]).forEach(y=>{y.check(),d=d?y.isText&&y.marks.length===0:!1,p=p?y.isBlock:!1}),c===f&&p){const{parent:y}=r.doc.resolve(c);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(c-=1,f+=1)}let g;if(d){if(Array.isArray(e))g=e.map(y=>y.text||"").join("");else if(e instanceof T){let y="";e.forEach(m=>{m.text&&(y+=m.text)}),g=y}else typeof e=="object"&&e&&e.text?g=e.text:g=e;r.insertText(g,c,f)}else{g=l;const y=r.doc.resolve(c),m=y.node(),v=y.parentOffset===0,w=m.isText||m.isTextblock,k=m.content.size>0;v&&w&&k&&(c=Math.max(0,c-1)),r.replaceWith(c,f,g)}n.updateSelection&&GT(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:g}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:g})}return!0},ZT=()=>({state:t,dispatch:e})=>CC(t,e),eM=()=>({state:t,dispatch:e})=>bC(t,e),tM=()=>({state:t,dispatch:e})=>U0(t,e),nM=()=>({state:t,dispatch:e})=>J0(t,e),rM=()=>({state:t,dispatch:e,tr:n})=>{try{const r=va(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},iM=()=>({state:t,dispatch:e,tr:n})=>{try{const r=va(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},oM=()=>({state:t,dispatch:e})=>SC(t,e),sM=()=>({state:t,dispatch:e})=>EC(t,e);function E1(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function lM(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))lp()||E1()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var aM=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=lM(t).split(/-(?!$)/),s=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,l))});return a==null||a.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function gr(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?Me(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(f,d)=>{if(f.isText)return;const p=Math.max(r,d),h=Math.min(i,d+f.nodeSize);l.push({node:f,from:p,to:h})});const a=i-r,u=l.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>Ia(f.node.attrs,n,{strict:!1}));return o?!!u.length:u.reduce((f,d)=>f+d.to-d.from,0)>=a}var uM=(t,e={})=>({state:n,dispatch:r})=>{const i=Me(t,n.schema);return gr(n,i,e)?TC(n,r):!1},cM=()=>({state:t,dispatch:e})=>X0(t,e),fM=t=>({state:e,dispatch:n})=>{const r=Me(t,e.schema);return _C(r)(e,n)},dM=()=>({state:t,dispatch:e})=>G0(t,e);function La(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function C1(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}var pM=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=La(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(o=Me(t,r.schema)),l==="mark"&&(s=An(t,r.schema));let a=!1;return n.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,f)=>{o&&o===c.type&&(a=!0,i&&n.setNodeMarkup(f,void 0,C1(c.attrs,e))),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&(a=!0,i&&n.addMark(f,f+c.nodeSize,s.create(C1(d.attrs,e))))})})}),a},hM=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),mM=()=>({tr:t,dispatch:e})=>{if(e){const n=new bt(t.doc);t.setSelection(n)}return!0},gM=()=>({state:t,dispatch:e})=>K0(t,e),yM=()=>({state:t,dispatch:e})=>Q0(t,e),vM=()=>({state:t,dispatch:e})=>AC(t,e),kM=()=>({state:t,dispatch:e})=>IC(t,e),wM=()=>({state:t,dispatch:e})=>DC(t,e);function ap(t,e,n={},r={}){return ws(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var xM=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:i,tr:o,dispatch:s,commands:l})=>{const{doc:a}=o;if(r.preserveWhitespace!=="full"){const u=ap(t,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&o.replaceWith(0,a.content.size,u).setMeta("preventUpdate",!n),!0}return s&&o.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:a.content.size},t,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function b1(t,e){const n=An(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,a=>{s.push(...a.marks)});const l=s.find(a=>a.type.name===n.name);return l?{...l.attrs}:{}}function T1(t,e){const n=new P0(t);return e.forEach(r=>{r.steps.forEach(i=>{n.step(i)})}),n}function SM(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function EM(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(i,o)=>{n(i)&&r.push({node:i,pos:o})}),r}function CM(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function za(t){return e=>CM(e.$from,t)}function B(t,e,n){return t.config[e]===void 0&&t.parent?B(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?B(t.parent,e,n):null}):t.config[e]}function up(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=B(e,"addExtensions",n);return r?[e,...up(r())]:e}).flat(10)}function cp(t,e){const n=Hr.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function M1(t){return typeof t=="function"}function ie(t,e=void 0,...n){return M1(t)?e?t.bind(e)(...n):t(...n):t}function bM(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Yi(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function N1(t){const e=[],{nodeExtensions:n,markExtensions:r}=Yi(t),i=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage,extensions:i},a=B(s,"addGlobalAttributes",l);if(!a)return;a().forEach(c=>{c.types.forEach(f=>{Object.entries(c.attributes).forEach(([d,p])=>{e.push({type:f,name:d,attribute:{...o,...p}})})})})}),i.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage},a=B(s,"addAttributes",l);if(!a)return;const u=a();Object.entries(u).forEach(([c,f])=>{const d={...o,...f};typeof(d==null?void 0:d.default)=="function"&&(d.default=d.default()),d!=null&&d.isRequired&&(d==null?void 0:d.default)===void 0&&delete d.default,e.push({type:s.name,name:c,attribute:d})})}),e}function Ee(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const l=o?String(o).split(" "):[],a=r[i]?r[i].split(" "):[],u=l.filter(c=>!a.includes(c));r[i]=[...a,...u].join(" ")}else if(i==="style"){const l=o?o.split(";").map(c=>c.trim()).filter(Boolean):[],a=r[i]?r[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;a.forEach(c=>{const[f,d]=c.split(":").map(p=>p.trim());u.set(f,d)}),l.forEach(c=>{const[f,d]=c.split(":").map(p=>p.trim());u.set(f,d)}),r[i]=Array.from(u.entries()).map(([c,f])=>`${c}: ${f}`).join("; ")}else r[i]=o}),r},{})}function Ba(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Ee(n,r),{})}function TM(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function O1(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const l=s.attribute.parseHTML?s.attribute.parseHTML(n):TM(n.getAttribute(s.name));return l==null?o:{...o,[s.name]:l}},{});return{...r,...i}}}}function A1(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&bM(n)?!1:n!=null))}function R1(t){var e,n;const r={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(r.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function MM(t,e){var n;const r=N1(t),{nodeExtensions:i,markExtensions:o}=Yi(t),s=(n=i.find(u=>B(u,"topNode")))==null?void 0:n.name,l=Object.fromEntries(i.map(u=>{const c=r.filter(m=>m.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},d=t.reduce((m,v)=>{const w=B(v,"extendNodeSchema",f);return{...m,...w?w(u):{}}},{}),p=A1({...d,content:ie(B(u,"content",f)),marks:ie(B(u,"marks",f)),group:ie(B(u,"group",f)),inline:ie(B(u,"inline",f)),atom:ie(B(u,"atom",f)),selectable:ie(B(u,"selectable",f)),draggable:ie(B(u,"draggable",f)),code:ie(B(u,"code",f)),whitespace:ie(B(u,"whitespace",f)),linebreakReplacement:ie(B(u,"linebreakReplacement",f)),defining:ie(B(u,"defining",f)),isolating:ie(B(u,"isolating",f)),attrs:Object.fromEntries(c.map(R1))}),h=ie(B(u,"parseHTML",f));h&&(p.parseDOM=h.map(m=>O1(m,c)));const g=B(u,"renderHTML",f);g&&(p.toDOM=m=>g({node:m,HTMLAttributes:Ba(m,c)}));const y=B(u,"renderText",f);return y&&(p.toText=y),[u.name,p]})),a=Object.fromEntries(o.map(u=>{const c=r.filter(y=>y.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},d=t.reduce((y,m)=>{const v=B(m,"extendMarkSchema",f);return{...y,...v?v(u):{}}},{}),p=A1({...d,inclusive:ie(B(u,"inclusive",f)),excludes:ie(B(u,"excludes",f)),group:ie(B(u,"group",f)),spanning:ie(B(u,"spanning",f)),code:ie(B(u,"code",f)),attrs:Object.fromEntries(c.map(R1))}),h=ie(B(u,"parseHTML",f));h&&(p.parseDOM=h.map(y=>O1(y,c)));const g=B(u,"renderHTML",f);return g&&(p.toDOM=y=>g({mark:y,HTMLAttributes:Ba(y,c)})),[u.name,p]}));return new u0({topNode:s,nodes:l,marks:a})}function NM(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function fp(t){return t.sort((n,r)=>{const i=B(n,"priority")||100,o=B(r,"priority")||100;return i>o?-1:i<o?1:0})}function D1(t){const e=fp(up(t)),n=NM(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function I1(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let l="";return t.nodesBetween(r,i,(a,u,c,f)=>{var d;a.isBlock&&u>r&&(l+=o);const p=s==null?void 0:s[a.type.name];if(p)return c&&(l+=p({node:a,pos:u,parent:c,index:f,range:e})),!1;a.isText&&(l+=(d=a==null?void 0:a.text)==null?void 0:d.slice(Math.max(r,u)-u,i-u))}),l}function OM(t,e){const n={from:0,to:t.content.size};return I1(t,n,e)}function P1(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function AM(t,e){const n=Me(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,l=>{o.push(l)});const s=o.reverse().find(l=>l.type.name===n.name);return s?{...s.attrs}:{}}function L1(t,e){const n=La(typeof e=="string"?e:e.name,t.schema);return n==="node"?AM(t,e):n==="mark"?b1(t,e):{}}function RM(t,e=JSON.stringify){const n={};return t.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function DM(t){const e=RM(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,s)=>s!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function z1(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((i,o)=>{const s=[];if(i.ranges.length)i.forEach((l,a)=>{s.push({from:l,to:a})});else{const{from:l,to:a}=n[o];if(l===void 0||a===void 0)return;s.push({from:l,to:a})}s.forEach(({from:l,to:a})=>{const u=e.slice(o).map(l,-1),c=e.slice(o).map(a),f=e.invert().map(u,-1),d=e.invert().map(c);r.push({oldRange:{from:f,to:d},newRange:{from:u,to:c}})})}),DM(r)}function dp(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=sp(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}var IM=(t,e,n,r=20)=>{const i=t.doc.resolve(n);let o=r,s=null;for(;o>0&&s===null;){const l=i.node(o);(l==null?void 0:l.type.name)===e?s=l:o-=1}return[s,o]};function pp(t,e){return e.nodes[t]||e.marks[t]||null}function _a(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}var PM=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,l)=>{var a,u;const c=((u=(a=i.type.spec).toText)==null?void 0:u.call(a,{node:i,pos:o,parent:s,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,r-o))}),n};function hp(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?An(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>Ia(f.attrs,n,{strict:!1}));let s=0;const l=[];if(i.forEach(({$from:f,$to:d})=>{const p=f.pos,h=d.pos;t.doc.nodesBetween(p,h,(g,y)=>{if(!g.isText&&!g.marks.length)return;const m=Math.max(p,y),v=Math.min(h,y+g.nodeSize),w=v-m;s+=w,l.push(...g.marks.map(k=>({mark:k,from:m,to:v})))})}),s===0)return!1;const a=l.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>Ia(f.mark.attrs,n,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),u=l.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,d)=>f+d.to-d.from,0);return(a>0?a+u:a)>=s}function LM(t,e,n={}){if(!e)return gr(t,null,n)||hp(t,null,n);const r=La(e,t.schema);return r==="node"?gr(t,e,n):r==="mark"?hp(t,e,n):!1}var zM=(t,e)=>{const{$from:n,$to:r,$anchor:i}=t.selection;if(e){const o=za(l=>l.type.name===e)(t.selection);if(!o)return!1;const s=t.doc.resolve(o.pos+1);return i.pos+1===s.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},BM=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function B1(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function _1(t,e){const{nodeExtensions:n}=Yi(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=ie(B(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function $a(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&($a(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function $1(t){return t instanceof j}var j1=class Fw{constructor(e){this.position=e}static fromJSON(e){return new Fw(e.position)}toJSON(){return{position:this.position}}};function _M(t,e){const n=e.mapping.mapResult(t.position);return{position:new j1(n.pos),mapResult:n}}function $M(t){return new j1(t)}function jM(t,e,n){var r;const{selection:i}=e;let o=null;if(w1(i)&&(o=i.$cursor),o){const l=(r=t.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(n)&&(!!n.isInSet(l)||!l.some(u=>u.type.excludes(n)))}const{ranges:s}=i;return s.some(({$from:l,$to:a})=>{let u=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,a.pos,(c,f,d)=>{if(u)return!1;if(c.isInline){const p=!d||d.type.allowsMarkType(n),h=!!n.isInSet(c.marks)||!c.marks.some(g=>g.type.excludes(n));u=p&&h}return!u}),u})}var FM=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:l}=o,a=An(t,r.schema);if(i)if(s){const u=b1(r,a);n.addStoredMark(a.create({...u,...e}))}else l.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;r.doc.nodesBetween(c,f,(d,p)=>{const h=Math.max(p,c),g=Math.min(p+d.nodeSize,f);d.marks.find(m=>m.type===a)?d.marks.forEach(m=>{a===m.type&&n.addMark(h,g,a.create({...m.attrs,...e}))}):n.addMark(h,g,a.create(e))})});return jM(r,n,a)},HM=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),VM=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=Me(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:l})=>tv(o,{...s,...e})(n)?!0:l.clearNodes()).command(({state:l})=>tv(o,{...s,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},UM=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=Yr(t,0,r.content.size),o=j.create(r,i);e.setSelection(o)}return!0},WM=(t,e)=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=r;let s,l;return typeof e=="number"?(s=e,l=e):e&&"from"in e&&"to"in e?(s=e.from,l=e.to):(s=o.from,l=o.to),i&&n.doc.nodesBetween(s,l,(a,u)=>{a.isText||n.setNodeMarkup(u,void 0,{...a.attrs,dir:t})}),!0},KM=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=V.atStart(r).from,l=V.atEnd(r).to,a=Yr(i,s,l),u=Yr(o,s,l),c=V.create(r,a,u);e.setSelection(c)}return!0},qM=t=>({state:e,dispatch:n})=>{const r=Me(t,e.schema);return FC(r)(e,n)};function F1(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}var JM=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:l,$to:a}=o,u=i.extensionManager.attributes,c=_a(u,l.node().type.name,l.node().attrs);if(o instanceof j&&o.node.isBlock)return!l.parentOffset||!bn(s,l.pos)?!1:(r&&(t&&F1(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=a.parentOffset===a.parent.content.size,d=l.depth===0?void 0:SM(l.node(-1).contentMatchAt(l.indexAfter(-1)));let p=f&&d?[{type:d,attrs:c}]:void 0,h=bn(e.doc,e.mapping.map(l.pos),1,p);if(!p&&!h&&bn(e.doc,e.mapping.map(l.pos),1,d?[{type:d}]:void 0)&&(h=!0,p=d?[{type:d,attrs:c}]:void 0),r){if(h&&(o instanceof V&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,p),d&&!f&&!l.parentOffset&&l.parent.type!==d)){const g=e.mapping.map(l.before()),y=e.doc.resolve(g);l.node(-1).canReplaceWith(y.index(),y.index()+1,d)&&e.setNodeMarkup(e.mapping.map(l.before()),d)}t&&F1(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return h},QM=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const l=Me(t,r.schema),{$from:a,$to:u}=r.selection,c=r.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(u))return!1;const f=a.node(-1);if(f.type!==l)return!1;const d=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let m=T.empty;const v=a.index(-1)?1:a.index(-2)?2:3;for(let C=a.depth-v;C>=a.depth-3;C-=1)m=T.from(a.node(C).copy(m));const w=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,k={..._a(d,a.node().type.name,a.node().attrs),...e},S=((s=l.contentMatch.defaultType)==null?void 0:s.createAndFill(k))||void 0;m=m.append(T.from(l.createAndFill(null,S)||void 0));const x=a.before(a.depth-(v-1));n.replace(x,a.after(-w),new D(m,4-v,0));let E=-1;n.doc.nodesBetween(x,n.doc.content.size,(C,A)=>{if(E>-1)return!1;C.isTextblock&&C.content.size===0&&(E=A+1)}),E>-1&&n.setSelection(V.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const p=u.pos===a.end()?f.contentMatchAt(0).defaultType:null,h={..._a(d,f.type.name,f.attrs),...e},g={..._a(d,a.node().type.name,a.node().attrs),...e};n.delete(a.pos,u.pos);const y=p?[{type:l,attrs:h},{type:p,attrs:g}]:[{type:l,attrs:h}];if(!bn(n.doc,a.pos,2))return!1;if(i){const{selection:m,storedMarks:v}=r,{splittableMarks:w}=o.extensionManager,k=v||m.$to.parentOffset&&m.$from.marks();if(n.split(a.pos,2,y).scrollIntoView(),!k||!i)return!0;const S=k.filter(x=>w.includes(x.type.name));n.ensureMarks(S)}return!0},mp=(t,e)=>{const n=za(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&sr(t.doc,n.pos)&&t.join(n.pos),!0},gp=(t,e)=>{const n=za(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&sr(t.doc,r)&&t.join(r),!0},GM=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:l,chain:a,commands:u,can:c})=>{const{extensions:f,splittableMarks:d}=i.extensionManager,p=Me(t,s.schema),h=Me(e,s.schema),{selection:g,storedMarks:y}=s,{$from:m,$to:v}=g,w=m.blockRange(v),k=y||g.$to.parentOffset&&g.$from.marks();if(!w)return!1;const S=za(x=>_1(x.type.name,f))(g);if(w.depth>=1&&S&&w.depth-S.depth<=1){if(S.node.type===p)return u.liftListItem(h);if(_1(S.node.type.name,f)&&p.validContent(S.node.content)&&l)return a().command(()=>(o.setNodeMarkup(S.pos,p),!0)).command(()=>mp(o,p)).command(()=>gp(o,p)).run()}return!n||!k||!l?a().command(()=>c().wrapInList(p,r)?!0:u.clearNodes()).wrapInList(p,r).command(()=>mp(o,p)).command(()=>gp(o,p)).run():a().command(()=>{const x=c().wrapInList(p,r),E=k.filter(C=>d.includes(C.type.name));return o.ensureMarks(E),x?!0:u.clearNodes()}).wrapInList(p,r).command(()=>mp(o,p)).command(()=>gp(o,p)).run()},YM=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=An(t,r.schema);return hp(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},XM=(t,e,n={})=>({state:r,commands:i})=>{const o=Me(t,r.schema),s=Me(e,r.schema),l=gr(r,o,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?i.setNode(s,a):i.setNode(o,{...a,...n})},ZM=(t,e={})=>({state:n,commands:r})=>{const i=Me(t,n.schema);return gr(n,i,e)?r.lift(i):r.wrapIn(i,e)},eN=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,l=o.transform;for(let a=l.steps.length-1;a>=0;a-=1)s.step(l.steps[a].invert(l.docs[a]));if(o.text){const a=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,a))}else s.delete(o.from,o.to)}return!0}}return!1},tN=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},nN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:l}=n,a=An(t,r.schema),{$from:u,empty:c,ranges:f}=l;if(!i)return!0;if(c&&s){let{from:d,to:p}=l;const h=(o=u.marks().find(y=>y.type===a))==null?void 0:o.attrs,g=sp(u,a,h);g&&(d=g.from,p=g.to),n.removeMark(d,p,a)}else f.forEach(d=>{n.removeMark(d.$from.pos,d.$to.pos,a)});return n.removeStoredMark(a),!0},rN=t=>({tr:e,state:n,dispatch:r})=>{const{selection:i}=n;let o,s;return typeof t=="number"?(o=t,s=t):t&&"from"in t&&"to"in t?(o=t.from,s=t.to):(o=i.from,s=i.to),r&&e.doc.nodesBetween(o,s,(l,a)=>{if(l.isText)return;const u={...l.attrs};delete u.dir,e.setNodeMarkup(a,void 0,u)}),!0},iN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const l=La(typeof t=="string"?t:t.name,r.schema);if(!l)return!1;l==="node"&&(o=Me(t,r.schema)),l==="mark"&&(s=An(t,r.schema));let a=!1;return n.selection.ranges.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;let d,p,h,g;n.selection.empty?r.doc.nodesBetween(c,f,(y,m)=>{o&&o===y.type&&(a=!0,h=Math.max(m,c),g=Math.min(m+y.nodeSize,f),d=m,p=y)}):r.doc.nodesBetween(c,f,(y,m)=>{m<c&&o&&o===y.type&&(a=!0,h=Math.max(m,c),g=Math.min(m+y.nodeSize,f),d=m,p=y),m>=c&&m<=f&&(o&&o===y.type&&(a=!0,i&&n.setNodeMarkup(m,void 0,{...y.attrs,...e})),s&&y.marks.length&&y.marks.forEach(v=>{if(s===v.type&&(a=!0,i)){const w=Math.max(m,c),k=Math.min(m+y.nodeSize,f);n.addMark(w,k,s.create({...v.attrs,...e}))}}))}),p&&(d!==void 0&&i&&n.setNodeMarkup(d,void 0,{...p.attrs,...e}),s&&p.marks.length&&p.marks.forEach(y=>{s===y.type&&i&&n.addMark(h,g,s.create({...y.attrs,...e}))}))}),a},oN=(t,e={})=>({state:n,dispatch:r})=>{const i=Me(t,n.schema);return PC(i,e)(n,r)},sN=(t,e={})=>({state:n,dispatch:r})=>{const i=Me(t,n.schema);return LC(i,e)(n,r)},lN=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},ja=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},aN=(t,e)=>{if(op(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Fa(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:l}=t,{view:a}=n;if(a.composing)return!1;const u=a.state.doc.resolve(r);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(d=>d.type.spec.code))return!1;let c=!1;const f=PM(u)+o;return s.forEach(d=>{if(c)return;const p=aN(f,d.find);if(!p)return;const h=a.state.tr,g=Ra({state:a.state,transaction:h}),y={from:r-(p[0].length-o.length),to:i},{commands:m,chain:v,can:w}=new Da({editor:n,state:g});d.handler({state:g,range:y,match:p,commands:m,chain:v,can:w})===null||!h.steps.length||(d.undoable&&h.setMeta(l,{transform:h,from:r,to:i,text:o}),a.dispatch(h),c=!0)}),c}function uN(t){const{editor:e,rules:n}=t,r=new de({state:{init(){return null},apply(i,o,s){const l=i.getMeta(r);if(l)return l;const a=i.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:c}=a;typeof c=="string"?c=c:c=cp(T.from(c),s.schema);const{from:f}=a,d=f+c.length;Fa({editor:e,from:f,to:d,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,l){return Fa({editor:e,from:o,to:s,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Fa({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Fa({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function cN(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ha(t){return cN(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function H1(t,e){const n={...t};return Ha(t)&&Ha(e)&&Object.keys(e).forEach(r=>{Ha(e[r])&&Ha(t[r])?n[r]=H1(t[r],e[r]):n[r]=e[r]}),n}var yp=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...ie(B(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...ie(B(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>H1(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Xr=class Hw extends yp{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new Hw(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const a=s.find(u=>(u==null?void 0:u.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function fN(t){return typeof t=="number"}var dN=class{constructor(t){this.find=t.find,this.handler=t.handler}},pN=(t,e,n)=>{if(op(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function hN(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:l}=t,{commands:a,chain:u,can:c}=new Da({editor:e,state:n}),f=[];return n.doc.nodesBetween(r,i,(p,h)=>{var g,y,m,v,w;if((y=(g=p.type)==null?void 0:g.spec)!=null&&y.code||!(p.isText||p.isTextblock||p.isInline))return;const k=(w=(v=(m=p.content)==null?void 0:m.size)!=null?v:p.nodeSize)!=null?w:0,S=Math.max(r,h),x=Math.min(i,h+k);if(S>=x)return;const E=p.isText?p.text||"":p.textBetween(S-h,x-h,void 0,"￼");pN(E,o.find,s).forEach(A=>{if(A.index===void 0)return;const M=S+A.index+1,_=M+A[0].length,F={from:n.tr.mapping.map(M),to:n.tr.mapping.map(_)},W=o.handler({state:n,range:F,match:A,commands:a,chain:u,can:c,pasteEvent:s,dropEvent:l});f.push(W)})}),f.every(p=>p!==null)}var Va=null,mN=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function gN(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:c,from:f,to:d,rule:p,pasteEvt:h})=>{const g=c.tr,y=Ra({state:c,transaction:g});if(!(!hN({editor:e,state:y,from:Math.max(f-1,0),to:d.b-1,rule:p,pasteEvent:h,dropEvent:l})||!g.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return n.map(c=>new de({view(f){const d=h=>{var g;r=(g=f.dom.parentElement)!=null&&g.contains(h.target)?f.dom.parentElement:null,r&&(Va=e)},p=()=>{Va&&(Va=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(f,d)=>{if(o=r===f.dom.parentElement,l=d,!o){const p=Va;p!=null&&p.isEditable&&setTimeout(()=>{const h=p.state.selection;h&&p.commands.deleteRange({from:h.from,to:h.to})},10)}return!1},paste:(f,d)=>{var p;const h=(p=d.clipboardData)==null?void 0:p.getData("text/html");return s=d,i=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(f,d,p)=>{const h=f[0],g=h.getMeta("uiEvent")==="paste"&&!i,y=h.getMeta("uiEvent")==="drop"&&!o,m=h.getMeta("applyPasteRules"),v=!!m;if(!g&&!y&&!v)return;if(v){let{text:S}=m;typeof S=="string"?S=S:S=cp(T.from(S),p.schema);const{from:x}=m,E=x+S.length,C=mN(S);return a({rule:c,state:p,from:x,to:{b:E},pasteEvt:C})}const w=d.doc.content.findDiffStart(p.doc.content),k=d.doc.content.findDiffEnd(p.doc.content);if(!(!fN(w)||!k||w===k.b))return a({rule:c,state:p,from:w,to:k,pasteEvt:s})}}))}var Ua=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=D1(t),this.schema=MM(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:pp(e.name,this.schema)},r=B(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return fp([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:pp(r.name,this.schema)},o=[],s=B(r,"addKeyboardShortcuts",i);let l={};if(r.type==="mark"&&B(r,"exitable",i)&&(l.ArrowRight=()=>Xr.handleExit({editor:t,mark:r})),s){const d=Object.fromEntries(Object.entries(s()).map(([p,h])=>[p,()=>h({editor:t})]));l={...l,...d}}const a=AT(l);o.push(a);const u=B(r,"addInputRules",i);if(B1(r,t.options.enableInputRules)&&u){const d=u();if(d&&d.length){const p=uN({editor:t,rules:d}),h=Array.isArray(p)?p:[p];o.push(...h)}}const c=B(r,"addPasteRules",i);if(B1(r,t.options.enablePasteRules)&&c){const d=c();if(d&&d.length){const p=gN({editor:t,rules:d});o.push(...p)}}const f=B(r,"addProseMirrorPlugins",i);if(f){const d=f();o.push(...d)}return o})}get attributes(){return N1(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Yi(this.extensions);return Object.fromEntries(e.filter(n=>!!B(n,"addNodeView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Me(n.name,this.schema)},o=B(n,"addNodeView",i);if(!o)return[];const s=o();if(!s)return[];const l=(a,u,c,f,d)=>{const p=Ba(a,r);return s({node:a,view:u,getPos:c,decorations:f,innerDecorations:d,editor:t,extension:n,HTMLAttributes:p})};return[n.name,l]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Yi(this.extensions);return Object.fromEntries(e.filter(n=>!!B(n,"addMarkView")).map(n=>{const r=this.attributes.filter(l=>l.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:An(n.name,this.schema)},o=B(n,"addMarkView",i);if(!o)return[];const s=(l,a,u)=>{const c=Ba(l,r);return o()({mark:l,view:a,inline:u,editor:t,extension:n,HTMLAttributes:c,updateAttributes:f=>{DN(l,t,f)}})};return[n.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:pp(e.name,this.schema)};e.type==="mark"&&((n=ie(B(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const i=B(e,"onBeforeCreate",r),o=B(e,"onCreate",r),s=B(e,"onUpdate",r),l=B(e,"onSelectionUpdate",r),a=B(e,"onTransaction",r),u=B(e,"onFocus",r),c=B(e,"onBlur",r),f=B(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),f&&this.editor.on("destroy",f)})}};Ua.resolve=D1,Ua.sort=fp,Ua.flatten=up;var yN={};ip(yN,{ClipboardTextSerializer:()=>V1,Commands:()=>U1,Delete:()=>W1,Drop:()=>K1,Editable:()=>q1,FocusEvents:()=>Q1,Keymap:()=>G1,Paste:()=>Y1,Tabindex:()=>X1,TextDirection:()=>Z1,focusEventsPluginKey:()=>J1});var ke=class Vw extends yp{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new Vw(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},V1=ke.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new de({key:new Te("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(c=>c.$from.pos)),l=Math.max(...o.map(c=>c.$to.pos)),a=P1(n);return I1(r,{from:s,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),U1=ke.create({name:"commands",addCommands(){return{...y1}}}),W1=ke.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,i;const o=()=>{var s,l,a,u;if((u=(a=(l=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:l.filterTransaction)==null?void 0:a.call(l,t))!=null?u:t.getMeta("y-sync$"))return;const c=T1(t.before,[t,...e]);z1(c).forEach(p=>{c.mapping.mapResult(p.oldRange.from).deletedAfter&&c.mapping.mapResult(p.oldRange.to).deletedBefore&&c.before.nodesBetween(p.oldRange.from,p.oldRange.to,(h,g)=>{const y=g+h.nodeSize-2,m=p.oldRange.from<=g&&y<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:h,from:g,to:y,newFrom:c.mapping.map(g),newTo:c.mapping.map(y),deletedRange:p.oldRange,newRange:p.newRange,partial:!m,editor:this.editor,transaction:t,combinedTransform:c})})});const d=c.mapping;c.steps.forEach((p,h)=>{var g,y;if(p instanceof Yt){const m=d.slice(h).map(p.from,-1),v=d.slice(h).map(p.to),w=d.invert().map(m,-1),k=d.invert().map(v),S=(g=c.doc.nodeAt(m-1))==null?void 0:g.marks.some(E=>E.eq(p.mark)),x=(y=c.doc.nodeAt(v))==null?void 0:y.marks.some(E=>E.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:w,to:k},newRange:{from:m,to:v},partial:!!(x||S),editor:this.editor,transaction:t,combinedTransform:c})}})};(i=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||i?setTimeout(o,0):o()}}),K1=ke.create({name:"drop",addProseMirrorPlugins(){return[new de({key:new Te("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),q1=ke.create({name:"editable",addProseMirrorPlugins(){return[new de({key:new Te("editable"),props:{editable:()=>this.editor.options.editable}})]}}),J1=new Te("focusEvents"),Q1=ke.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new de({key:J1,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),G1=ke.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:l})=>{const{selection:a,doc:u}=l,{empty:c,$anchor:f}=a,{pos:d,parent:p}=f,h=f.parent.isTextblock&&d>0?l.doc.resolve(d-1):f,g=h.parent.type.spec.isolating,y=f.pos-f.parentOffset,m=g&&h.parent.childCount===1?y===f.pos:K.atStart(u).from===d;return!c||!p.type.isTextblock||p.textContent.length||!m||m&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return lp()||E1()?o:i},addProseMirrorPlugins(){return[new de({key:new Te("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(g=>g.getMeta("composition")))return;const r=t.some(g=>g.docChanged)&&!e.doc.eq(n.doc),i=t.some(g=>g.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:l}=e.selection,a=K.atStart(e.doc).from,u=K.atEnd(e.doc).to;if(o||!(s===a&&l===u)||!$a(n.doc))return;const d=n.tr,p=Ra({state:n,transaction:d}),{commands:h}=new Da({editor:this.editor,state:p});if(h.clearNodes(),!!d.steps.length)return d}})]}}),Y1=ke.create({name:"paste",addProseMirrorPlugins(){return[new de({key:new Te("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),X1=ke.create({name:"tabindex",addProseMirrorPlugins(){return[new de({key:new Te("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Z1=ke.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Yi(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new de({key:new Te("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),vN=class co{constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new co(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new co(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new co(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(s);if(!i&&l.depth<=this.depth)return;const a=new co(l,this.editor,i,i?n:null);i&&(a.actualDepth=this.depth+1),e.push(new co(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let l=0;l<s.length;l+=1){const a=s[l];if(o[a]!==n[a])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(a=>n[a]===s.node.attrs[a])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},kN=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function wN(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var xN=class extends lN{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:_M,createMappablePosition:$M},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:o})=>this.options.onDrop(r,i,o)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=x1(e,this.options.autofocus);this.editorState=Vi.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=wN(kN,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=M1(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;n=n.filter(s=>!s.key.startsWith(o))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[q1,V1.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),U1,Q1,G1,X1,K1,Y1,W1,Z1.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Ua(r,this)}createCommandManager(){this.commandManager=new Da({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=ap(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=ap(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new c1(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),i=n.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=n.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=s==null?void 0:s.getMeta("focus"),a=s==null?void 0:s.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:s}),a&&this.emit("blur",{editor:this,event:a.event,transaction:s}),!(t.getMeta("preventUpdate")||!n.some(u=>u.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return L1(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return LM(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return cp(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return OM(this.state.doc,{blockSeparator:e,textSerializers:{...P1(this.schema),...n}})}get isEmpty(){return $a(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new vN(e,this)}get $doc(){return this.$pos(0)}};function Xi(t){return new ja({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ie(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],l=r[0];if(s){const a=l.search(/\S/),u=n.from+l.indexOf(s),c=u+s.length;if(dp(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===t.type&&g!==p.mark.type)).filter(p=>p.to>u).length)return null;c<n.to&&o.delete(c,n.to),u>n.from&&o.delete(n.from+a,u);const d=n.from+a+s.length;o.addMark(n.from+a,d,t.type.create(i||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function ek(t){return new ja({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ie(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let l=n.to;const a=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=s+u;c>l?c=l:l=c+r[1].length;const f=r[0][r[0].length-1];o.insertText(f,s+r[0].length-1),o.replaceWith(c,l,a)}else if(r[0]){const u=t.type.isInline?s:s-1;o.insert(u,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(l))}o.scrollIntoView()},undoable:t.undoable})}function vp(t){return new ja({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=ie(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)},undoable:t.undoable})}function Zi(t){return new ja({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=ie(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),u=a&&wd(a,t.type,o);if(!u)return null;if(s.wrap(a,u),t.keepMarks&&t.editor){const{selection:f,storedMarks:d}=e,{splittableMarks:p}=t.editor.extensionManager,h=d||f.$to.parentOffset&&f.$from.marks();if(h){const g=h.filter(y=>p.includes(y.type.name));s.ensureMarks(g)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,o).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&sr(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)},undoable:t.undoable})}var SN=t=>"touches"in t,EN=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=new Map,this.handleMouseMove=l=>{if(!this.isResizing||!this.activeHandle)return;const a=l.clientX-this.startX,u=l.clientY-this.startY;this.handleResize(a,u)},this.handleTouchMove=l=>{if(!this.isResizing||!this.activeHandle)return;const a=l.touches[0];if(!a)return;const u=a.clientX-this.startX,c=a.clientY-this.startY;this.handleResize(u,c)},this.handleMouseUp=()=>{if(!this.isResizing)return;const l=this.element.offsetWidth,a=this.element.offsetHeight;this.onCommit(l,a),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=l=>{l.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=l=>{l.key==="Shift"&&(this.isShiftKeyPressed=!1)};var e,n,r,i,o,s;this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(e=t.options)!=null&&e.min&&(this.minSize={...this.minSize,...t.options.min}),(n=t.options)!=null&&n.max&&(this.maxSize=t.options.max),(r=t==null?void 0:t.options)!=null&&r.directions&&(this.directions=t.options.directions),(i=t.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(o=t.options)!=null&&o.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(s=t.options)!=null&&s.createCustomHandle&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){return this.contentElement}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&this.handleMap.size===0&&this.attachHandles():this.removeHandles())}update(t,e,n){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,e,n):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const e=document.createElement("div");return e.dataset.resizeHandle=t,e.style.position="absolute",this.classNames.handle&&(e.className=this.classNames.handle),e}positionHandle(t,e){const n=e.includes("top"),r=e.includes("bottom"),i=e.includes("left"),o=e.includes("right");n&&(t.style.top="0"),r&&(t.style.bottom="0"),i&&(t.style.left="0"),o&&(t.style.right="0"),(e==="top"||e==="bottom")&&(t.style.left="0",t.style.right="0"),(e==="left"||e==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let e;this.createCustomHandle?e=this.createCustomHandle(t):e=this.createHandle(t),e instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),e=this.createHandle(t)),this.createCustomHandle||this.positionHandle(e,t),e.addEventListener("mousedown",n=>this.handleResizeStart(n,t)),e.addEventListener("touchstart",n=>this.handleResizeStart(n,t)),this.handleMap.set(t,e),this.wrapper.appendChild(e)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,e=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,e?(this.element.style.height=`${e}px`,this.initialHeight=e):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,e){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=e,SN(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,e){if(!this.activeHandle)return;const n=this.preserveAspectRatio||this.isShiftKeyPressed,{width:r,height:i}=this.calculateNewDimensions(this.activeHandle,t,e),o=this.applyConstraints(r,i,n);this.element.style.width=`${o.width}px`,this.element.style.height=`${o.height}px`,this.onResize&&this.onResize(o.width,o.height)}calculateNewDimensions(t,e,n){let r=this.startWidth,i=this.startHeight;const o=t.includes("right"),s=t.includes("left"),l=t.includes("bottom"),a=t.includes("top");return o?r=this.startWidth+e:s&&(r=this.startWidth-e),l?i=this.startHeight+n:a&&(i=this.startHeight-n),(t==="right"||t==="left")&&(r=this.startWidth+(o?e:-e)),(t==="top"||t==="bottom")&&(i=this.startHeight+(l?n:-n)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(r,i,t):{width:r,height:i}}applyConstraints(t,e,n){var r,i,o,s;if(!n){let u=Math.max(this.minSize.width,t),c=Math.max(this.minSize.height,e);return(r=this.maxSize)!=null&&r.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(c=Math.min(this.maxSize.height,c)),{width:u,height:c}}let l=t,a=e;return l<this.minSize.width&&(l=this.minSize.width,a=l/this.aspectRatio),a<this.minSize.height&&(a=this.minSize.height,l=a*this.aspectRatio),(o=this.maxSize)!=null&&o.width&&l>this.maxSize.width&&(l=this.maxSize.width,a=l/this.aspectRatio),(s=this.maxSize)!=null&&s.height&&a>this.maxSize.height&&(a=this.maxSize.height,l=a*this.aspectRatio),{width:l,height:a}}applyAspectRatio(t,e,n){const r=n==="left"||n==="right",i=n==="top"||n==="bottom";return r?{width:t,height:t/this.aspectRatio}:i?{width:e*this.aspectRatio,height:e}:{width:t,height:t/this.aspectRatio}}};function CN(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof j){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}function bN(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var TN={};ip(TN,{createAtomBlockMarkdownSpec:()=>MN,createBlockMarkdownSpec:()=>NN,createInlineMarkdownSpec:()=>RN,parseAttributes:()=>kp,parseIndentedBlocks:()=>xp,renderNestedMarkdownContent:()=>Sp,serializeAttributes:()=>wp});function kp(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,u=>(n.push(u),`__QUOTED_${n.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(s)).forEach(([,u,c])=>{var f;const d=parseInt(((f=c.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),p=n[d];p&&(e[u]=p.slice(1,-1))});const a=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return a&&a.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function wp(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function MN(t){const{nodeName:e,name:n,parseAttributes:r=kp,serializeAttributes:i=wp,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:l}=t,a=n||e,u=c=>{if(!l)return c;const f={};return l.forEach(d=>{d in c&&(f[d]=c[d])}),f};return{parseMarkdown:(c,f)=>{const d={...o,...c.attributes};return f.createNode(e,d,[])},markdownTokenizer:{name:e,level:"block",start(c){var f;const d=new RegExp(`^:::${a}(?:\\s|$)`,"m"),p=(f=c.match(d))==null?void 0:f.index;return p!==void 0?p:-1},tokenize(c,f,d){const p=new RegExp(`^:::${a}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),h=c.match(p);if(!h)return;const g=h[1]||"",y=r(g);if(!s.find(v=>!(v in y)))return{type:e,raw:h[0],attributes:y}}},renderMarkdown:c=>{const f=u(c.attrs||{}),d=i(f),p=d?` {${d}}`:"";return`:::${a}${p} :::`}}}function NN(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=kp,serializeAttributes:o=wp,defaultAttributes:s={},content:l="block",allowedAttributes:a}=t,u=n||e,c=f=>{if(!a)return f;const d={};return a.forEach(p=>{p in f&&(d[p]=f[p])}),d};return{parseMarkdown:(f,d)=>{let p;if(r){const g=r(f);p=typeof g=="string"?[{type:"text",text:g}]:g}else l==="block"?p=d.parseChildren(f.tokens||[]):p=d.parseInline(f.tokens||[]);const h={...s,...f.attributes};return d.createNode(e,h,p)},markdownTokenizer:{name:e,level:"block",start(f){var d;const p=new RegExp(`^:::${u}`,"m"),h=(d=f.match(p))==null?void 0:d.index;return h!==void 0?h:-1},tokenize(f,d,p){var h;const g=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),y=f.match(g);if(!y)return;const[m,v=""]=y,w=i(v);let k=1;const S=m.length;let x="";const E=/^:::([\w-]*)(\s.*)?/gm,C=f.slice(S);for(E.lastIndex=0;;){const A=E.exec(C);if(A===null)break;const M=A.index,_=A[1];if(!((h=A[2])!=null&&h.endsWith(":::"))){if(_)k+=1;else if(k-=1,k===0){const F=C.slice(0,M);x=F.trim();const W=f.slice(0,S+M+A[0].length);let Y=[];if(x)if(l==="block")for(Y=p.blockTokens(F),Y.forEach(I=>{I.text&&(!I.tokens||I.tokens.length===0)&&(I.tokens=p.inlineTokens(I.text))});Y.length>0;){const I=Y[Y.length-1];if(I.type==="paragraph"&&(!I.text||I.text.trim()===""))Y.pop();else break}else Y=p.inlineTokens(x);return{type:e,raw:W,attributes:w,content:x,tokens:Y}}}}}},renderMarkdown:(f,d)=>{const p=c(f.attrs||{}),h=o(p),g=h?` {${h}}`:"",y=d.renderChildren(f.content||[],`

`);return`:::${u}${g}

${y}

:::`}}}function ON(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,i,o,s]=r;e[i]=o||s,r=n.exec(t)}return e}function AN(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function RN(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=ON,serializeAttributes:o=AN,defaultAttributes:s={},selfClosing:l=!1,allowedAttributes:a}=t,u=n||e,c=d=>{if(!a)return d;const p={};return a.forEach(h=>{const g=typeof h=="string"?h:h.name,y=typeof h=="string"?void 0:h.skipIfDefault;if(g in d){const m=d[g];if(y!==void 0&&m===y)return;p[g]=m}}),p},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(d,p)=>{const h={...s,...d.attributes};if(l)return p.createNode(e,h);const g=r?r(d):d.content||"";return g?p.createNode(e,h,[p.createTextNode(g)]):p.createNode(e,h,[])},markdownTokenizer:{name:e,level:"inline",start(d){const p=l?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),h=d.match(p),g=h==null?void 0:h.index;return g!==void 0?g:-1},tokenize(d,p,h){const g=l?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),y=d.match(g);if(!y)return;let m="",v="";if(l){const[,k]=y;v=k}else{const[,k,S]=y;v=k,m=S||""}const w=i(v.trim());return{type:e,raw:y[0],content:m.trim(),attributes:w}}},renderMarkdown:d=>{let p="";r?p=r(d):d.content&&d.content.length>0&&(p=d.content.filter(m=>m.type==="text").map(m=>m.text).join(""));const h=c(d.attrs||{}),g=o(h),y=g?` ${g}`:"";return l?`[${u}${y}]`:`[${u}${y}]${p}[/${u}]`}}}function xp(t,e,n){var r,i,o,s;const l=t.split(`
`),a=[];let u="",c=0;const f=e.baseIndentSize||2;for(;c<l.length;){const d=l[c],p=d.match(e.itemPattern);if(!p){if(a.length>0)break;if(d.trim()===""){c+=1,u=`${u}${d}
`;continue}else return}const h=e.extractItemData(p),{indentLevel:g,mainContent:y}=h;u=`${u}${d}
`;const m=[y];for(c+=1;c<l.length;){const S=l[c];if(S.trim()===""){const E=l.slice(c+1).findIndex(M=>M.trim()!=="");if(E===-1)break;if((((i=(r=l[c+1+E].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>g){m.push(S),u=`${u}${S}
`,c+=1;continue}else break}if((((s=(o=S.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>g)m.push(S),u=`${u}${S}
`,c+=1;else break}let v;const w=m.slice(1);if(w.length>0){const S=w.map(x=>x.slice(g+f)).join(`
`);S.trim()&&(e.customNestedParser?v=e.customNestedParser(S):v=n.blockTokens(S))}const k=e.createToken(h,v);a.push(k)}if(a.length!==0)return{items:a,raw:u}}function Sp(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(r):n,[o,...s]=t.content,l=e.renderChildren([o]),a=[`${i}${l}`];return s&&s.length>0&&s.forEach(u=>{const c=e.renderChildren([u]);if(c){const f=c.split(`
`).map(d=>d?e.indent(d):"").join(`
`);a.push(f)}}),a.join(`
`)}function DN(t,e,n={}){const{state:r}=e,{doc:i,tr:o}=r,s=t;i.descendants((l,a)=>{const u=o.mapping.map(a),c=o.mapping.map(a)+l.nodeSize;let f=null;if(l.marks.forEach(p=>{if(p!==s)return!1;f=p}),!f)return;let d=!1;if(Object.keys(n).forEach(p=>{n[p]!==f.attrs[p]&&(d=!0)}),d){const p=t.type.create({...t.attrs,...n});o.removeMark(u,c,t.type),o.addMark(u,c,p)}}),o.docChanged&&e.view.dispatch(o)}var ht=class Uw extends yp{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new Uw(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Zr(t){return new dN({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=ie(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,l=r[r.length-1],a=r[0];let u=n.to;if(l){const c=a.search(/\S/),f=n.from+a.indexOf(l),d=f+l.length;if(dp(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(y=>y===t.type&&y!==h.mark.type)).filter(h=>h.to>f).length)return null;d<n.to&&s.delete(d,n.to),f>n.from&&s.delete(n.from+c,f),u=n.from+c+l.length,s.addMark(n.from+c,u,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:IN,getOwnPropertySymbols:PN}=Object,{hasOwnProperty:LN}=Object.prototype;function Ep(t,e){return function(r,i,o){return t(r,i,o)&&e(r,i,o)}}function Wa(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:o}=i,s=o.get(n),l=o.get(r);if(s&&l)return s===r&&l===n;o.set(n,r),o.set(r,n);const a=t(n,r,i);return o.delete(n),o.delete(r),a}}function zN(t){return t!=null?t[Symbol.toStringTag]:void 0}function tk(t){return IN(t).concat(PN(t))}const BN=Object.hasOwn||((t,e)=>LN.call(t,e));function ei(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const _N="__v",$N="__o",jN="_owner",{getOwnPropertyDescriptor:nk,keys:rk}=Object;function FN(t,e){return t.byteLength===e.byteLength&&Ka(new Uint8Array(t),new Uint8Array(e))}function HN(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function VN(t,e){return t.byteLength===e.byteLength&&Ka(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function UN(t,e){return ei(t.getTime(),e.getTime())}function WN(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function KN(t,e){return t===e}function ik(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.entries();let s,l,a=0;for(;(s=o.next())&&!s.done;){const u=e.entries();let c=!1,f=0;for(;(l=u.next())&&!l.done;){if(i[f]){f++;continue}const d=s.value,p=l.value;if(n.equals(d[0],p[0],a,f,t,e,n)&&n.equals(d[1],p[1],d[0],p[0],t,e,n)){c=i[f]=!0;break}f++}if(!c)return!1;a++}return!0}const qN=ei;function JN(t,e,n){const r=rk(t);let i=r.length;if(rk(e).length!==i)return!1;for(;i-- >0;)if(!sk(t,e,n,r[i]))return!1;return!0}function xs(t,e,n){const r=tk(t);let i=r.length;if(tk(e).length!==i)return!1;let o,s,l;for(;i-- >0;)if(o=r[i],!sk(t,e,n,o)||(s=nk(t,o),l=nk(e,o),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function QN(t,e){return ei(t.valueOf(),e.valueOf())}function GN(t,e){return t.source===e.source&&t.flags===e.flags}function ok(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.values();let s,l;for(;(s=o.next())&&!s.done;){const a=e.values();let u=!1,c=0;for(;(l=a.next())&&!l.done;){if(!i[c]&&n.equals(s.value,l.value,s.value,l.value,t,e,n)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function Ka(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function YN(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function sk(t,e,n,r){return(r===jN||r===$N||r===_N)&&(t.$$typeof||e.$$typeof)?!0:BN(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const XN="[object ArrayBuffer]",ZN="[object Arguments]",eO="[object Boolean]",tO="[object DataView]",nO="[object Date]",rO="[object Error]",iO="[object Map]",oO="[object Number]",sO="[object Object]",lO="[object RegExp]",aO="[object Set]",uO="[object String]",cO={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},fO="[object URL]",dO=Object.prototype.toString;function pO({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:o,areMapsEqual:s,areNumbersEqual:l,areObjectsEqual:a,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:f,areTypedArraysEqual:d,areUrlsEqual:p,unknownTagComparators:h}){return function(y,m,v){if(y===m)return!0;if(y==null||m==null)return!1;const w=typeof y;if(w!==typeof m)return!1;if(w!=="object")return w==="number"?l(y,m,v):w==="function"?o(y,m,v):!1;const k=y.constructor;if(k!==m.constructor)return!1;if(k===Object)return a(y,m,v);if(Array.isArray(y))return e(y,m,v);if(k===Date)return r(y,m,v);if(k===RegExp)return c(y,m,v);if(k===Map)return s(y,m,v);if(k===Set)return f(y,m,v);const S=dO.call(y);if(S===nO)return r(y,m,v);if(S===lO)return c(y,m,v);if(S===iO)return s(y,m,v);if(S===aO)return f(y,m,v);if(S===sO)return typeof y.then!="function"&&typeof m.then!="function"&&a(y,m,v);if(S===fO)return p(y,m,v);if(S===rO)return i(y,m,v);if(S===ZN)return a(y,m,v);if(cO[S])return d(y,m,v);if(S===XN)return t(y,m,v);if(S===tO)return n(y,m,v);if(S===eO||S===oO||S===uO)return u(y,m,v);if(h){let x=h[S];if(!x){const E=zN(y);E&&(x=h[E])}if(x)return x(y,m,v)}return!1}}function hO({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:FN,areArraysEqual:n?xs:HN,areDataViewsEqual:VN,areDatesEqual:UN,areErrorsEqual:WN,areFunctionsEqual:KN,areMapsEqual:n?Ep(ik,xs):ik,areNumbersEqual:qN,areObjectsEqual:n?xs:JN,arePrimitiveWrappersEqual:QN,areRegExpsEqual:GN,areSetsEqual:n?Ep(ok,xs):ok,areTypedArraysEqual:n?Ep(Ka,xs):Ka,areUrlsEqual:YN,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=Wa(r.areArraysEqual),o=Wa(r.areMapsEqual),s=Wa(r.areObjectsEqual),l=Wa(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:s,areSetsEqual:l})}return r}function mO(t){return function(e,n,r,i,o,s,l){return t(e,n,l)}}function gO({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(l,a){const{cache:u=t?new WeakMap:void 0,meta:c}=n();return e(l,a,{cache:u,equals:r,meta:c,strict:i})};if(t)return function(l,a){return e(l,a,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const o={cache:void 0,equals:r,meta:void 0,strict:i};return function(l,a){return e(l,a,o)}}const yO=yr();yr({strict:!0}),yr({circular:!0}),yr({circular:!0,strict:!0}),yr({createInternalComparator:()=>ei}),yr({strict:!0,createInternalComparator:()=>ei}),yr({circular:!0,createInternalComparator:()=>ei}),yr({circular:!0,createInternalComparator:()=>ei,strict:!0});function yr(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,o=hO(t),s=pO(o),l=n?n(s):mO(s);return gO({circular:e,comparator:s,createState:r,equals:l,strict:i})}var lk={exports:{}},ak={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qa=ne,vO=cd;function kO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wO=typeof Object.is=="function"?Object.is:kO,xO=vO.useSyncExternalStore,SO=qa.useRef,EO=qa.useEffect,CO=qa.useMemo,bO=qa.useDebugValue;ak.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var o=SO(null);if(o.current===null){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=CO(function(){function a(p){if(!u){if(u=!0,c=p,p=r(p),i!==void 0&&s.hasValue){var h=s.value;if(i(h,p))return f=h}return f=p}if(h=f,wO(c,p))return h;var g=r(p);return i!==void 0&&i(h,g)?(c=p,h):(c=p,f=g)}var u=!1,c,f,d=n===void 0?null:n;return[function(){return a(e())},d===null?void 0:function(){return a(d())}]},[e,n,r,i]);var l=xO(t,o[0],o[1]);return EO(function(){s.hasValue=!0,s.value=l},[l]),bO(l),l},lk.exports=ak;var TO=lk.exports,MO=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},NO=({contentComponent:t})=>{const e=cd.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return H.jsx(H.Fragment,{children:Object.values(e)})};function OO(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:yE.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}var AO=class extends tt.Component{constructor(t){var e;super(t),this.editorContentRef=tt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=OO(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return H.jsxs(H.Fragment,{children:[H.jsx("div",{ref:MO(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&H.jsx(NO,{contentComponent:t.contentComponent})]})}},RO=ne.forwardRef((t,e)=>{const n=tt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return tt.createElement(AO,{key:n,innerRef:e,...t})}),DO=tt.memo(RO),IO=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,PO=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function LO(t){var e;const[n]=ne.useState(()=>new PO(t.editor)),r=TO.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:yO);return IO(()=>n.watch(t.editor),[t.editor,n]),ne.useDebugValue(r),r}var zO=!1,Cp=typeof window>"u",BO=Cp||!!(typeof window<"u"&&window.next),_O=class Ww{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Cp||BO?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)==null?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)==null?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)==null?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)==null?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)==null?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)==null?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)==null?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)==null?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)==null?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)==null?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)==null?void 0:o.call(i,...r)},onDelete:(...r)=>{var i,o;return(o=(i=this.options.current).onDelete)==null?void 0:o.call(i,...r)}};return new xN(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)==null?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Ww.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function $O(t={},e=[]){const n=ne.useRef(t);n.current=t;const[r]=ne.useState(()=>new _O(n)),i=cd.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return ne.useDebugValue(i),ne.useEffect(r.onRender(e)),LO({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&o===0?0:o+1}),i}var jO=ne.createContext({editor:null});jO.Consumer;var FO=ne.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),HO=()=>ne.useContext(FO);tt.forwardRef((t,e)=>{const{onDragStart:n}=HO(),r=t.as||"div";return H.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function uk(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function ck(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function VO(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function UO(t){if(uk(t)||ck(t))return!0;if(VO(t)){const e=t.type;if(e)return uk(e)||ck(e)}return!1}function WO(){try{if(ne.version)return parseInt(ne.version.split(".")[0],10)>=19}catch{}return!1}var KO=class{constructor(t,{editor:e,props:n={},as:r="div",className:i=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?ad.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var t;const e=this.component,n=this.props,r=this.editor,i=WO(),o=UO(e),s={...n};s.ref&&!(i||o)&&delete s.ref,!s.ref&&(i||o)&&(s.ref=l=>{this.ref=l}),this.reactElement=H.jsx(e,{...s}),(t=r==null?void 0:r.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.props={...this.props,...t},this.render()}destroy(){var t;const e=this.editor;(t=e==null?void 0:e.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};tt.createContext({markViewContentRef:()=>{}});var Ja=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},qO=/^\s*>\s$/,JO=ht.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Ja("blockquote",{...Ee(this.options.HTMLAttributes,t),children:Ja("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(i=>{const l=e.renderChildren([i]).split(`
`).map(a=>a.trim()===""?n:`${n} ${a}`);r.push(l.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Zi({find:qO,type:this.type})]}}),QO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,GO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,YO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,XO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,ZO=Xr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Ja("strong",{...Ee(this.options.HTMLAttributes,t),children:Ja("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Xi({find:QO,type:this.type}),Xi({find:YO,type:this.type})]},addPasteRules(){return[Zr({find:GO,type:this.type}),Zr({find:XO,type:this.type})]}}),eA=/(^|[^`])`([^`]+)`(?!`)$/,tA=/(^|[^`])`([^`]+)`(?!`)/g,nA=Xr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ee(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Xi({find:eA,type:this.type})]},addPasteRules(){return[Zr({find:tA,type:this.type})]}}),bp=4,rA=/^```([a-z]+)?[\s\n]$/,iA=/^~~~([a-z]+)?[\s\n]$/,oA=ht.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:bp,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Ee(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const i=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:bp,{state:r}=t,{selection:i}=r,{$from:o,empty:s}=i;if(o.parent.type!==this.type)return!1;const l=" ".repeat(n);return s?t.commands.insertContent(l):t.commands.command(({tr:a})=>{const{from:u,to:c}=i,p=r.doc.textBetween(u,c,`
`,`
`).split(`
`).map(h=>l+h).join(`
`);return a.replaceWith(u,c,r.schema.text(p)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:bp,{state:r}=t,{selection:i}=r,{$from:o,empty:s}=i;return o.parent.type!==this.type?!1:s?t.commands.command(({tr:l})=>{var a;const{pos:u}=o,c=o.start(),f=o.end(),p=r.doc.textBetween(c,f,`
`,`
`).split(`
`);let h=0,g=0;const y=u-c;for(let x=0;x<p.length;x+=1){if(g+p[x].length>=y){h=x;break}g+=p[x].length+1}const v=((a=p[h].match(/^ */))==null?void 0:a[0])||"",w=Math.min(v.length,n);if(w===0)return!0;let k=c;for(let x=0;x<h;x+=1)k+=p[x].length+1;return l.delete(k,k+w),u-k<=w&&l.setSelection(V.create(l.doc,k)),!0}):t.commands.command(({tr:l})=>{const{from:a,to:u}=i,d=r.doc.textBetween(a,u,`
`,`
`).split(`
`).map(p=>{var h;const g=((h=p.match(/^ */))==null?void 0:h[0])||"",y=Math.min(g.length,n);return p.slice(y)}).join(`
`);return l.replaceWith(a,u,r.schema.text(d)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:u})=>(u.setSelection(K.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[vp({find:rA,type:this.type,getAttributes:t=>({language:t[1]})}),vp({find:iA,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new de({key:new Te("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!n||!o)return!1;const{tr:s,schema:l}=t.state,a=l.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},a)),s.selection.$from.parent.type!==this.type&&s.setSelection(V.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),sA=ht.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),lA=ht.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ee(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:l}=r.extensionManager,a=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&a&&s){const f=a.filter(d=>l.includes(d.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),aA=ht.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ee(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,i="#".repeat(r);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>vp({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),uA=ht.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ee(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!CN(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,i=t();return $1(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:s,dispatch:l})=>{if(l){const{$to:a}=s.selection,u=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?s.setSelection(V.create(s.doc,a.pos+1)):a.nodeAfter.isBlock?s.setSelection(j.create(s.doc,a.pos)):s.setSelection(V.create(s.doc,a.pos));else{const c=o.schema.nodes[this.options.nextNodeType]||a.parent.type.contentMatch.defaultType,f=c==null?void 0:c.create();f&&(s.insert(u,f),s.setSelection(V.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[ek({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),cA=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,fA=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,dA=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,pA=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,hA=Xr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ee(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Xi({find:cA,type:this.type}),Xi({find:dA,type:this.type})]},addPasteRules(){return[Zr({find:fA,type:this.type}),Zr({find:pA,type:this.type})]}});const mA="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",gA="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",Tp="numeric",Mp="ascii",Np="alpha",Ss="asciinumeric",Es="alphanumeric",Op="domain",fk="emoji",yA="scheme",vA="slashscheme",Ap="whitespace";function kA(t,e){return t in e||(e[t]=[]),e[t]}function ti(t,e,n){e[Tp]&&(e[Ss]=!0,e[Es]=!0),e[Mp]&&(e[Ss]=!0,e[Np]=!0),e[Ss]&&(e[Es]=!0),e[Np]&&(e[Es]=!0),e[Es]&&(e[Op]=!0),e[fk]&&(e[Op]=!0);for(const r in e){const i=kA(r,n);i.indexOf(t)<0&&i.push(t)}}function wA(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function mt(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}mt.groups={},mt.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let i=0;i<t.length;i++)this.tt(t[i],e,n,r)},tr(t,e,n,r){r=r||mt.groups;let i;return e&&e.j?i=e:(i=new mt(e),n&&r&&ti(e,n,r)),this.jr.push([t,i]),i},ts(t,e,n,r){let i=this;const o=t.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(t[s]);return i.tt(t[o-1],e,n,r)},tt(t,e,n,r){r=r||mt.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const o=e;let s,l=i.go(t);if(l?(s=new mt,Object.assign(s.j,l.j),s.jr.push.apply(s.jr,l.jr),s.jd=l.jd,s.t=l.t):s=new mt,o){if(r)if(s.t&&typeof s.t=="string"){const a=Object.assign(wA(s.t,r),n);ti(o,a,r)}else n&&ti(o,n,r);s.t=o}return i.j[t]=s,s}};const q=(t,e,n,r,i)=>t.ta(e,n,r,i),we=(t,e,n,r,i)=>t.tr(e,n,r,i),dk=(t,e,n,r,i)=>t.ts(e,n,r,i),O=(t,e,n,r,i)=>t.tt(e,n,r,i),Rn="WORD",Rp="UWORD",pk="ASCIINUMERICAL",hk="ALPHANUMERICAL",Cs="LOCALHOST",Dp="TLD",Ip="UTLD",Qa="SCHEME",eo="SLASH_SCHEME",Pp="NUM",Lp="WS",zp="NL",bs="OPENBRACE",Ts="CLOSEBRACE",Ga="OPENBRACKET",Ya="CLOSEBRACKET",Xa="OPENPAREN",Za="CLOSEPAREN",eu="OPENANGLEBRACKET",tu="CLOSEANGLEBRACKET",nu="FULLWIDTHLEFTPAREN",ru="FULLWIDTHRIGHTPAREN",iu="LEFTCORNERBRACKET",ou="RIGHTCORNERBRACKET",su="LEFTWHITECORNERBRACKET",lu="RIGHTWHITECORNERBRACKET",au="FULLWIDTHLESSTHAN",uu="FULLWIDTHGREATERTHAN",cu="AMPERSAND",fu="APOSTROPHE",du="ASTERISK",vr="AT",pu="BACKSLASH",hu="BACKTICK",mu="CARET",kr="COLON",Bp="COMMA",gu="DOLLAR",un="DOT",yu="EQUALS",_p="EXCLAMATION",Bt="HYPHEN",Ms="PERCENT",vu="PIPE",ku="PLUS",wu="POUND",Ns="QUERY",$p="QUOTE",mk="FULLWIDTHMIDDLEDOT",jp="SEMI",cn="SLASH",Os="TILDE",xu="UNDERSCORE",gk="EMOJI",Su="SYM";var yk=Object.freeze({__proto__:null,ALPHANUMERICAL:hk,AMPERSAND:cu,APOSTROPHE:fu,ASCIINUMERICAL:pk,ASTERISK:du,AT:vr,BACKSLASH:pu,BACKTICK:hu,CARET:mu,CLOSEANGLEBRACKET:tu,CLOSEBRACE:Ts,CLOSEBRACKET:Ya,CLOSEPAREN:Za,COLON:kr,COMMA:Bp,DOLLAR:gu,DOT:un,EMOJI:gk,EQUALS:yu,EXCLAMATION:_p,FULLWIDTHGREATERTHAN:uu,FULLWIDTHLEFTPAREN:nu,FULLWIDTHLESSTHAN:au,FULLWIDTHMIDDLEDOT:mk,FULLWIDTHRIGHTPAREN:ru,HYPHEN:Bt,LEFTCORNERBRACKET:iu,LEFTWHITECORNERBRACKET:su,LOCALHOST:Cs,NL:zp,NUM:Pp,OPENANGLEBRACKET:eu,OPENBRACE:bs,OPENBRACKET:Ga,OPENPAREN:Xa,PERCENT:Ms,PIPE:vu,PLUS:ku,POUND:wu,QUERY:Ns,QUOTE:$p,RIGHTCORNERBRACKET:ou,RIGHTWHITECORNERBRACKET:lu,SCHEME:Qa,SEMI:jp,SLASH:cn,SLASH_SCHEME:eo,SYM:Su,TILDE:Os,TLD:Dp,UNDERSCORE:xu,UTLD:Ip,UWORD:Rp,WORD:Rn,WS:Lp});const Dn=/[a-z]/,As=new RegExp("\\p{L}","u"),Fp=new RegExp("\\p{Emoji}","u"),In=/\d/,Hp=/\s/,vk="\r",Vp=`
`,xA="️",SA="‍",Up="￼";let Eu=null,Cu=null;function EA(t=[]){const e={};mt.groups=e;const n=new mt;Eu==null&&(Eu=wk(mA)),Cu==null&&(Cu=wk(gA)),O(n,"'",fu),O(n,"{",bs),O(n,"}",Ts),O(n,"[",Ga),O(n,"]",Ya),O(n,"(",Xa),O(n,")",Za),O(n,"<",eu),O(n,">",tu),O(n,"（",nu),O(n,"）",ru),O(n,"「",iu),O(n,"」",ou),O(n,"『",su),O(n,"』",lu),O(n,"＜",au),O(n,"＞",uu),O(n,"&",cu),O(n,"*",du),O(n,"@",vr),O(n,"`",hu),O(n,"^",mu),O(n,":",kr),O(n,",",Bp),O(n,"$",gu),O(n,".",un),O(n,"=",yu),O(n,"!",_p),O(n,"-",Bt),O(n,"%",Ms),O(n,"|",vu),O(n,"+",ku),O(n,"#",wu),O(n,"?",Ns),O(n,'"',$p),O(n,"/",cn),O(n,";",jp),O(n,"~",Os),O(n,"_",xu),O(n,"\\",pu),O(n,"・",mk);const r=we(n,In,Pp,{[Tp]:!0});we(r,In,r);const i=we(r,Dn,pk,{[Ss]:!0}),o=we(r,As,hk,{[Es]:!0}),s=we(n,Dn,Rn,{[Mp]:!0});we(s,In,i),we(s,Dn,s),we(i,In,i),we(i,Dn,i);const l=we(n,As,Rp,{[Np]:!0});we(l,Dn),we(l,In,o),we(l,As,l),we(o,In,o),we(o,Dn),we(o,As,o);const a=O(n,Vp,zp,{[Ap]:!0}),u=O(n,vk,Lp,{[Ap]:!0}),c=we(n,Hp,Lp,{[Ap]:!0});O(n,Up,c),O(u,Vp,a),O(u,Up,c),we(u,Hp,c),O(c,vk),O(c,Vp),we(c,Hp,c),O(c,Up,c);const f=we(n,Fp,gk,{[fk]:!0});O(f,"#"),we(f,Fp,f),O(f,xA,f);const d=O(f,SA);O(d,"#"),we(d,Fp,f);const p=[[Dn,s],[In,i]],h=[[Dn,null],[As,l],[In,o]];for(let g=0;g<Eu.length;g++)wr(n,Eu[g],Dp,Rn,p);for(let g=0;g<Cu.length;g++)wr(n,Cu[g],Ip,Rp,h);ti(Dp,{tld:!0,ascii:!0},e),ti(Ip,{utld:!0,alpha:!0},e),wr(n,"file",Qa,Rn,p),wr(n,"mailto",Qa,Rn,p),wr(n,"http",eo,Rn,p),wr(n,"https",eo,Rn,p),wr(n,"ftp",eo,Rn,p),wr(n,"ftps",eo,Rn,p),ti(Qa,{scheme:!0,ascii:!0},e),ti(eo,{slashscheme:!0,ascii:!0},e),t=t.sort((g,y)=>g[0]>y[0]?1:-1);for(let g=0;g<t.length;g++){const y=t[g][0],v=t[g][1]?{[yA]:!0}:{[vA]:!0};y.indexOf("-")>=0?v[Op]=!0:Dn.test(y)?In.test(y)?v[Ss]=!0:v[Mp]=!0:v[Tp]=!0,dk(n,y,y,v)}return dk(n,"localhost",Cs,{ascii:!0}),n.jd=new mt(Su),{start:n,tokens:Object.assign({groups:e},yk)}}function kk(t,e){const n=CA(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=n.length,i=[];let o=0,s=0;for(;s<r;){let l=t,a=null,u=0,c=null,f=-1,d=-1;for(;s<r&&(a=l.go(n[s]));)l=a,l.accepts()?(f=0,d=0,c=l):f>=0&&(f+=n[s].length,d++),u+=n[s].length,o+=n[s].length,s++;o-=f,s-=d,u-=f,i.push({t:c.t,v:e.slice(o-u,o),s:o-u,e:o})}return i}function CA(t){const e=[],n=t.length;let r=0;for(;r<n;){let i=t.charCodeAt(r),o,s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}function wr(t,e,n,r,i){let o;const s=e.length;for(let l=0;l<s-1;l++){const a=e[l];t.j[a]?o=t.j[a]:(o=new mt(r),o.jr=i.slice(),t.j[a]=o),t=o}return o=new mt(n),o.jr=i.slice(),t.j[e[s-1]]=o,o}function wk(t){const e=[],n=[];let r=0,i="0123456789";for(;r<t.length;){let o=0;for(;i.indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let s=parseInt(t.substring(r,r+o),10);s>0;s--)n.pop();r+=o}else n.push(t[r]),r++}return e}const Rs={defaultProtocol:"http",events:null,format:xk,formatHref:xk,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Wp(t,e=null){let n=Object.assign({},Rs);t&&(n=Object.assign(n,t instanceof Wp?t.o:t));const r=n.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=i}Wp.prototype={o:Rs,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:Rs[t],typeof i=="function"&&r&&(i=i(e,n))):typeof i=="function"&&r&&(i=i(e,n.t,n)),i)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function xk(t){return t}function Sk(t,e){this.t="token",this.v=t,this.tk=e}Sk.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"…":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Rs.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),i=t.get("tagName",n,e),o=this.toFormattedString(t),s={},l=t.get("className",n,e),a=t.get("target",n,e),u=t.get("rel",n,e),c=t.getObj("attributes",n,e),f=t.getObj("events",n,e);return s.href=r,l&&(s.class=l),a&&(s.target=a),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:o,eventListeners:f}}};function bu(t,e){class n extends Sk{constructor(i,o){super(i,o),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const Ek=bu("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Ck=bu("text"),bA=bu("nl"),Tu=bu("url",{isLink:!0,toHref(t=Rs.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Cs&&t[1].t===kr}}),_t=t=>new mt(t);function TA({groups:t}){const e=t.domain.concat([cu,du,vr,pu,hu,mu,gu,yu,Bt,Pp,Ms,vu,ku,wu,cn,Su,Os,xu]),n=[fu,kr,Bp,un,_p,Ms,Ns,$p,jp,eu,tu,bs,Ts,Ya,Ga,Xa,Za,nu,ru,iu,ou,su,lu,au,uu],r=[cu,fu,du,pu,hu,mu,gu,yu,Bt,bs,Ts,Ms,vu,ku,wu,Ns,cn,Su,Os,xu],i=_t(),o=O(i,Os);q(o,r,o),q(o,t.domain,o);const s=_t(),l=_t(),a=_t();q(i,t.domain,s),q(i,t.scheme,l),q(i,t.slashscheme,a),q(s,r,o),q(s,t.domain,s);const u=O(s,vr);O(o,vr,u),O(l,vr,u),O(a,vr,u);const c=O(o,un);q(c,r,o),q(c,t.domain,o);const f=_t();q(u,t.domain,f),q(f,t.domain,f);const d=O(f,un);q(d,t.domain,f);const p=_t(Ek);q(d,t.tld,p),q(d,t.utld,p),O(u,Cs,p);const h=O(f,Bt);O(h,Bt,h),q(h,t.domain,f),q(p,t.domain,f),O(p,un,d),O(p,Bt,h);const g=O(p,kr);q(g,t.numeric,Ek);const y=O(s,Bt),m=O(s,un);O(y,Bt,y),q(y,t.domain,s),q(m,r,o),q(m,t.domain,s);const v=_t(Tu);q(m,t.tld,v),q(m,t.utld,v),q(v,t.domain,s),q(v,r,o),O(v,un,m),O(v,Bt,y),O(v,vr,u);const w=O(v,kr),k=_t(Tu);q(w,t.numeric,k);const S=_t(Tu),x=_t();q(S,e,S),q(S,n,x),q(x,e,S),q(x,n,x),O(v,cn,S),O(k,cn,S);const E=O(l,kr),C=O(a,kr),A=O(C,cn),M=O(A,cn);q(l,t.domain,s),O(l,un,m),O(l,Bt,y),q(a,t.domain,s),O(a,un,m),O(a,Bt,y),q(E,t.domain,S),O(E,cn,S),O(E,Ns,S),q(M,t.domain,S),q(M,e,S),O(M,cn,S);const _=[[bs,Ts],[Ga,Ya],[Xa,Za],[eu,tu],[nu,ru],[iu,ou],[su,lu],[au,uu]];for(let F=0;F<_.length;F++){const[W,Y]=_[F],I=O(S,W);O(x,W,I),O(I,Y,S);const J=_t(Tu);q(I,e,J);const Q=_t();q(I,n),q(J,e,J),q(J,n,Q),q(Q,e,J),q(Q,n,Q),O(J,Y,S),O(Q,Y,S)}return O(i,Cs,v),O(i,zp,bA),{start:i,tokens:yk}}function MA(t,e,n){let r=n.length,i=0,o=[],s=[];for(;i<r;){let l=t,a=null,u=null,c=0,f=null,d=-1;for(;i<r&&!(a=l.go(n[i].t));)s.push(n[i++]);for(;i<r&&(u=a||l.go(n[i].t));)a=null,l=u,l.accepts()?(d=0,f=l):d>=0&&d++,i++,c++;if(d<0)i-=c,i<r&&(s.push(n[i]),i++);else{s.length>0&&(o.push(Kp(Ck,e,s)),s=[]),i-=d,c-=d;const p=f.t,h=n.slice(i-c,i);o.push(Kp(p,e,h))}}return s.length>0&&o.push(Kp(Ck,e,s)),o}function Kp(t,e,n){const r=n[0].s,i=n[n.length-1].e,o=e.slice(r,i);return new t(o,n)}const NA=typeof console<"u"&&console&&console.warn||(()=>{}),OA="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",ce={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function AA(){return mt.groups={},ce.scanner=null,ce.parser=null,ce.tokenQueue=[],ce.pluginQueue=[],ce.customSchemes=[],ce.initialized=!1,ce}function bk(t,e=!1){if(ce.initialized&&NA(`linkifyjs: already initialized - will not register custom scheme "${t}" ${OA}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);ce.customSchemes.push([t,e])}function RA(){ce.scanner=EA(ce.customSchemes);for(let t=0;t<ce.tokenQueue.length;t++)ce.tokenQueue[t][1]({scanner:ce.scanner});ce.parser=TA(ce.scanner.tokens);for(let t=0;t<ce.pluginQueue.length;t++)ce.pluginQueue[t][1]({scanner:ce.scanner,parser:ce.parser});return ce.initialized=!0,ce}function qp(t){return ce.initialized||RA(),MA(ce.parser.start,t,kk(ce.scanner.start,t))}qp.scan=kk;function Tk(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Wp(n),i=qp(t),o=[];for(let s=0;s<i.length;s++){const l=i[s];l.isLink&&(!e||l.t===e)&&r.check(l)&&o.push(l.toFormattedObject(r))}return o}var Jp="[\0-   ᠎ -\u2029 　]",DA=new RegExp(Jp),IA=new RegExp(`${Jp}$`),PA=new RegExp(Jp,"g");function LA(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function zA(t){return new de({key:new Te("autolink"),appendTransaction:(e,n,r)=>{const i=e.some(u=>u.docChanged)&&!n.doc.eq(r.doc),o=e.some(u=>u.getMeta("preventAutolink"));if(!i||o)return;const{tr:s}=r,l=T1(n.doc,[...e]);if(z1(l).forEach(({newRange:u})=>{const c=EM(r.doc,u,p=>p.isTextblock);let f,d;if(c.length>1)f=c[0],d=r.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(c.length){const p=r.doc.textBetween(u.from,u.to," "," ");if(!IA.test(p))return;f=c[0],d=r.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&d){const p=d.split(DA).filter(Boolean);if(p.length<=0)return!1;const h=p[p.length-1],g=f.pos+d.lastIndexOf(h);if(!h)return!1;const y=qp(h).map(m=>m.toObject(t.defaultProtocol));if(!LA(y))return!1;y.filter(m=>m.isLink).map(m=>({...m,from:g+m.start+1,to:g+m.end+1})).filter(m=>r.schema.marks.code?!r.doc.rangeHasMark(m.from,m.to,r.schema.marks.code):!0).filter(m=>t.validate(m.value)).filter(m=>t.shouldAutoLink(m.value)).forEach(m=>{dp(m.from,m.to,r.doc).some(v=>v.mark.type===t.type)||s.addMark(m.from,m.to,t.type.create({href:m.href}))})}}),!!s.steps.length)return s}})}function BA(t){return new de({key:new Te("handleClickLink"),props:{handleClick:(e,n,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let s=!1;if(t.enableClickSelection&&(s=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){let l=null;if(r.target instanceof HTMLAnchorElement)l=r.target;else{let f=r.target;const d=[];for(;f.nodeName!=="DIV";)d.push(f),f=f.parentNode;l=d.find(p=>p.nodeName==="A")}if(!l)return s;const a=L1(e.state,t.type.name),u=(i=l==null?void 0:l.href)!=null?i:a.href,c=(o=l==null?void 0:l.target)!=null?o:a.target;l&&u&&(window.open(u,c),s=!0)}return s}}})}function _A(t){return new de({key:new Te("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:i}=t,{state:o}=e,{selection:s}=o,{empty:l}=s;if(l)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const u=Tk(a,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!u||i!==void 0&&!i(u.href)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function ni(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&n.push(i)}),!t||t.replace(PA,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Mk=Xr.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){bk(t);return}bk(t.scheme,t.optionalSlashes)})},onDestroy(){AA()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ni(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!ni(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!ni(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Ee(this.options.HTMLAttributes,t),0]:["a",Ee(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!ni(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!ni(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Zr({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,i=Tk(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!ni(s,n),protocols:n,defaultProtocol:r}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(zA({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!ni(i,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(BA({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(_A({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),$A=Mk,jA=Object.defineProperty,FA=(t,e)=>{for(var n in e)jA(t,n,{get:e[n],enumerable:!0})},HA="listItem",Nk="textStyle",Ok=/^\s*([-+*])\s$/,Ak=ht.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ee(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(HA,this.editor.getAttributes(Nk)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Zi({find:Ok,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Zi({find:Ok,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Nk),editor:this.editor})),[t]}}),Rk=ht.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ee(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))n=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),l=e.parseChildren(s);n.push(...l)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Sp(t,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),VA={};FA(VA,{findListItemPos:()=>Ds,getNextListDepth:()=>Qp,handleBackspace:()=>Gp,handleDelete:()=>Yp,hasListBefore:()=>Dk,hasListItemAfter:()=>UA,hasListItemBefore:()=>Ik,listItemHasSubList:()=>Pk,nextListIsDeeper:()=>Lk,nextListIsHigher:()=>zk});var Ds=(t,e)=>{const{$from:n}=e.selection,r=Me(t,e.schema);let i=null,o=n.depth,s=n.pos,l=null;for(;o>0&&l===null;)i=n.node(o),i.type===r?l=o:(o-=1,s-=1);return l===null?null:{$pos:e.doc.resolve(s),depth:l}},Qp=(t,e)=>{const n=Ds(t,e);if(!n)return!1;const[,r]=IM(e,t,n.$pos.pos+4);return r},Dk=(t,e,n)=>{const{$anchor:r}=t.selection,i=Math.max(0,r.pos-2),o=t.doc.resolve(i).node();return!(!o||!n.includes(o.type.name))},Ik=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((n=i.nodeBefore)==null?void 0:n.type.name)!==t)},Pk=(t,e,n)=>{if(!n)return!1;const r=Me(t,e.schema);let i=!1;return n.descendants(o=>{o.type===r&&(i=!0)}),i},Gp=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!gr(t.state,e)&&Dk(t.state,e,n)){const{$anchor:l}=t.state.selection,a=t.state.doc.resolve(l.before()-1),u=[];a.node().descendants((d,p)=>{d.type.name===e&&u.push({node:d,pos:p})});const c=u.at(-1);if(!c)return!1;const f=t.state.doc.resolve(a.start()+c.pos+1);return t.chain().cut({from:l.start()-1,to:l.end()+1},f.end()).joinForward().run()}if(!gr(t.state,e)||!BM(t.state))return!1;const r=Ds(e,t.state);if(!r)return!1;const o=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),s=Pk(e,t.state,o);return Ik(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},Lk=(t,e)=>{const n=Qp(t,e),r=Ds(t,e);return!r||!n?!1:n>r.depth},zk=(t,e)=>{const n=Qp(t,e),r=Ds(t,e);return!r||!n?!1:n<r.depth},Yp=(t,e)=>{if(!gr(t.state,e)||!zM(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:i}=n;return!n.empty&&r.sameParent(i)?!1:Lk(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():zk(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},UA=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((n=i.nodeAfter)==null?void 0:n.type.name)!==t)},Bk=ke.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Yp(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Yp(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Gp(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Gp(t,n,r)&&(e=!0)}),e}}}}),_k=/^(\s*)(\d+)\.\s+(.*)$/,WA=/^\s/;function KA(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n],o=i.match(_k);if(!o)break;const[,s,l,a]=o,u=s.length;let c=a,f=n+1;const d=[i];for(;f<t.length;){const p=t[f];if(p.match(_k))break;if(p.trim()==="")d.push(p),c+=`
`,f+=1;else if(p.match(WA))d.push(p),c+=`
${p.slice(u+2)}`,f+=1;else break}e.push({indent:u,number:parseInt(l,10),content:c.trim(),raw:d.join(`
`)}),r=f,n=f}return[e,r]}function $k(t,e,n){var r;const i=[];let o=0;for(;o<t.length;){const s=t[o];if(s.indent===e){const l=s.content.split(`
`),a=((r=l[0])==null?void 0:r.trim())||"",u=[];a&&u.push({type:"paragraph",raw:a,tokens:n.inlineTokens(a)});const c=l.slice(1).join(`
`).trim();if(c){const p=n.blockTokens(c);u.push(...p)}let f=o+1;const d=[];for(;f<t.length&&t[f].indent>e;)d.push(t[f]),f+=1;if(d.length>0){const p=Math.min(...d.map(g=>g.indent)),h=$k(d,p,n);u.push({type:"list",ordered:!0,start:d[0].number,items:h,raw:d.map(g=>g.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),o=f}else o+=1}return i}function qA(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const o=e.parseChildren([i]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([i]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var JA="listItem",jk="textStyle",Fk=/^(\d+)\.\s$/,Hk=ht.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Ee(this.options.HTMLAttributes,n),0]:["ol",Ee(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?qA(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const i=t.split(`
`),[o,s]=KA(i);if(o.length===0)return;const l=$k(o,0,n);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:l,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(JA,this.editor.getAttributes(jk)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Zi({find:Fk,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Zi({find:Fk,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(jk)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),QA=/^\s*(\[([( |x])?\])\s$/,GA=ht.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Ee(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const i=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Sp(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),l=document.createElement("input"),a=document.createElement("div"),u=c=>{var f,d;l.ariaLabel=((d=(f=this.options.a11y)==null?void 0:f.checkboxLabel)==null?void 0:d.call(f,c,l.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return u(t),o.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",c=>c.preventDefault()),l.addEventListener("change",c=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:f}=c.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const p=n();if(typeof p!="number")return!1;const h=d.doc.nodeAt(p);return d.setNodeMarkup(p,void 0,{...h==null?void 0:h.attrs,checked:f}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,f)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,f])=>{i.setAttribute(c,f)}),i.dataset.checked=t.attrs.checked,l.checked=t.attrs.checked,o.append(l,s),i.append(o,a),Object.entries(e).forEach(([c,f])=>{i.setAttribute(c,f)}),{dom:i,contentDOM:a,update:c=>c.type!==this.type?!1:(i.dataset.checked=c.attrs.checked,l.checked=c.attrs.checked,u(c),!0)}}},addInputRules(){return[Zi({find:QA,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),YA=ht.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Ee(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=o=>{const s=xp(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,a)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:n.inlineTokens(l.mainContent),nestedTokens:a}),customNestedParser:r},n);return s?[{type:"taskList",raw:s.raw,items:s.items}]:n.blockTokens(o)},i=xp(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:r},n);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});ke.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(Ak.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(Rk.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(Bk.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(Hk.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(GA.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(YA.configure(this.options.taskList)),t}});var XA=ht.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ee(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ZA=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,e2=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,t2=Xr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ee(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Xi({find:ZA,type:this.type})]},addPasteRules(){return[Zr({find:e2,type:this.type})]}}),n2=ht.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),r2=Xr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Ee(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function i2(t={}){return new de({view(e){return new o2(e,t)}})}class o2{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,l=o.height/i.offsetHeight;if(n){let f=e.nodeBefore,d=e.nodeAfter;if(f||d){let p=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(p){let h=p.getBoundingClientRect(),g=f?h.bottom:h.top;f&&d&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*l;r={left:h.left,right:h.right,top:g-y,bottom:g+y}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),d=this.width/2*s;r={left:f.left-d,right:f.left+d,top:f.top,bottom:f.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!a||a==document.body&&getComputedStyle(a).position=="static")u=-pageXOffset,c=-pageYOffset;else{let f=a.getBoundingClientRect(),d=f.width/a.offsetWidth,p=f.height/a.offsetHeight;u=f.left-a.scrollLeft*d,c=f.top-a.scrollTop*p}this.element.style.left=(r.left-u)/s+"px",this.element.style.top=(r.top-c)/l+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=O0(this.editorView.state.doc,s,this.editorView.dragging.slice);l!=null&&(s=l)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class xe extends K{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return xe.valid(r)?new xe(r):K.near(r)}content(){return D.empty}eq(e){return e instanceof xe&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new xe(e.resolve(n.pos))}getBookmark(){return new Xp(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!s2(e)||!l2(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&xe.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(n>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let a=e.doc.resolve(i);if(xe.valid(a))return a}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!j.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let l=e.doc.resolve(i);if(xe.valid(l))return l}return null}}}xe.prototype.visible=!1,xe.findFrom=xe.findGapCursorFrom,K.jsonID("gapcursor",xe);class Xp{constructor(e){this.pos=e}map(e){return new Xp(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return xe.valid(n)?new xe(n):K.near(n)}}function Vk(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function s2(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||Vk(i.type))return!0;if(i.inlineContent)return!1}}return!0}function l2(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||Vk(i.type))return!0;if(i.inlineContent)return!1}}return!0}function a2(){return new de({props:{decorations:d2,createSelectionBetween(t,e,n){return e.pos==n.pos&&xe.valid(n)?new xe(n):null},handleClick:c2,handleKeyDown:u2,handleDOMEvents:{beforeinput:f2}}})}const u2=g1({ArrowLeft:Mu("horiz",-1),ArrowRight:Mu("horiz",1),ArrowUp:Mu("vert",-1),ArrowDown:Mu("vert",1)});function Mu(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof V){if(!o.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=xe.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new xe(u))),!0):!1}}function c2(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!xe.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&j.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new xe(r))),!0)}function f2(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof xe))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=T.empty;for(let s=r.length-1;s>=0;s--)i=T.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new D(i,0,0));return o.setSelection(V.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function d2(t){if(!(t.selection instanceof xe))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",pe.create(t.doc,[Ye.widget(t.selection.head,e,{key:"gapcursor"})])}var Nu=200,ze=function(){};ze.prototype.append=function(e){return e.length?(e=ze.from(e),!this.length&&e||e.length<Nu&&this.leafAppend(e)||this.length<Nu&&e.leafPrepend(this)||this.appendInner(e)):this},ze.prototype.prepend=function(e){return e.length?ze.from(e).append(this):this},ze.prototype.appendInner=function(e){return new p2(this,e)},ze.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?ze.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))},ze.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},ze.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)},ze.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i},ze.from=function(e){return e instanceof ze?e:e&&e.length?new Uk(e):ze.empty};var Uk=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,l){for(var a=o;a<s;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,l){for(var a=o-1;a>=s;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Nu)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Nu)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(ze);ze.empty=new Uk([]);var p2=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(o,l),s)===!1||o>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,o)-l,s+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(o,l)-l,s+l)===!1||o<l&&this.left.forEachInvertedInner(r,Math.min(i,l),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ze);const h2=500;class Xt{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,l,a,u=[],c=[];return this.items.forEach((f,d)=>{if(!f.step){i||(i=this.remapping(r,d+1),o=i.maps.length),o--,c.push(f);return}if(i){c.push(new fn(f.map));let p=f.step.map(i.slice(o)),h;p&&s.maybeStep(p).doc&&(h=s.mapping.maps[s.mapping.maps.length-1],u.push(new fn(h,void 0,void 0,u.length+c.length))),o--,h&&i.appendMap(h,o)}else s.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(o)):f.selection,a=new Xt(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:s,selection:l}}addTransform(e,n,r,i){let o=[],s=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),d=new fn(e.mapping.maps[c],f,n),p;(p=a&&a.merge(d))&&(d=p,c?o.pop():l=l.slice(0,l.length-1)),o.push(d),n&&(s++,n=void 0),i||(a=d)}let u=s-r.depth;return u>g2&&(l=m2(l,u),s-=u),new Xt(l.append(o),s)}remapping(e,n){let r=new ss;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new Xt(this.items.append(e.map(n=>new fn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,l=this.eventCount;this.items.forEach(d=>{d.selection&&l--},i);let a=n;this.items.forEach(d=>{let p=o.getMirror(--a);if(p==null)return;s=Math.min(s,p);let h=o.maps[p];if(d.step){let g=e.steps[p].invert(e.docs[p]),y=d.selection&&d.selection.map(o.slice(a+1,p));y&&l++,r.push(new fn(h,g,y))}else r.push(new fn(h))},i);let u=[];for(let d=n;d<s;d++)u.push(new fn(o.maps[d]));let c=this.items.slice(0,i).append(u).append(r),f=new Xt(c,l);return f.emptyItemCount()>h2&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,l)=>{if(l>=e)i.push(s),s.selection&&o++;else if(s.step){let a=s.step.map(n.slice(r)),u=a&&a.getMap();if(r--,u&&n.appendMap(u,r),a){let c=s.selection&&s.selection.map(n.slice(r));c&&o++;let f=new fn(u.invert(),a,c),d,p=i.length-1;(d=i.length&&i[p].merge(f))?i[p]=d:i.push(f)}}else s.map&&r--},this.items.length,0),new Xt(ze.from(i.reverse()),o)}}Xt.empty=new Xt(ze.empty,0);function m2(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class fn{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new fn(n.getMap().invert(),n,this.selection)}}}class xr{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const g2=20;function y2(t,e,n,r){let i=n.getMeta(ri),o;if(i)return i.historyState;n.getMeta(w2)&&(t=new xr(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(ri))return s.getMeta(ri).redo?new xr(t.done.addTransform(n,void 0,r,Ou(e)),t.undone,Wk(n.mapping.maps),t.prevTime,t.prevComposition):new xr(t.done,t.undone.addTransform(n,void 0,r,Ou(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!s&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!v2(n,t.prevRanges)),u=s?Zp(t.prevRanges,n.mapping):Wk(n.mapping.maps);return new xr(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,Ou(e)),Xt.empty,u,n.time,l??t.prevComposition)}else return(o=n.getMeta("rebased"))?new xr(t.done.rebased(n,o),t.undone.rebased(n,o),Zp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new xr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Zp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function v2(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function Wk(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function Zp(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function k2(t,e,n){let r=Ou(e),i=ri.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),l=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),a=new xr(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(s).setMeta(ri,{redo:n,historyState:a})}let eh=!1,Kk=null;function Ou(t){let e=t.plugins;if(Kk!=e){eh=!1,Kk=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){eh=!0;break}}return eh}const ri=new Te("history"),w2=new Te("closeHistory");function x2(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new de({key:ri,state:{init(){return new xr(Xt.empty,Xt.empty,null,0,-1)},apply(e,n,r){return y2(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?Jk:r=="historyRedo"?Qk:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function qk(t,e){return(n,r)=>{let i=ri.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=k2(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const Jk=qk(!1,!0),Qk=qk(!0,!0);ke.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new de({key:new Te("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const o=this.storage.characters({node:r.doc});if(o>i){const s=o-i,l=0,a=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=r.tr.deleteRange(l,a);return t=!0,u}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:n.doc}),o=this.storage.characters({node:e.doc});if(o<=r||i>r&&o>r&&o<=i)return!0;if(i>r&&o>r&&o>i||!e.getMeta("paste"))return!1;const l=e.selection.$head.pos,a=o-r,u=l-a,c=l;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>r)}})]}});var S2=ke.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[i2(this.options)]}});ke.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new de({key:new Te("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:i}=e,o=[];if(!n||!r)return pe.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((a,u)=>{if(a.isText)return;if(!(i>=u&&i<=u+a.nodeSize-1))return!1;s+=1});let l=0;return t.descendants((a,u)=>{if(a.isText||!(i>=u&&i<=u+a.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&s-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";o.push(Ye.node(u,u+a.nodeSize,{class:this.options.className}))}),pe.create(t,o)}}})]}});var E2=ke.create({name:"gapCursor",addProseMirrorPlugins(){return[a2()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ie(B(t,"allowGapCursor",n)))!=null?e:null}}});ke.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new de({key:new Te("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,l)=>{const a=r>=l&&r<=l+s.nodeSize,u=!s.isLeaf&&$a(s);if((a||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];o&&c.push(this.options.emptyEditorClass);const f=Ye.node(l,l+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:l,hasAnchor:a}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),pe.create(t,i)}}})]}}),ke.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new de({key:new Te("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||$1(n.selection)||t.view.dragging?null:pe.create(n.doc,[Ye.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function Gk({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var C2=ke.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Te(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(n).includes(i.name));return[new de({key:e,appendTransaction:(i,o,s)=>{const{doc:l,tr:a,schema:u}=s,c=e.getState(s),f=l.content.size,d=u.nodes[n];if(c)return a.insert(f,d.create())},state:{init:(i,o)=>{const s=o.tr.doc.lastChild;return!Gk({node:s,types:r})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;const s=i.doc.lastChild;return!Gk({node:s,types:r})}}})]}}),b2=ke.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Jk(t,e),redo:()=>({state:t,dispatch:e})=>Qk(t,e)}},addProseMirrorPlugins(){return[x2(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),T2=ke.create({name:"starterKit",addExtensions(){var t,e,n,r;const i=[];return this.options.bold!==!1&&i.push(ZO.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(JO.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(Ak.configure(this.options.bulletList)),this.options.code!==!1&&i.push(nA.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(oA.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(sA.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(S2.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(E2.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(lA.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(aA.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(b2.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(uA.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(hA.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Rk.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(Bk.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(Mk.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(Hk.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(XA.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(t2.configure(this.options.strike)),this.options.text!==!1&&i.push(n2.configure(this.options.text)),this.options.underline!==!1&&i.push(r2.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&i.push(C2.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),M2=T2,N2=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,O2=ht.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",Ee(this.options.HTMLAttributes,t)]},parseMarkdown:(t,e)=>e.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var e,n,r,i,o,s;const l=(n=(e=t.attrs)==null?void 0:e.src)!=null?n:"",a=(i=(r=t.attrs)==null?void 0:r.alt)!=null?i:"",u=(s=(o=t.attrs)==null?void 0:o.title)!=null?s:"";return u?`![${a}](${l} "${u}")`:`![${a}](${l})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:e,minHeight:n,alwaysPreserveAspectRatio:r}=this.options.resize;return({node:i,getPos:o,HTMLAttributes:s,editor:l})=>{const a=document.createElement("img");Object.entries(s).forEach(([f,d])=>{if(d!=null)switch(f){case"width":case"height":break;default:a.setAttribute(f,d);break}}),a.src=s.src;const u=new EN({element:a,editor:l,node:i,getPos:o,onResize:(f,d)=>{a.style.width=`${f}px`,a.style.height=`${d}px`},onCommit:(f,d)=>{const p=o();p!==void 0&&this.editor.chain().setNodeSelection(p).updateAttributes(this.name,{width:f,height:d}).run()},onUpdate:(f,d,p)=>f.type===i.type,options:{directions:t,min:{width:e,height:n},preserveAspectRatio:r===!0}}),c=u.dom;return c.style.visibility="hidden",c.style.pointerEvents="none",a.onload=()=>{c.style.visibility="",c.style.pointerEvents=""},u}},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[ek({find:N2,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}}),A2=O2;/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var R2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ue=(t,e)=>{const n=ne.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:l="",children:a,...u},c)=>ne.createElement("svg",{ref:c,...R2,width:i,height:i,stroke:r,strokeWidth:s?Number(o)*24/Number(i):o,className:["lucide",`lucide-${D2(t)}`,l].join(" "),...u},[...e.map(([f,d])=>ne.createElement(f,d)),...Array.isArray(a)?a:[a]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=Ue("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=Ue("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=Ue("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=Ue("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=Ue("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=Ue("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=Ue("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=Ue("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=Ue("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=Ue("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=Ue("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=Ue("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=Ue("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=Ue("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=Ue("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=Ue("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=Ue("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);function K2(t){var e;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:l}=t,a=r&&!i,u=bN(n),c=new RegExp(`\\s${u}$`),f=s?"^":"",d=i?"":u,p=a?new RegExp(`${f}${u}.*?(?=\\s${d}|$)`,"gm"):new RegExp(`${f}(?:^)?${u}[^\\s${d}]*`,"gm"),h=((e=l.nodeBefore)==null?void 0:e.isText)&&l.nodeBefore.text;if(!h)return null;const g=l.pos-h.length,y=Array.from(h.matchAll(p)).pop();if(!y||y.input===void 0||y.index===void 0)return null;const m=y.input.slice(Math.max(0,y.index-1),y.index),v=new RegExp(`^[${o==null?void 0:o.join("")}\0]?$`).test(m);if(o!==null&&!v)return null;const w=g+y.index;let k=w+y[0].length;return a&&c.test(h.slice(k-1,k+1))&&(y[0]+=" ",k+=1),w<l.pos&&k>=l.pos?{range:{from:w,to:k},query:y[0].slice(n.length),text:y[0]}:null}var q2=new Te("suggestion");function J2({pluginKey:t=q2,editor:e,char:n="@",allowSpaces:r=!1,allowToIncludeChar:i=!1,allowedPrefixes:o=[" "],startOfLine:s=!1,decorationTag:l="span",decorationClass:a="suggestion",decorationContent:u="",decorationEmptyClass:c="is-empty",command:f=()=>null,items:d=()=>[],render:p=()=>({}),allow:h=()=>!0,findSuggestionMatch:g=K2}){let y;const m=p==null?void 0:p(),v=()=>{const x=e.state.selection.$anchor.pos,E=e.view.coordsAtPos(x),{top:C,right:A,bottom:M,left:_}=E;try{return new DOMRect(_,C,A-_,M-C)}catch{return null}},w=(x,E)=>E?()=>{const C=t.getState(e.state),A=C==null?void 0:C.decorationId,M=x.dom.querySelector(`[data-decoration-id="${A}"]`);return(M==null?void 0:M.getBoundingClientRect())||null}:v;function k(x,E){var C;try{const M=t.getState(x.state),_=M!=null&&M.decorationId?x.dom.querySelector(`[data-decoration-id="${M.decorationId}"]`):null,F={editor:e,range:(M==null?void 0:M.range)||{from:0,to:0},query:(M==null?void 0:M.query)||null,text:(M==null?void 0:M.text)||null,items:[],command:W=>f({editor:e,range:(M==null?void 0:M.range)||{from:0,to:0},props:W}),decorationNode:_,clientRect:w(x,_)};(C=m==null?void 0:m.onExit)==null||C.call(m,F)}catch{}const A=x.state.tr.setMeta(E,{exit:!0});x.dispatch(A)}const S=new de({key:t,view(){return{update:async(x,E)=>{var C,A,M,_,F,W,Y;const I=(C=this.key)==null?void 0:C.getState(E),J=(A=this.key)==null?void 0:A.getState(x.state),Q=I.active&&J.active&&I.range.from!==J.range.from,R=!I.active&&J.active,z=I.active&&!J.active,$=!R&&!z&&I.query!==J.query,X=R||Q&&$,Z=$||Q,Ze=z||Q&&$;if(!X&&!Z&&!Ze)return;const he=Ze&&!X?I:J,Be=x.dom.querySelector(`[data-decoration-id="${he.decorationId}"]`);y={editor:e,range:he.range,query:he.query,text:he.text,items:[],command:Ae=>f({editor:e,range:he.range,props:Ae}),decorationNode:Be,clientRect:w(x,Be)},X&&((M=m==null?void 0:m.onBeforeStart)==null||M.call(m,y)),Z&&((_=m==null?void 0:m.onBeforeUpdate)==null||_.call(m,y)),(Z||X)&&(y.items=await d({editor:e,query:he.query})),Ze&&((F=m==null?void 0:m.onExit)==null||F.call(m,y)),Z&&((W=m==null?void 0:m.onUpdate)==null||W.call(m,y)),X&&((Y=m==null?void 0:m.onStart)==null||Y.call(m,y))},destroy:()=>{var x;y&&((x=m==null?void 0:m.onExit)==null||x.call(m,y))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(x,E,C,A){const{isEditable:M}=e,{composing:_}=e.view,{selection:F}=x,{empty:W,from:Y}=F,I={...E},J=x.getMeta(t);if(J&&J.exit)return I.active=!1,I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null,I;if(I.composing=_,M&&(W||e.view.composing)){(Y<E.range.from||Y>E.range.to)&&!_&&!E.composing&&(I.active=!1);const Q=g({char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:o,startOfLine:s,$position:F.$from}),R=`id_${Math.floor(Math.random()*4294967295)}`;Q&&h({editor:e,state:A,range:Q.range,isActive:E.active})?(I.active=!0,I.decorationId=E.decorationId?E.decorationId:R,I.range=Q.range,I.query=Q.query,I.text=Q.text):I.active=!1}else I.active=!1;return I.active||(I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null),I}},props:{handleKeyDown(x,E){var C,A,M,_;const{active:F,range:W}=S.getState(x.state);if(!F)return!1;if(E.key==="Escape"||E.key==="Esc"){const I=S.getState(x.state),J=(C=y==null?void 0:y.decorationNode)!=null?C:null,Q=J??(I!=null&&I.decorationId?x.dom.querySelector(`[data-decoration-id="${I.decorationId}"]`):null);if(((A=m==null?void 0:m.onKeyDown)==null?void 0:A.call(m,{view:x,event:E,range:I.range}))||!1)return!0;const z={editor:e,range:I.range,query:I.query,text:I.text,items:[],command:$=>f({editor:e,range:I.range,props:$}),decorationNode:Q,clientRect:Q?()=>Q.getBoundingClientRect()||null:null};return(M=m==null?void 0:m.onExit)==null||M.call(m,z),k(x,t),!0}return((_=m==null?void 0:m.onKeyDown)==null?void 0:_.call(m,{view:x,event:E,range:W}))||!1},decorations(x){const{active:E,range:C,decorationId:A,query:M}=S.getState(x);if(!E)return null;const _=!(M!=null&&M.length),F=[a];return _&&F.push(c),pe.create(x.doc,[Ye.inline(C.from,C.to,{nodeName:l,class:F.join(" "),"data-decoration-id":A,"data-decoration-content":u})])}}});return S}var Q2=J2,gt="top",$t="bottom",jt="right",yt="left",th="auto",Is=[gt,$t,jt,yt],to="start",Ps="end",G2="clippingParents",tw="viewport",Ls="popper",Y2="reference",nw=Is.reduce(function(t,e){return t.concat([e+"-"+to,e+"-"+Ps])},[]),rw=[].concat(Is,[th]).reduce(function(t,e){return t.concat([e,e+"-"+to,e+"-"+Ps])},[]),X2="beforeRead",Z2="read",eR="afterRead",tR="beforeMain",nR="main",rR="afterMain",iR="beforeWrite",oR="write",sR="afterWrite",lR=[X2,Z2,eR,tR,nR,rR,iR,oR,sR];function dn(t){return t?(t.nodeName||"").toLowerCase():null}function Tt(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ii(t){var e=Tt(t).Element;return t instanceof e||t instanceof Element}function Ft(t){var e=Tt(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function nh(t){if(typeof ShadowRoot>"u")return!1;var e=Tt(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function aR(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!Ft(o)||!dn(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var l=i[s];l===!1?o.removeAttribute(s):o.setAttribute(s,l===!0?"":l)}))})}function uR(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=s.reduce(function(a,u){return a[u]="",a},{});!Ft(i)||!dn(i)||(Object.assign(i.style,l),Object.keys(o).forEach(function(a){i.removeAttribute(a)}))})}}const iw={name:"applyStyles",enabled:!0,phase:"write",fn:aR,effect:uR,requires:["computeStyles"]};function pn(t){return t.split("-")[0]}var oi=Math.max,Au=Math.min,no=Math.round;function rh(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ow(){return!/^((?!chrome|android).)*safari/i.test(rh())}function ro(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&Ft(t)&&(i=t.offsetWidth>0&&no(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&no(r.height)/t.offsetHeight||1);var s=ii(t)?Tt(t):window,l=s.visualViewport,a=!ow()&&n,u=(r.left+(a&&l?l.offsetLeft:0))/i,c=(r.top+(a&&l?l.offsetTop:0))/o,f=r.width/i,d=r.height/o;return{width:f,height:d,top:c,right:u+f,bottom:c+d,left:u,x:u,y:c}}function ih(t){var e=ro(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function sw(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&nh(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Pn(t){return Tt(t).getComputedStyle(t)}function cR(t){return["table","td","th"].indexOf(dn(t))>=0}function Sr(t){return((ii(t)?t.ownerDocument:t.document)||window.document).documentElement}function Ru(t){return dn(t)==="html"?t:t.assignedSlot||t.parentNode||(nh(t)?t.host:null)||Sr(t)}function lw(t){return!Ft(t)||Pn(t).position==="fixed"?null:t.offsetParent}function fR(t){var e=/firefox/i.test(rh()),n=/Trident/i.test(rh());if(n&&Ft(t)){var r=Pn(t);if(r.position==="fixed")return null}var i=Ru(t);for(nh(i)&&(i=i.host);Ft(i)&&["html","body"].indexOf(dn(i))<0;){var o=Pn(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function zs(t){for(var e=Tt(t),n=lw(t);n&&cR(n)&&Pn(n).position==="static";)n=lw(n);return n&&(dn(n)==="html"||dn(n)==="body"&&Pn(n).position==="static")?e:n||fR(t)||e}function oh(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Bs(t,e,n){return oi(t,Au(e,n))}function dR(t,e,n){var r=Bs(t,e,n);return r>n?n:r}function aw(){return{top:0,right:0,bottom:0,left:0}}function uw(t){return Object.assign({},aw(),t)}function cw(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var pR=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,uw(typeof e!="number"?e:cw(e,Is))};function hR(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,l=pn(n.placement),a=oh(l),u=[yt,jt].indexOf(l)>=0,c=u?"height":"width";if(!(!o||!s)){var f=pR(i.padding,n),d=ih(o),p=a==="y"?gt:yt,h=a==="y"?$t:jt,g=n.rects.reference[c]+n.rects.reference[a]-s[a]-n.rects.popper[c],y=s[a]-n.rects.reference[a],m=zs(o),v=m?a==="y"?m.clientHeight||0:m.clientWidth||0:0,w=g/2-y/2,k=f[p],S=v-d[c]-f[h],x=v/2-d[c]/2+w,E=Bs(k,x,S),C=a;n.modifiersData[r]=(e={},e[C]=E,e.centerOffset=E-x,e)}}function mR(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||sw(e.elements.popper,i)&&(e.elements.arrow=i))}const gR={name:"arrow",enabled:!0,phase:"main",fn:hR,effect:mR,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function io(t){return t.split("-")[1]}var yR={top:"auto",right:"auto",bottom:"auto",left:"auto"};function vR(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:no(n*i)/i||0,y:no(r*i)/i||0}}function fw(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,l=t.position,a=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,f=t.isFixed,d=s.x,p=d===void 0?0:d,h=s.y,g=h===void 0?0:h,y=typeof c=="function"?c({x:p,y:g}):{x:p,y:g};p=y.x,g=y.y;var m=s.hasOwnProperty("x"),v=s.hasOwnProperty("y"),w=yt,k=gt,S=window;if(u){var x=zs(n),E="clientHeight",C="clientWidth";if(x===Tt(n)&&(x=Sr(n),Pn(x).position!=="static"&&l==="absolute"&&(E="scrollHeight",C="scrollWidth")),x=x,i===gt||(i===yt||i===jt)&&o===Ps){k=$t;var A=f&&x===S&&S.visualViewport?S.visualViewport.height:x[E];g-=A-r.height,g*=a?1:-1}if(i===yt||(i===gt||i===$t)&&o===Ps){w=jt;var M=f&&x===S&&S.visualViewport?S.visualViewport.width:x[C];p-=M-r.width,p*=a?1:-1}}var _=Object.assign({position:l},u&&yR),F=c===!0?vR({x:p,y:g},Tt(n)):{x:p,y:g};if(p=F.x,g=F.y,a){var W;return Object.assign({},_,(W={},W[k]=v?"0":"",W[w]=m?"0":"",W.transform=(S.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",W))}return Object.assign({},_,(e={},e[k]=v?g+"px":"",e[w]=m?p+"px":"",e.transform="",e))}function kR(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,l=n.roundOffsets,a=l===void 0?!0:l,u={placement:pn(e.placement),variation:io(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,fw(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:a})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,fw(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const wR={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:kR,data:{}};var Du={passive:!0};function xR(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,l=s===void 0?!0:s,a=Tt(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach(function(c){c.addEventListener("scroll",n.update,Du)}),l&&a.addEventListener("resize",n.update,Du),function(){o&&u.forEach(function(c){c.removeEventListener("scroll",n.update,Du)}),l&&a.removeEventListener("resize",n.update,Du)}}const SR={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xR,data:{}};var ER={left:"right",right:"left",bottom:"top",top:"bottom"};function Iu(t){return t.replace(/left|right|bottom|top/g,function(e){return ER[e]})}var CR={start:"end",end:"start"};function dw(t){return t.replace(/start|end/g,function(e){return CR[e]})}function sh(t){var e=Tt(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function lh(t){return ro(Sr(t)).left+sh(t).scrollLeft}function bR(t,e){var n=Tt(t),r=Sr(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,l=0,a=0;if(i){o=i.width,s=i.height;var u=ow();(u||!u&&e==="fixed")&&(l=i.offsetLeft,a=i.offsetTop)}return{width:o,height:s,x:l+lh(t),y:a}}function TR(t){var e,n=Sr(t),r=sh(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=oi(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=oi(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+lh(t),a=-r.scrollTop;return Pn(i||n).direction==="rtl"&&(l+=oi(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:l,y:a}}function ah(t){var e=Pn(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function pw(t){return["html","body","#document"].indexOf(dn(t))>=0?t.ownerDocument.body:Ft(t)&&ah(t)?t:pw(Ru(t))}function _s(t,e){var n;e===void 0&&(e=[]);var r=pw(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=Tt(r),s=i?[o].concat(o.visualViewport||[],ah(r)?r:[]):r,l=e.concat(s);return i?l:l.concat(_s(Ru(s)))}function uh(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function MR(t,e){var n=ro(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function hw(t,e,n){return e===tw?uh(bR(t,n)):ii(e)?MR(e,n):uh(TR(Sr(t)))}function NR(t){var e=_s(Ru(t)),n=["absolute","fixed"].indexOf(Pn(t).position)>=0,r=n&&Ft(t)?zs(t):t;return ii(r)?e.filter(function(i){return ii(i)&&sw(i,r)&&dn(i)!=="body"}):[]}function OR(t,e,n,r){var i=e==="clippingParents"?NR(t):[].concat(e),o=[].concat(i,[n]),s=o[0],l=o.reduce(function(a,u){var c=hw(t,u,r);return a.top=oi(c.top,a.top),a.right=Au(c.right,a.right),a.bottom=Au(c.bottom,a.bottom),a.left=oi(c.left,a.left),a},hw(t,s,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function mw(t){var e=t.reference,n=t.element,r=t.placement,i=r?pn(r):null,o=r?io(r):null,s=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,a;switch(i){case gt:a={x:s,y:e.y-n.height};break;case $t:a={x:s,y:e.y+e.height};break;case jt:a={x:e.x+e.width,y:l};break;case yt:a={x:e.x-n.width,y:l};break;default:a={x:e.x,y:e.y}}var u=i?oh(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(o){case to:a[u]=a[u]-(e[c]/2-n[c]/2);break;case Ps:a[u]=a[u]+(e[c]/2-n[c]/2);break}}return a}function $s(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,l=n.boundary,a=l===void 0?G2:l,u=n.rootBoundary,c=u===void 0?tw:u,f=n.elementContext,d=f===void 0?Ls:f,p=n.altBoundary,h=p===void 0?!1:p,g=n.padding,y=g===void 0?0:g,m=uw(typeof y!="number"?y:cw(y,Is)),v=d===Ls?Y2:Ls,w=t.rects.popper,k=t.elements[h?v:d],S=OR(ii(k)?k:k.contextElement||Sr(t.elements.popper),a,c,s),x=ro(t.elements.reference),E=mw({reference:x,element:w,placement:i}),C=uh(Object.assign({},w,E)),A=d===Ls?C:x,M={top:S.top-A.top+m.top,bottom:A.bottom-S.bottom+m.bottom,left:S.left-A.left+m.left,right:A.right-S.right+m.right},_=t.modifiersData.offset;if(d===Ls&&_){var F=_[i];Object.keys(M).forEach(function(W){var Y=[jt,$t].indexOf(W)>=0?1:-1,I=[gt,$t].indexOf(W)>=0?"y":"x";M[W]+=F[I]*Y})}return M}function AR(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,l=n.flipVariations,a=n.allowedAutoPlacements,u=a===void 0?rw:a,c=io(r),f=c?l?nw:nw.filter(function(h){return io(h)===c}):Is,d=f.filter(function(h){return u.indexOf(h)>=0});d.length===0&&(d=f);var p=d.reduce(function(h,g){return h[g]=$s(t,{placement:g,boundary:i,rootBoundary:o,padding:s})[pn(g)],h},{});return Object.keys(p).sort(function(h,g){return p[h]-p[g]})}function RR(t){if(pn(t)===th)return[];var e=Iu(t);return[dw(t),e,dw(e)]}function DR(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!0:s,a=n.fallbackPlacements,u=n.padding,c=n.boundary,f=n.rootBoundary,d=n.altBoundary,p=n.flipVariations,h=p===void 0?!0:p,g=n.allowedAutoPlacements,y=e.options.placement,m=pn(y),v=m===y,w=a||(v||!h?[Iu(y)]:RR(y)),k=[y].concat(w).reduce(function(he,Be){return he.concat(pn(Be)===th?AR(e,{placement:Be,boundary:c,rootBoundary:f,padding:u,flipVariations:h,allowedAutoPlacements:g}):Be)},[]),S=e.rects.reference,x=e.rects.popper,E=new Map,C=!0,A=k[0],M=0;M<k.length;M++){var _=k[M],F=pn(_),W=io(_)===to,Y=[gt,$t].indexOf(F)>=0,I=Y?"width":"height",J=$s(e,{placement:_,boundary:c,rootBoundary:f,altBoundary:d,padding:u}),Q=Y?W?jt:yt:W?$t:gt;S[I]>x[I]&&(Q=Iu(Q));var R=Iu(Q),z=[];if(o&&z.push(J[F]<=0),l&&z.push(J[Q]<=0,J[R]<=0),z.every(function(he){return he})){A=_,C=!1;break}E.set(_,z)}if(C)for(var $=h?3:1,X=function(Be){var Ae=k.find(function(en){var Ln=E.get(en);if(Ln)return Ln.slice(0,Be).every(function(so){return so})});if(Ae)return A=Ae,"break"},Z=$;Z>0;Z--){var Ze=X(Z);if(Ze==="break")break}e.placement!==A&&(e.modifiersData[r]._skip=!0,e.placement=A,e.reset=!0)}}const IR={name:"flip",enabled:!0,phase:"main",fn:DR,requiresIfExists:["offset"],data:{_skip:!1}};function gw(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function yw(t){return[gt,jt,$t,yt].some(function(e){return t[e]>=0})}function PR(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=$s(e,{elementContext:"reference"}),l=$s(e,{altBoundary:!0}),a=gw(s,r),u=gw(l,i,o),c=yw(a),f=yw(u);e.modifiersData[n]={referenceClippingOffsets:a,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}const LR={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:PR};function zR(t,e,n){var r=pn(t),i=[yt,gt].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],l=o[1];return s=s||0,l=(l||0)*i,[yt,jt].indexOf(r)>=0?{x:l,y:s}:{x:s,y:l}}function BR(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=rw.reduce(function(c,f){return c[f]=zR(f,e.rects,o),c},{}),l=s[e.placement],a=l.x,u=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=a,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=s}const _R={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:BR};function $R(t){var e=t.state,n=t.name;e.modifiersData[n]=mw({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const jR={name:"popperOffsets",enabled:!0,phase:"read",fn:$R,data:{}};function FR(t){return t==="x"?"y":"x"}function HR(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!1:s,a=n.boundary,u=n.rootBoundary,c=n.altBoundary,f=n.padding,d=n.tether,p=d===void 0?!0:d,h=n.tetherOffset,g=h===void 0?0:h,y=$s(e,{boundary:a,rootBoundary:u,padding:f,altBoundary:c}),m=pn(e.placement),v=io(e.placement),w=!v,k=oh(m),S=FR(k),x=e.modifiersData.popperOffsets,E=e.rects.reference,C=e.rects.popper,A=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,M=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),_=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(x){if(o){var W,Y=k==="y"?gt:yt,I=k==="y"?$t:jt,J=k==="y"?"height":"width",Q=x[k],R=Q+y[Y],z=Q-y[I],$=p?-C[J]/2:0,X=v===to?E[J]:C[J],Z=v===to?-C[J]:-E[J],Ze=e.elements.arrow,he=p&&Ze?ih(Ze):{width:0,height:0},Be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:aw(),Ae=Be[Y],en=Be[I],Ln=Bs(0,E[J],he[J]),so=w?E[J]/2-$-Ln-Ae-M.mainAxis:X-Ln-Ae-M.mainAxis,Er=w?-E[J]/2+$+Ln+en+M.mainAxis:Z+Ln+en+M.mainAxis,lo=e.elements.arrow&&zs(e.elements.arrow),Bu=lo?k==="y"?lo.clientTop||0:lo.clientLeft||0:0,Hs=(W=_==null?void 0:_[k])!=null?W:0,_u=Q+so-Hs-Bu,$u=Q+Er-Hs,Vs=Bs(p?Au(R,_u):R,Q,p?oi(z,$u):z);x[k]=Vs,F[k]=Vs-Q}if(l){var Us,ju=k==="x"?gt:yt,Fu=k==="x"?$t:jt,zn=x[S],Cr=S==="y"?"height":"width",Ws=zn+y[ju],li=zn-y[Fu],Ks=[gt,yt].indexOf(m)!==-1,Hu=(Us=_==null?void 0:_[S])!=null?Us:0,Vu=Ks?Ws:zn-E[Cr]-C[Cr]-Hu+M.altAxis,Uu=Ks?zn+E[Cr]+C[Cr]-Hu-M.altAxis:li,Wu=p&&Ks?dR(Vu,zn,Uu):Bs(p?Vu:Ws,zn,p?Uu:li);x[S]=Wu,F[S]=Wu-zn}e.modifiersData[r]=F}}const VR={name:"preventOverflow",enabled:!0,phase:"main",fn:HR,requiresIfExists:["offset"]};function UR(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function WR(t){return t===Tt(t)||!Ft(t)?sh(t):UR(t)}function KR(t){var e=t.getBoundingClientRect(),n=no(e.width)/t.offsetWidth||1,r=no(e.height)/t.offsetHeight||1;return n!==1||r!==1}function qR(t,e,n){n===void 0&&(n=!1);var r=Ft(e),i=Ft(e)&&KR(e),o=Sr(e),s=ro(t,i,n),l={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!n)&&((dn(e)!=="body"||ah(o))&&(l=WR(e)),Ft(e)?(a=ro(e,!0),a.x+=e.clientLeft,a.y+=e.clientTop):o&&(a.x=lh(o))),{x:s.left+l.scrollLeft-a.x,y:s.top+l.scrollTop-a.y,width:s.width,height:s.height}}function JR(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(l){if(!n.has(l)){var a=e.get(l);a&&i(a)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function QR(t){var e=JR(t);return lR.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function GR(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function YR(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var vw={placement:"bottom",modifiers:[],strategy:"absolute"};function kw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function XR(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?vw:i;return function(l,a,u){u===void 0&&(u=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},vw,o),modifiersData:{},elements:{reference:l,popper:a},attributes:{},styles:{}},f=[],d=!1,p={state:c,setOptions:function(m){var v=typeof m=="function"?m(c.options):m;g(),c.options=Object.assign({},o,c.options,v),c.scrollParents={reference:ii(l)?_s(l):l.contextElement?_s(l.contextElement):[],popper:_s(a)};var w=QR(YR([].concat(r,c.options.modifiers)));return c.orderedModifiers=w.filter(function(k){return k.enabled}),h(),p.update()},forceUpdate:function(){if(!d){var m=c.elements,v=m.reference,w=m.popper;if(kw(v,w)){c.rects={reference:qR(v,zs(w),c.options.strategy==="fixed"),popper:ih(w)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(M){return c.modifiersData[M.name]=Object.assign({},M.data)});for(var k=0;k<c.orderedModifiers.length;k++){if(c.reset===!0){c.reset=!1,k=-1;continue}var S=c.orderedModifiers[k],x=S.fn,E=S.options,C=E===void 0?{}:E,A=S.name;typeof x=="function"&&(c=x({state:c,options:C,name:A,instance:p})||c)}}}},update:GR(function(){return new Promise(function(y){p.forceUpdate(),y(c)})}),destroy:function(){g(),d=!0}};if(!kw(l,a))return p;p.setOptions(u).then(function(y){!d&&u.onFirstUpdate&&u.onFirstUpdate(y)});function h(){c.orderedModifiers.forEach(function(y){var m=y.name,v=y.options,w=v===void 0?{}:v,k=y.effect;if(typeof k=="function"){var S=k({state:c,name:m,instance:p,options:w}),x=function(){};f.push(S||x)}})}function g(){f.forEach(function(y){return y()}),f=[]}return p}}var ZR=[SR,jR,wR,iw,_R,IR,VR,gR,LR],eD=XR({defaultModifiers:ZR}),tD="tippy-box",ww="tippy-content",nD="tippy-backdrop",xw="tippy-arrow",Sw="tippy-svg-arrow",si={passive:!0,capture:!0},Ew=function(){return document.body};function ch(t,e,n){if(Array.isArray(t)){var r=t[e];return r??(Array.isArray(n)?n[e]:n)}return t}function fh(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function Cw(t,e){return typeof t=="function"?t.apply(void 0,e):t}function bw(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function rD(t){return t.split(/\s+/).filter(Boolean)}function oo(t){return[].concat(t)}function Tw(t,e){t.indexOf(e)===-1&&t.push(e)}function iD(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function oD(t){return t.split("-")[0]}function Pu(t){return[].slice.call(t)}function Mw(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function js(){return document.createElement("div")}function Lu(t){return["Element","Fragment"].some(function(e){return fh(t,e)})}function sD(t){return fh(t,"NodeList")}function lD(t){return fh(t,"MouseEvent")}function aD(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function uD(t){return Lu(t)?[t]:sD(t)?Pu(t):Array.isArray(t)?t:Pu(document.querySelectorAll(t))}function dh(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function Nw(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function cD(t){var e,n=oo(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function fD(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,l=i.props,a=l.interactiveBorder,u=oD(s.placement),c=s.modifiersData.offset;if(!c)return!0;var f=u==="bottom"?c.top.y:0,d=u==="top"?c.bottom.y:0,p=u==="right"?c.left.x:0,h=u==="left"?c.right.x:0,g=o.top-r+f>a,y=r-o.bottom-d>a,m=o.left-n+p>a,v=n-o.right-h>a;return g||y||m||v})}function ph(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function Ow(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var hn={isTouch:!1},Aw=0;function dD(){hn.isTouch||(hn.isTouch=!0,window.performance&&document.addEventListener("mousemove",Rw))}function Rw(){var t=performance.now();t-Aw<20&&(hn.isTouch=!1,document.removeEventListener("mousemove",Rw)),Aw=t}function pD(){var t=document.activeElement;if(aD(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function hD(){document.addEventListener("touchstart",dD,si),window.addEventListener("blur",pD)}var mD=typeof window<"u"&&typeof document<"u",gD=mD?!!window.msCrypto:!1,yD={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},vD={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Zt=Object.assign({appendTo:Ew,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},yD,vD),kD=Object.keys(Zt),wD=function(e){var n=Object.keys(e);n.forEach(function(r){Zt[r]=e[r]})};function Dw(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var l;r[o]=t[o]!==void 0?t[o]:(l=Zt[o])!=null?l:s}return r},{});return Object.assign({},t,n)}function xD(t,e){var n=e?Object.keys(Dw(Object.assign({},Zt,{plugins:e}))):kD,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function Iw(t,e){var n=Object.assign({},e,{content:Cw(e.content,[t])},e.ignoreAttributes?{}:xD(t,e.plugins));return n.aria=Object.assign({},Zt.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var SD=function(){return"innerHTML"};function hh(t,e){t[SD()]=e}function Pw(t){var e=js();return t===!0?e.className=xw:(e.className=Sw,Lu(t)?e.appendChild(t):hh(e,t)),e}function Lw(t,e){Lu(e.content)?(hh(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?hh(t,e.content):t.textContent=e.content)}function mh(t){var e=t.firstElementChild,n=Pu(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(ww)}),arrow:n.find(function(r){return r.classList.contains(xw)||r.classList.contains(Sw)}),backdrop:n.find(function(r){return r.classList.contains(nD)})}}function zw(t){var e=js(),n=js();n.className=tD,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=js();r.className=ww,r.setAttribute("data-state","hidden"),Lw(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var l=mh(e),a=l.box,u=l.content,c=l.arrow;s.theme?a.setAttribute("data-theme",s.theme):a.removeAttribute("data-theme"),typeof s.animation=="string"?a.setAttribute("data-animation",s.animation):a.removeAttribute("data-animation"),s.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?a.setAttribute("role",s.role):a.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&Lw(u,t.props),s.arrow?c?o.arrow!==s.arrow&&(a.removeChild(c),a.appendChild(Pw(s.arrow))):a.appendChild(Pw(s.arrow)):c&&a.removeChild(c)}return{popper:e,onUpdate:i}}zw.$$tippy=!0;var ED=1,zu=[],gh=[];function CD(t,e){var n=Iw(t,Object.assign({},Zt,Dw(Mw(e)))),r,i,o,s=!1,l=!1,a=!1,u=!1,c,f,d,p=[],h=bw(_u,n.interactiveDebounce),g,y=ED++,m=null,v=iD(n.plugins),w={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},k={id:y,reference:t,popper:js(),popperInstance:m,props:n,state:w,plugins:v,clearDelayTimeouts:Vu,setProps:Uu,setContent:Wu,show:ID,hide:PD,hideWithInteractivity:LD,enable:Ks,disable:Hu,unmount:zD,destroy:BD};if(!n.render)return k;var S=n.render(k),x=S.popper,E=S.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+k.id,k.popper=x,t._tippy=k,x._tippy=k;var C=v.map(function(b){return b.fn(k)}),A=t.hasAttribute("aria-expanded");return lo(),$(),Q(),R("onCreate",[k]),n.showOnCreate&&Ws(),x.addEventListener("mouseenter",function(){k.props.interactive&&k.state.isVisible&&k.clearDelayTimeouts()}),x.addEventListener("mouseleave",function(){k.props.interactive&&k.props.trigger.indexOf("mouseenter")>=0&&Y().addEventListener("mousemove",h)}),k;function M(){var b=k.props.touch;return Array.isArray(b)?b:[b,0]}function _(){return M()[0]==="hold"}function F(){var b;return!!((b=k.props.render)!=null&&b.$$tippy)}function W(){return g||t}function Y(){var b=W().parentNode;return b?cD(b):document}function I(){return mh(x)}function J(b){return k.state.isMounted&&!k.state.isVisible||hn.isTouch||c&&c.type==="focus"?0:ch(k.props.delay,b?0:1,Zt.delay)}function Q(b){b===void 0&&(b=!1),x.style.pointerEvents=k.props.interactive&&!b?"":"none",x.style.zIndex=""+k.props.zIndex}function R(b,L,U){if(U===void 0&&(U=!0),C.forEach(function(te){te[b]&&te[b].apply(te,L)}),U){var oe;(oe=k.props)[b].apply(oe,L)}}function z(){var b=k.props.aria;if(b.content){var L="aria-"+b.content,U=x.id,oe=oo(k.props.triggerTarget||t);oe.forEach(function(te){var lt=te.getAttribute(L);if(k.state.isVisible)te.setAttribute(L,lt?lt+" "+U:U);else{var Ht=lt&&lt.replace(U,"").trim();Ht?te.setAttribute(L,Ht):te.removeAttribute(L)}})}}function $(){if(!(A||!k.props.aria.expanded)){var b=oo(k.props.triggerTarget||t);b.forEach(function(L){k.props.interactive?L.setAttribute("aria-expanded",k.state.isVisible&&L===W()?"true":"false"):L.removeAttribute("aria-expanded")})}}function X(){Y().removeEventListener("mousemove",h),zu=zu.filter(function(b){return b!==h})}function Z(b){if(!(hn.isTouch&&(a||b.type==="mousedown"))){var L=b.composedPath&&b.composedPath()[0]||b.target;if(!(k.props.interactive&&Ow(x,L))){if(oo(k.props.triggerTarget||t).some(function(U){return Ow(U,L)})){if(hn.isTouch||k.state.isVisible&&k.props.trigger.indexOf("click")>=0)return}else R("onClickOutside",[k,b]);k.props.hideOnClick===!0&&(k.clearDelayTimeouts(),k.hide(),l=!0,setTimeout(function(){l=!1}),k.state.isMounted||Ae())}}}function Ze(){a=!0}function he(){a=!1}function Be(){var b=Y();b.addEventListener("mousedown",Z,!0),b.addEventListener("touchend",Z,si),b.addEventListener("touchstart",he,si),b.addEventListener("touchmove",Ze,si)}function Ae(){var b=Y();b.removeEventListener("mousedown",Z,!0),b.removeEventListener("touchend",Z,si),b.removeEventListener("touchstart",he,si),b.removeEventListener("touchmove",Ze,si)}function en(b,L){so(b,function(){!k.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&L()})}function Ln(b,L){so(b,L)}function so(b,L){var U=I().box;function oe(te){te.target===U&&(ph(U,"remove",oe),L())}if(b===0)return L();ph(U,"remove",f),ph(U,"add",oe),f=oe}function Er(b,L,U){U===void 0&&(U=!1);var oe=oo(k.props.triggerTarget||t);oe.forEach(function(te){te.addEventListener(b,L,U),p.push({node:te,eventType:b,handler:L,options:U})})}function lo(){_()&&(Er("touchstart",Hs,{passive:!0}),Er("touchend",$u,{passive:!0})),rD(k.props.trigger).forEach(function(b){if(b!=="manual")switch(Er(b,Hs),b){case"mouseenter":Er("mouseleave",$u);break;case"focus":Er(gD?"focusout":"blur",Vs);break;case"focusin":Er("focusout",Vs);break}})}function Bu(){p.forEach(function(b){var L=b.node,U=b.eventType,oe=b.handler,te=b.options;L.removeEventListener(U,oe,te)}),p=[]}function Hs(b){var L,U=!1;if(!(!k.state.isEnabled||Us(b)||l)){var oe=((L=c)==null?void 0:L.type)==="focus";c=b,g=b.currentTarget,$(),!k.state.isVisible&&lD(b)&&zu.forEach(function(te){return te(b)}),b.type==="click"&&(k.props.trigger.indexOf("mouseenter")<0||s)&&k.props.hideOnClick!==!1&&k.state.isVisible?U=!0:Ws(b),b.type==="click"&&(s=!U),U&&!oe&&li(b)}}function _u(b){var L=b.target,U=W().contains(L)||x.contains(L);if(!(b.type==="mousemove"&&U)){var oe=Cr().concat(x).map(function(te){var lt,Ht=te._tippy,ao=(lt=Ht.popperInstance)==null?void 0:lt.state;return ao?{popperRect:te.getBoundingClientRect(),popperState:ao,props:n}:null}).filter(Boolean);fD(oe,b)&&(X(),li(b))}}function $u(b){var L=Us(b)||k.props.trigger.indexOf("click")>=0&&s;if(!L){if(k.props.interactive){k.hideWithInteractivity(b);return}li(b)}}function Vs(b){k.props.trigger.indexOf("focusin")<0&&b.target!==W()||k.props.interactive&&b.relatedTarget&&x.contains(b.relatedTarget)||li(b)}function Us(b){return hn.isTouch?_()!==b.type.indexOf("touch")>=0:!1}function ju(){Fu();var b=k.props,L=b.popperOptions,U=b.placement,oe=b.offset,te=b.getReferenceClientRect,lt=b.moveTransition,Ht=F()?mh(x).arrow:null,ao=te?{getBoundingClientRect:te,contextElement:te.contextElement||W()}:t,$w={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ku){var uo=Ku.state;if(F()){var _D=I(),vh=_D.box;["placement","reference-hidden","escaped"].forEach(function(qu){qu==="placement"?vh.setAttribute("data-placement",uo.placement):uo.attributes.popper["data-popper-"+qu]?vh.setAttribute("data-"+qu,""):vh.removeAttribute("data-"+qu)}),uo.attributes.popper={}}}},ai=[{name:"offset",options:{offset:oe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!lt}},$w];F()&&Ht&&ai.push({name:"arrow",options:{element:Ht,padding:3}}),ai.push.apply(ai,(L==null?void 0:L.modifiers)||[]),k.popperInstance=eD(ao,x,Object.assign({},L,{placement:U,onFirstUpdate:d,modifiers:ai}))}function Fu(){k.popperInstance&&(k.popperInstance.destroy(),k.popperInstance=null)}function zn(){var b=k.props.appendTo,L,U=W();k.props.interactive&&b===Ew||b==="parent"?L=U.parentNode:L=Cw(b,[U]),L.contains(x)||L.appendChild(x),k.state.isMounted=!0,ju()}function Cr(){return Pu(x.querySelectorAll("[data-tippy-root]"))}function Ws(b){k.clearDelayTimeouts(),b&&R("onTrigger",[k,b]),Be();var L=J(!0),U=M(),oe=U[0],te=U[1];hn.isTouch&&oe==="hold"&&te&&(L=te),L?r=setTimeout(function(){k.show()},L):k.show()}function li(b){if(k.clearDelayTimeouts(),R("onUntrigger",[k,b]),!k.state.isVisible){Ae();return}if(!(k.props.trigger.indexOf("mouseenter")>=0&&k.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(b.type)>=0&&s)){var L=J(!1);L?i=setTimeout(function(){k.state.isVisible&&k.hide()},L):o=requestAnimationFrame(function(){k.hide()})}}function Ks(){k.state.isEnabled=!0}function Hu(){k.hide(),k.state.isEnabled=!1}function Vu(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Uu(b){if(!k.state.isDestroyed){R("onBeforeUpdate",[k,b]),Bu();var L=k.props,U=Iw(t,Object.assign({},L,Mw(b),{ignoreAttributes:!0}));k.props=U,lo(),L.interactiveDebounce!==U.interactiveDebounce&&(X(),h=bw(_u,U.interactiveDebounce)),L.triggerTarget&&!U.triggerTarget?oo(L.triggerTarget).forEach(function(oe){oe.removeAttribute("aria-expanded")}):U.triggerTarget&&t.removeAttribute("aria-expanded"),$(),Q(),E&&E(L,U),k.popperInstance&&(ju(),Cr().forEach(function(oe){requestAnimationFrame(oe._tippy.popperInstance.forceUpdate)})),R("onAfterUpdate",[k,b])}}function Wu(b){k.setProps({content:b})}function ID(){var b=k.state.isVisible,L=k.state.isDestroyed,U=!k.state.isEnabled,oe=hn.isTouch&&!k.props.touch,te=ch(k.props.duration,0,Zt.duration);if(!(b||L||U||oe)&&!W().hasAttribute("disabled")&&(R("onShow",[k],!1),k.props.onShow(k)!==!1)){if(k.state.isVisible=!0,F()&&(x.style.visibility="visible"),Q(),Be(),k.state.isMounted||(x.style.transition="none"),F()){var lt=I(),Ht=lt.box,ao=lt.content;dh([Ht,ao],0)}d=function(){var ai;if(!(!k.state.isVisible||u)){if(u=!0,x.offsetHeight,x.style.transition=k.props.moveTransition,F()&&k.props.animation){var yh=I(),Ku=yh.box,uo=yh.content;dh([Ku,uo],te),Nw([Ku,uo],"visible")}z(),$(),Tw(gh,k),(ai=k.popperInstance)==null||ai.forceUpdate(),R("onMount",[k]),k.props.animation&&F()&&Ln(te,function(){k.state.isShown=!0,R("onShown",[k])})}},zn()}}function PD(){var b=!k.state.isVisible,L=k.state.isDestroyed,U=!k.state.isEnabled,oe=ch(k.props.duration,1,Zt.duration);if(!(b||L||U)&&(R("onHide",[k],!1),k.props.onHide(k)!==!1)){if(k.state.isVisible=!1,k.state.isShown=!1,u=!1,s=!1,F()&&(x.style.visibility="hidden"),X(),Ae(),Q(!0),F()){var te=I(),lt=te.box,Ht=te.content;k.props.animation&&(dh([lt,Ht],oe),Nw([lt,Ht],"hidden"))}z(),$(),k.props.animation?F()&&en(oe,k.unmount):k.unmount()}}function LD(b){Y().addEventListener("mousemove",h),Tw(zu,h),h(b)}function zD(){k.state.isVisible&&k.hide(),k.state.isMounted&&(Fu(),Cr().forEach(function(b){b._tippy.unmount()}),x.parentNode&&x.parentNode.removeChild(x),gh=gh.filter(function(b){return b!==k}),k.state.isMounted=!1,R("onHidden",[k]))}function BD(){k.state.isDestroyed||(k.clearDelayTimeouts(),k.unmount(),Bu(),delete t._tippy,k.state.isDestroyed=!0,R("onDestroy",[k]))}}function Fs(t,e){e===void 0&&(e={});var n=Zt.plugins.concat(e.plugins||[]);hD();var r=Object.assign({},e,{plugins:n}),i=uD(t),o=i.reduce(function(s,l){var a=l&&CD(l,r);return a&&s.push(a),s},[]);return Lu(t)?o[0]:o}Fs.defaultProps=Zt,Fs.setDefaultProps=wD,Fs.currentInput=hn,Object.assign({},iw,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}}),Fs.setDefaultProps({render:zw});const bD=async t=>{const e=new FormData;e.append("image",t);try{const r=await(await fetch("/admin/api/upload",{method:"POST",body:e})).json();if(r.success&&r.file&&r.file.url)return r.file.url;throw new Error(r.error||"Upload failed")}catch(n){return console.error("Image upload error:",n),null}},TD=(t,e)=>{const n=document.createElement("input");n.type="file",n.accept="image/*",n.onchange=async r=>{var o;const i=(o=r.target.files)==null?void 0:o[0];if(i){const s=await bD(i);s&&t.chain().focus().deleteRange(e).setImage({src:s}).run()}},n.click()},MD=[{title:"Text",subtext:"Just start with plain text",icon:W2,group:"Format",aliases:["text","paragraph","p"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setParagraph().run()}},{title:"Heading 1",subtext:"Big section heading",icon:Xk,group:"Format",aliases:["h1","heading1","title"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:1}).run()}},{title:"Heading 2",subtext:"Medium section heading",icon:Zk,group:"Format",aliases:["h2","heading2","subtitle"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:2}).run()}},{title:"Heading 3",subtext:"Small section heading",icon:L2,group:"Format",aliases:["h3","heading3"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setNode("heading",{level:3}).run()}},{title:"Bullet List",subtext:"Create a simple bullet list",icon:$2,group:"Lists",aliases:["ul","unordered","bullet"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleBulletList().run()}},{title:"Numbered List",subtext:"Create a numbered list",icon:_2,group:"Lists",aliases:["ol","ordered","numbered"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleOrderedList().run()}},{title:"Quote",subtext:"Capture a quote",icon:H2,group:"Blocks",aliases:["blockquote","quote"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleBlockquote().run()}},{title:"Code Block",subtext:"Add code with syntax highlighting",icon:Yk,group:"Blocks",aliases:["code","codeblock","pre"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).toggleCodeBlock().run()}},{title:"Divider",subtext:"Visual separator line",icon:j2,group:"Blocks",aliases:["hr","divider","line"],command:({editor:t,range:e})=>{t.chain().focus().deleteRange(e).setHorizontalRule().run()}},{title:"Upload Image",subtext:"Upload from your computer",icon:z2,group:"Media",aliases:["image","upload","photo","picture"],command:({editor:t,range:e})=>{TD(t,e)}},{title:"Image from URL",subtext:"Embed with a link",icon:ew,group:"Media",aliases:["embed","url","link","img"],command:({editor:t,range:e})=>{const n=window.prompt("Enter image URL");n&&t.chain().focus().deleteRange(e).setImage({src:n}).run()}}],ND=(t,e)=>{if(!e)return t;const n=e.toLowerCase();return t.filter(r=>{var i;return r.title.toLowerCase().includes(n)||((i=r.aliases)==null?void 0:i.some(o=>o.toLowerCase().includes(n)))})},Bw=tt.forwardRef((t,e)=>{const[n,r]=ne.useState(0),i=ne.useRef(null),o=t.items||[],s=ne.useCallback(u=>{const c=o[u];c&&t.command(c)},[o,t]);if(ne.useEffect(()=>{r(0)},[o]),ne.useEffect(()=>{if(i.current){const u=i.current.querySelector(`[data-index="${n}"]`);u&&u.scrollIntoView({block:"nearest"})}},[n]),tt.useImperativeHandle(e,()=>({onKeyDown:({event:u})=>u.key==="ArrowUp"?(r(c=>(c+o.length-1)%o.length),!0):u.key==="ArrowDown"?(r(c=>(c+1)%o.length),!0):u.key==="Enter"?(s(n),!0):!1})),!o.length)return H.jsx("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 p-3 text-sm text-gray-500",children:"No results found"});const l=o.reduce((u,c,f)=>{const d=c.group||"Other";return u[d]||(u[d]=[]),u[d].push({...c,originalIndex:f}),u},{});let a=0;return H.jsx("div",{ref:i,className:"bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden max-h-80 overflow-y-auto min-w-[280px]",children:Object.entries(l).map(([u,c])=>H.jsxs("div",{children:[H.jsx("div",{className:"px-3 py-1.5 text-[10px] font-semibold text-gray-400 uppercase tracking-wider bg-gray-50 border-b border-gray-100",children:u}),c.map(f=>{const d=a++,p=f.icon;return H.jsxs("button",{"data-index":d,onClick:()=>s(d),className:`w-full flex items-center gap-3 px-3 py-2 text-left transition-colors ${d===n?"bg-indigo-50 text-indigo-700":"text-gray-700 hover:bg-gray-50"}`,children:[H.jsx("div",{className:`p-1.5 rounded ${d===n?"bg-indigo-100":"bg-gray-100"}`,children:H.jsx(p,{className:"w-4 h-4"})}),H.jsxs("div",{className:"flex-1 min-w-0",children:[H.jsx("div",{className:"text-sm font-medium",children:f.title}),H.jsx("div",{className:"text-xs text-gray-400 truncate",children:f.subtext})]})]},f.title)})]},u))})});Bw.displayName="SlashMenuList";const OD=ke.create({name:"slashDropdownMenu",addOptions(){return{suggestion:{char:"/",allowSpaces:!1,startOfLine:!1,items:({query:t})=>ND(MD,t),command:({editor:t,range:e,props:n})=>{n.command({editor:t,range:e})},render:()=>{let t,e;return{onStart:n=>{t=new KO(Bw,{props:n,editor:n.editor}),n.clientRect&&(e=Fs("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:["top-start"]}},{name:"preventOverflow",options:{padding:8}}]}}))},onUpdate(n){var r;t==null||t.updateProps(n),n.clientRect&&((r=e==null?void 0:e[0])==null||r.setProps({getReferenceClientRect:n.clientRect}))},onKeyDown(n){var r,i;return n.event.key==="Escape"?((r=e==null?void 0:e[0])==null||r.hide(),!0):((i=t==null?void 0:t.ref)==null?void 0:i.onKeyDown(n))??!1},onExit(){var n;(n=e==null?void 0:e[0])==null||n.destroy(),t==null||t.destroy()}}}}}},addProseMirrorPlugins(){return[Q2({editor:this.editor,...this.options.suggestion})]}}),AD=({editor:t})=>{const[e,n]=ne.useState(null),[r,i]=ne.useState(!1),o=ne.useCallback(()=>{if(!t)return;const{from:u}=t.state.selection;try{const c=t.view.domAtPos(u),f=c.node instanceof HTMLElement?c.node:c.node.parentElement,d=f==null?void 0:f.closest(".ProseMirror > *");if(d){const p=d.getBoundingClientRect(),h=t.view.dom.getBoundingClientRect();n({top:p.top-h.top+2,height:p.height})}else n(null)}catch{n(null)}},[t]);if(ne.useEffect(()=>{if(!t)return;t.on("selectionUpdate",o),t.on("update",o),t.on("focus",o);const u=setTimeout(o,100);return()=>{clearTimeout(u),t.off("selectionUpdate",o),t.off("update",o),t.off("focus",o)}},[t,o]),ne.useEffect(()=>{if(!t)return;const u=t.view.dom,c=d=>{const h=document.elementsFromPoint(d.clientX,d.clientY).find(g=>g.matches(".ProseMirror > *"));if(h){const g=h.getBoundingClientRect(),y=u.getBoundingClientRect();n({top:g.top-y.top+2,height:g.height}),i(!0)}},f=()=>{i(!1),o()};return u.addEventListener("mousemove",c),u.addEventListener("mouseleave",f),()=>{u.removeEventListener("mousemove",c),u.removeEventListener("mouseleave",f)}},[t,o]),!e)return null;const s=()=>{const{from:u}=t.state.selection,c=t.state.doc.resolve(u);if(c.depth>0){const f=c.before(1),d=c.after(1);t.chain().focus().setTextSelection({from:f,to:d}).run()}},l=()=>{const{from:u}=t.state.selection,c=t.state.doc.resolve(u);if(c.depth>0){const f=c.after(1);t.chain().focus().insertContentAt(f,{type:"paragraph"}).setTextSelection(f+1).run()}},a=()=>{const{from:u}=t.state.selection,c=t.state.doc.resolve(u);if(c.depth>0){const f=c.before(1),d=c.after(1);t.chain().focus().deleteRange({from:f,to:d}).run()}};return H.jsxs("div",{className:"absolute flex items-center gap-1 transition-opacity duration-150",style:{top:e.top,left:-60,opacity:r?1:.6,zIndex:40},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[H.jsx("button",{className:"p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-all duration-150",onClick:l,title:"Add block below",children:H.jsx(F2,{className:"w-5 h-5"})}),H.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-700 hover:bg-gray-100 rounded-md cursor-grab transition-all duration-150 active:cursor-grabbing",onClick:s,onMouseDown:u=>{s()},title:"Click to select block, then Ctrl+X to cut",children:H.jsx(P2,{className:"w-5 h-5"})}),H.jsx("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-all duration-150",onClick:a,title:"Delete block",children:H.jsx(U2,{className:"w-4 h-4"})})]})},RD=({editor:t,children:e,className:n})=>{const[r,i]=tt.useState(!1),[o,s]=tt.useState({top:0,left:0}),l=tt.useRef(null);return tt.useEffect(()=>{if(!t)return;const a=()=>{const{from:u,to:c,empty:f}=t.state.selection;if(f){i(!1);return}try{const d=t.view.coordsAtPos(u),p=t.view.dom.getBoundingClientRect();s({top:d.top-p.top-45,left:d.left-p.left}),i(!0)}catch{i(!1)}};return t.on("selectionUpdate",a),t.on("transaction",a),()=>{t.off("selectionUpdate",a),t.off("transaction",a)}},[t]),r?H.jsx("div",{ref:l,className:n,style:{position:"absolute",top:o.top,left:o.left,zIndex:50},children:e}):null},DD=({content:t=""})=>{const e=async r=>{const i=new FormData;i.append("image",r);try{const s=await(await fetch("/admin/api/upload",{method:"POST",body:i})).json();if(s.success&&s.file&&s.file.url)return s.file.url;throw new Error(s.error||"Upload failed")}catch(o){return console.error("Image upload error:",o),null}},n=$O({extensions:[M2,A2.configure({inline:!0,allowBase64:!0}),$A.configure({openOnClick:!1}),OD],content:t,editorProps:{attributes:{class:"prose prose-xl max-w-none focus:outline-none min-h-[1000px] p-16"},handleDrop:(r,i,o,s)=>{if(!s&&i.dataTransfer&&i.dataTransfer.files&&i.dataTransfer.files[0]){const l=i.dataTransfer.files[0];if(l.type.startsWith("image/"))return e(l).then(a=>{if(a){const{schema:u}=r.state,c=r.posAtCoords({left:i.clientX,top:i.clientY}),f=u.nodes.image.create({src:a}),d=r.state.tr.insert(c.pos,f);r.dispatch(d)}}),!0}return!1},handlePaste:(r,i,o)=>{const s=(i.clipboardData||i.originalEvent.clipboardData).items;for(const l of s)if(l.type.indexOf("image")===0){const a=l.getAsFile();return e(a).then(u=>{if(u){const c=r.state.tr.replaceSelectionWith(r.state.schema.nodes.image.create({src:u}));r.dispatch(c)}}),!0}return!1}},onUpdate:({editor:r})=>{window.zero_editor_content=r.getJSON()}});return tt.useEffect(()=>{n&&(window.editor=n)},[n]),n?H.jsx("div",{className:"w-full min-h-[80vh] flex flex-col group",children:H.jsxs("div",{className:"relative mx-auto w-full max-w-[1000px]",children:[H.jsx(AD,{editor:n}),H.jsxs("div",{className:"bg-white shadow-lg min-h-[1100px] my-8",children:[H.jsx(DO,{editor:n}),H.jsxs(RD,{editor:n,className:"flex overflow-hidden rounded-lg border border-gray-200 bg-white shadow-xl",children:[H.jsx("button",{onClick:()=>n.chain().focus().toggleBold().run(),className:`p-2 hover:bg-gray-100 ${n.isActive("bold")?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Bold",children:H.jsx(I2,{className:"w-4 h-4"})}),H.jsx("button",{onClick:()=>n.chain().focus().toggleItalic().run(),className:`p-2 hover:bg-gray-100 ${n.isActive("italic")?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Italic",children:H.jsx(B2,{className:"w-4 h-4"})}),H.jsx("button",{onClick:()=>n.chain().focus().toggleStrike().run(),className:`p-2 hover:bg-gray-100 ${n.isActive("strike")?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Strikethrough",children:H.jsx(V2,{className:"w-4 h-4"})}),H.jsx("button",{onClick:()=>n.chain().focus().toggleCode().run(),className:`p-2 hover:bg-gray-100 ${n.isActive("code")?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Code",children:H.jsx(Yk,{className:"w-4 h-4"})}),H.jsx("button",{onClick:()=>{const r=window.prompt("Enter URL");r&&n.chain().focus().setLink({href:r}).run()},className:`p-2 hover:bg-gray-100 ${n.isActive("link")?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Link",children:H.jsx(ew,{className:"w-4 h-4"})}),H.jsx("div",{className:"w-px bg-gray-200 mx-1"}),H.jsx("button",{onClick:()=>n.chain().focus().toggleHeading({level:1}).run(),className:`p-2 hover:bg-gray-100 ${n.isActive("heading",{level:1})?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Heading 1",children:H.jsx(Xk,{className:"w-4 h-4"})}),H.jsx("button",{onClick:()=>n.chain().focus().toggleHeading({level:2}).run(),className:`p-2 hover:bg-gray-100 ${n.isActive("heading",{level:2})?"text-blue-600 bg-gray-50":"text-gray-600"}`,title:"Heading 2",children:H.jsx(Zk,{className:"w-4 h-4"})})]})]})]})}):null},_w=document.getElementById("tiptap-editor");if(_w){let t=window.ZERO_INITIAL_CONTENT||null;if(t&&typeof t=="object")t.type!=="doc"&&(console.warn("Content is not in Tiptap format, starting with empty document"),t=null);else if(typeof t=="string")try{const e=JSON.parse(t);e.type==="doc"?t=e:t=null}catch{}else t=null;Zu.createRoot(_w).render(H.jsx(tt.StrictMode,{children:H.jsx(DD,{content:t})})),console.log("React Editor Mounted")}else console.error("Target container #tiptap-editor not found")})();



==================================================
FILE PATH: .\content\themes\admin-default\components\settings-card.php
==================================================

<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>CMS Settings Card</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&amp;family=Noto+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "primary": "#4f46e5","primary-hover": "#4338ca","success": "#10b981","surface-border": "#e5e7eb","text-main": "#111827","text-secondary": "#6b7280",},
            fontFamily: {
              "display": ["Space Grotesk", "sans-serif"],
              "body": ["Noto Sans", "sans-serif"],
            },
            boxShadow: {
                "card": "0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)",
            }
          },
        },
      }
    </script>
<style>
        .toggle-checkbox:checked {
            right: 0;
            border-color: #10b981;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #10b981;
        }
        .toggle-checkbox {
            appearance: none;
            -webkit-appearance: none;
            position: absolute;
            z-index: 10;
            border-radius: 9999px;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .toggle-label {
            width: 44px;
            height: 24px;
            position: relative;
            display: inline-block;
            border-radius: 9999px;
            background-color: #e5e7eb;
            transition: background-color 0.2s ease-in;
            cursor: pointer;
        }
        .toggle-label:after {
            content: "";
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #fff;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: transform 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        .toggle-checkbox:checked + .toggle-label:after {
            transform: translateX(20px);
        }
    </style>
</head>
<body class="font-body text-slate-800 bg-gray-50 min-h-screen flex items-center justify-center p-4">
<div class="w-full max-w-3xl">
<div class="mb-6 flex items-center gap-2 text-sm text-text-secondary">
<span class="material-symbols-outlined text-[18px]">settings</span>
<span>Settings</span>
<span class="material-symbols-outlined text-[14px]">chevron_right</span>
<span class="text-text-main font-medium">SEO &amp; Performance</span>
</div>
<div class="bg-white rounded-xl shadow-card border border-surface-border overflow-hidden">
<div class="px-6 py-5 border-b border-surface-border flex items-center justify-between bg-white">
<div>
<h2 class="text-xl font-bold text-text-main font-display">SEO Configuration</h2>
<p class="text-sm text-text-secondary mt-1">Manage search engine visibility and caching strategies.</p>
</div>
<button class="bg-primary hover:bg-primary-hover text-white px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 shadow-sm hover:shadow flex items-center gap-2 group">
<span class="material-symbols-outlined text-[18px] group-hover:scale-110 transition-transform">save</span>
                    Save Changes
                </button>
</div>
<div class="p-0">
<div class="grid grid-cols-1 md:grid-cols-12 gap-6 p-6 md:p-8 border-b border-surface-border items-start hover:bg-gray-50/50 transition-colors">
<div class="md:col-span-4">
<label class="block text-sm font-semibold text-text-main mb-1" for="site_title">Site Title</label>
<p class="text-xs text-text-secondary">Appears in the browser tab and search results.</p>
</div>
<div class="md:col-span-8">
<div class="relative group">
<input class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm h-11 transition-colors pl-10" id="site_title" name="site_title" type="text" value="Zero CMS - Ultimate Content Platform"/>
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400 group-focus-within:text-primary transition-colors">
<span class="material-symbols-outlined text-[20px]">title</span>
</div>
</div>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-12 gap-6 p-6 md:p-8 border-b border-surface-border items-center hover:bg-gray-50/50 transition-colors">
<div class="md:col-span-4">
<label class="block text-sm font-semibold text-text-main mb-1">Allow Search Indexing</label>
<p class="text-xs text-text-secondary">If disabled, adds 'noindex' meta tag to headers.</p>
</div>
<div class="md:col-span-8 flex items-center justify-between sm:justify-start sm:gap-4">
<div class="relative inline-block w-11 h-6 align-middle select-none">
<input checked="" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" id="toggle" name="toggle" type="checkbox"/>
<label class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer" for="toggle"></label>
</div>
<span class="text-sm font-medium text-success ml-2 flex items-center gap-1">
<span class="material-symbols-outlined text-[16px]">check_circle</span>
                            Active
                        </span>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-12 gap-6 p-6 md:p-8 items-start hover:bg-gray-50/50 transition-colors">
<div class="md:col-span-4">
<label class="block text-sm font-semibold text-text-main mb-1" for="caching_engine">Caching Engine</label>
<p class="text-xs text-text-secondary">Select the driver for content caching.</p>
</div>
<div class="md:col-span-8">
<div class="relative">
<select class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm h-11 pl-10 pr-10 appearance-none bg-white" id="caching_engine" name="caching_engine">
<option>Redis (Recommended)</option>
<option>Memcached</option>
<option>File System</option>
<option>None</option>
</select>
<div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
<span class="material-symbols-outlined text-[20px]">memory</span>
</div>
<div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none text-gray-400">
<span class="material-symbols-outlined text-[20px]">expand_more</span>
</div>
</div>
<div class="mt-3 flex items-start gap-2 p-3 bg-blue-50 text-blue-700 rounded-md text-xs border border-blue-100">
<span class="material-symbols-outlined text-[16px] mt-0.5">info</span>
<p>Changing the caching engine requires a restart of the worker process.</p>
</div>
</div>
</div>
</div>
<div class="bg-gray-50 px-6 py-4 border-t border-surface-border flex justify-between items-center text-xs text-text-secondary">
<span>Last updated: 2 mins ago</span>
<a class="text-primary hover:text-primary-hover font-medium flex items-center gap-1" href="#">
                    View Logs
                    <span class="material-symbols-outlined text-[14px]">open_in_new</span>
</a>
</div>
</div>
<div class="mt-8 text-center">
<p class="text-sm text-gray-400">Zero CMS v2.4.0 © 2023</p>
</div>
</div>

</body></html>


==================================================
FILE PATH: .\core\App.php
==================================================

<?php

declare(strict_types=1);

namespace Core;

/**
 * Zero CMS Micro-Kernel Application
 * 
 * The core application class. In a micro-kernel architecture,
 * this class does minimal work—dispatching events to addons/plugins.
 */
final class App
{
    /**
     * The singleton instance.
     */
    private static ?App $instance = null;

    /**
     * Create a new App instance.
     *
     * @param array<string, mixed> $config The application configuration.
     */
    public function __construct(
        private readonly array $config = []
    ) {
        self::$instance = $this;
    }

    /**
     * Get the application instance.
     *
     * @return self|null
     */
    public static function getInstance(): ?self
    {
        return self::$instance;
    }

    /**
     * Get a configuration value.
     *
     * @param string $key     Dot-notation key (e.g., 'database.host').
     * @param mixed  $default Default value if key not found.
     * @return mixed
     */
    public function config(string $key, mixed $default = null): mixed
    {
        $keys = explode('.', $key);
        $value = $this->config;

        foreach ($keys as $k) {
            if (!is_array($value) || !array_key_exists($k, $value)) {
                return $default;
            }
            $value = $value[$k];
        }

        return $value;
    }

    /**
     * Run the application.
     *
     * This is the entry point for the micro-kernel.
     * It bootstraps core services and dispatches control to addons.
     *
     * @return void
     */
    public function run(): void
    {
        // 1. Fire the 'app_init' event - addons can register hooks here
        Event::trigger('app_init', $this);

        // 2. Store database config for lazy initialization (only connects when needed)
        if ($dbConfig = $this->config('database')) {
            Database::setConfig($dbConfig);
        }

        // 3. Fire the 'app_ready' event - system is ready
        Event::trigger('app_ready', $this);

        // 4. Dispatch the route - let addons handle the request
        $uri = Router::getCurrentUri();
        $method = Router::getCurrentMethod();
        $response = Router::dispatch($uri, $method);

        // 5. Output the response
        if ($response !== null) {
            // Allow filtering the final output
            $response = Event::filter('app_output', $response);
            echo $response;
        }

        // 6. Fire the 'app_shutdown' event - cleanup
        Event::trigger('app_shutdown', $this);
    }
}



==================================================
FILE PATH: .\core\Auth.php
==================================================

<?php

declare(strict_types=1);

namespace Core;

/**
 * Zero CMS Authentication Handler
 * 
 * Handles user login, logout, session management, and authorization.
 */
final class Auth
{
    /**
     * Cached current user data.
     */
    private static ?array $currentUser = null;

    /**
     * Session key for storing user ID.
     */
    private const SESSION_KEY = 'zero_user_id';

    /**
     * Ensure session is started.
     */
    private static function ensureSession(): void
    {
        if (session_status() === PHP_SESSION_NONE) {
            session_start();
        }
    }

    /**
     * Attempt to log in a user.
     *
     * @param string $email    User's email address.
     * @param string $password User's password (plain text).
     * @return bool True if login successful, false otherwise.
     */
    public static function login(string $email, string $password): bool
    {
        self::ensureSession();

        try {
            $db = Database::getInstance();
            
            // Find user by email
            $user = $db->queryOne(
                "SELECT id, email, password_hash, role FROM users WHERE email = :email LIMIT 1",
                ['email' => $email]
            );

            // Check if user exists and password matches
            if ($user && password_verify($password, $user['password_hash'])) {
                // Set session
                $_SESSION[self::SESSION_KEY] = (int) $user['id'];
                self::$currentUser = $user;

                // Regenerate session ID for security
                session_regenerate_id(true);

                return true;
            }

            return false;

        } catch (\Exception $e) {
            // Log error in production
            return false;
        }
    }

    /**
     * Log out the current user.
     *
     * @return void
     */
    public static function logout(): void
    {
        self::ensureSession();

        // Clear user from session
        unset($_SESSION[self::SESSION_KEY]);
        self::$currentUser = null;

        // Destroy session completely
        session_destroy();

        // Start a new session for flash messages, etc.
        session_start();
        session_regenerate_id(true);
    }

    /**
     * Check if a user is currently logged in.
     *
     * @return bool True if logged in, false otherwise.
     */
    public static function check(): bool
    {
        self::ensureSession();

        return isset($_SESSION[self::SESSION_KEY]) && $_SESSION[self::SESSION_KEY] > 0;
    }

    /**
     * Get the current logged-in user's data.
     *
     * @return array|null User data array or null if not logged in.
     */
    public static function user(): ?array
    {
        if (!self::check()) {
            return null;
        }

        // Return cached user if available
        if (self::$currentUser !== null) {
            return self::$currentUser;
        }

        try {
            $db = Database::getInstance();
            
            $user = $db->queryOne(
                "SELECT id, email, role, created_at, updated_at FROM users WHERE id = :id LIMIT 1",
                ['id' => $_SESSION[self::SESSION_KEY]]
            );

            if ($user) {
                self::$currentUser = $user;
                return $user;
            }

            // User not found in DB, clear invalid session
            self::logout();
            return null;

        } catch (\Exception $e) {
            return null;
        }
    }

    /**
     * Get the current user's ID.
     *
     * @return int|null User ID or null if not logged in.
     */
    public static function id(): ?int
    {
        self::ensureSession();

        return isset($_SESSION[self::SESSION_KEY]) 
            ? (int) $_SESSION[self::SESSION_KEY] 
            : null;
    }

    /**
     * Check if the current user has a specific role.
     *
     * @param string $role Role to check for.
     * @return bool True if user has the role.
     */
    public static function hasRole(string $role): bool
    {
        $user = self::user();
        return $user !== null && ($user['role'] ?? '') === $role;
    }

    /**
     * Check if the current user is an admin.
     *
     * @return bool True if user is admin.
     */
    public static function isAdmin(): bool
    {
        return self::hasRole('admin');
    }

    /**
     * Require authentication - redirects if not logged in.
     *
     * @param string $redirectTo URL to redirect to if not authenticated.
     * @return void
     */
    public static function require(string $redirectTo = '/admin/login'): void
    {
        if (!self::check()) {
            header("Location: {$redirectTo}");
            exit;
        }
    }

    /**
     * Require a specific role - redirects if not authorized.
     *
     * @param string $role       Required role.
     * @param string $redirectTo URL to redirect to if not authorized.
     * @return void
     */
    public static function requireRole(string $role, string $redirectTo = '/admin/login'): void
    {
        self::require($redirectTo);

        if (!self::hasRole($role)) {
            header("Location: {$redirectTo}");
            exit;
        }
    }
}



==================================================
FILE PATH: .\core\Database.php
==================================================

<?php

declare(strict_types=1);

namespace Core;

use PDO;
use PDOException;
use PDOStatement;

/**
 * Zero CMS Database Wrapper (The Schemaless Engine)
 * 
 * A singleton PDO wrapper with JSON column support.
 * Optimized for a "schemaless" design where we heavily use JSON columns.
 */
final class Database
{
    /**
     * The singleton instance.
     */
    private static ?Database $instance = null;

    /**
     * Stored configuration for lazy initialization.
     *
     * @var array<string, mixed>|null
     */
    private static ?array $storedConfig = null;

    /**
     * The PDO connection.
     */
    private PDO $pdo;

    /**
     * Query log for debugging.
     *
     * @var array<array{sql: string, params: array, time: float}>
     */
    private array $queryLog = [];

    /**
     * Whether to log queries (debug mode).
     */
    private bool $logging = false;

    /**
     * Private constructor - use getInstance() instead.
     *
     * @param array<string, mixed> $config Database configuration.
     */
    private function __construct(array $config)
    {
        $host = $config['host'] ?? 'localhost';
        $port = $config['port'] ?? 3306;
        $name = $config['name'] ?? 'zero_cms';
        $user = $config['user'] ?? 'root';
        $pass = $config['password'] ?? '';
        $charset = $config['charset'] ?? 'utf8mb4';

        $dsn = "mysql:host={$host};port={$port};dbname={$name};charset={$charset}";

        try {
            $this->pdo = new PDO($dsn, $user, $pass, [
                // Throw exceptions on errors
                PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
                // Return associative arrays by default
                PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                // Don't emulate prepared statements (more secure)
                PDO::ATTR_EMULATE_PREPARES   => false,
                // Use persistent connections for performance
                PDO::ATTR_PERSISTENT         => true,
            ]);
        } catch (PDOException $e) {
            throw new PDOException(
                "Database connection failed: " . $e->getMessage(),
                (int) $e->getCode(),
                $e
            );
        }
    }

    /**
     * Prevent cloning of the singleton.
     */
    private function __clone(): void {}

    /**
     * Prevent unserialization of the singleton.
     */
    public function __wakeup(): void
    {
        throw new \Exception("Cannot unserialize a singleton.");
    }

    /**
     * Store database configuration for lazy initialization.
     * The connection will only be established when getInstance() is called.
     *
     * @param array<string, mixed> $config Database configuration.
     * @return void
     */
    public static function setConfig(array $config): void
    {
        self::$storedConfig = $config;
    }

    /**
     * Get the singleton database instance.
     * If config was set via setConfig(), uses that config.
     *
     * @param array<string, mixed>|null $config Database config (only used on first call).
     * @return self The database instance.
     */
    public static function getInstance(?array $config = null): self
    {
        if (self::$instance === null) {
            // Use provided config, or fall back to stored config
            $config = $config ?? self::$storedConfig;
            
            if ($config === null) {
                throw new \RuntimeException(
                    "Database not initialized. Call setConfig() or getInstance() with config first."
                );
            }
            self::$instance = new self($config);
        }

        return self::$instance;
    }

    /**
     * Get the raw PDO instance (for advanced usage).
     *
     * @return PDO The PDO connection.
     */
    public function getPdo(): PDO
    {
        return $this->pdo;
    }

    /**
     * Execute a query and return the result.
     * 
     * For SELECT queries, returns an array of rows.
     * For INSERT, returns the last insert ID.
     * For UPDATE/DELETE, returns the number of affected rows.
     *
     * @param string               $sql    The SQL query with placeholders.
     * @param array<string, mixed> $params Parameters for prepared statement.
     * @return array|int|string Query result.
     */
    public function query(string $sql, array $params = []): array|int|string
    {
        $startTime = microtime(true);

        $stmt = $this->pdo->prepare($sql);
        $stmt->execute($params);

        // Log query if logging is enabled
        if ($this->logging) {
            $this->queryLog[] = [
                'sql'    => $sql,
                'params' => $params,
                'time'   => microtime(true) - $startTime,
            ];
        }

        // Determine what to return based on query type
        $sqlType = strtoupper(substr(ltrim($sql), 0, 6));

        return match ($sqlType) {
            'SELECT', 'SHOW  ', 'DESCRI' => $stmt->fetchAll(),
            'INSERT' => $this->pdo->lastInsertId(),
            default  => $stmt->rowCount(),
        };
    }

    /**
     * Execute a query and return a single row.
     *
     * @param string               $sql    The SQL query.
     * @param array<string, mixed> $params Parameters for prepared statement.
     * @return array|null Single row or null if not found.
     */
    public function queryOne(string $sql, array $params = []): ?array
    {
        $stmt = $this->pdo->prepare($sql);
        $stmt->execute($params);
        $result = $stmt->fetch();

        return $result === false ? null : $result;
    }

    /**
     * Execute a query and return a single value.
     *
     * @param string               $sql    The SQL query.
     * @param array<string, mixed> $params Parameters for prepared statement.
     * @return mixed The single value or null.
     */
    public function queryValue(string $sql, array $params = []): mixed
    {
        $stmt = $this->pdo->prepare($sql);
        $stmt->execute($params);
        
        return $stmt->fetchColumn();
    }

    /**
     * Insert a row with JSON column support.
     * 
     * Automatically converts arrays to JSON strings.
     *
     * @param string               $table The table name.
     * @param array<string, mixed> $data  Column => value pairs (arrays become JSON).
     * @return string The last insert ID.
     */
    public function insert(string $table, array $data): string
    {
        $data = $this->prepareJsonData($data);

        $columns = implode(', ', array_keys($data));
        $placeholders = implode(', ', array_map(fn($k) => ":{$k}", array_keys($data)));

        $sql = "INSERT INTO {$table} ({$columns}) VALUES ({$placeholders})";

        $this->query($sql, $data);

        return $this->pdo->lastInsertId();
    }

    /**
     * Update rows with JSON column support.
     *
     * @param string               $table The table name.
     * @param array<string, mixed> $data  Column => value pairs to update.
     * @param string               $where WHERE clause (without "WHERE").
     * @param array<string, mixed> $whereParams Parameters for WHERE clause.
     * @return int Number of affected rows.
     */
    public function update(string $table, array $data, string $where, array $whereParams = []): int
    {
        $data = $this->prepareJsonData($data);

        $setParts = [];
        foreach ($data as $column => $value) {
            $setParts[] = "{$column} = :set_{$column}";
        }
        $setClause = implode(', ', $setParts);

        $sql = "UPDATE {$table} SET {$setClause} WHERE {$where}";

        // Prefix data keys to avoid collision with where params
        $params = [];
        foreach ($data as $k => $v) {
            $params["set_{$k}"] = $v;
        }
        $params = array_merge($params, $whereParams);

        return (int) $this->query($sql, $params);
    }

    /**
     * Delete rows from a table.
     *
     * @param string               $table The table name.
     * @param string               $where WHERE clause (without "WHERE").
     * @param array<string, mixed> $params Parameters for WHERE clause.
     * @return int Number of deleted rows.
     */
    public function delete(string $table, string $where, array $params = []): int
    {
        $sql = "DELETE FROM {$table} WHERE {$where}";
        return (int) $this->query($sql, $params);
    }

    /**
     * Insert a PHP array as a JSON column value.
     * 
     * Convenience method for working with JSON columns.
     *
     * @param string               $table  The table name.
     * @param string               $column The JSON column name.
     * @param array<mixed>         $data   The array to store as JSON.
     * @param string               $where  WHERE clause for existing row.
     * @param array<string, mixed> $whereParams Parameters for WHERE.
     * @return int Affected rows (for update).
     */
    public function json(string $table, string $column, array $data, string $where, array $whereParams = []): int
    {
        return $this->update(
            $table,
            [$column => $data],
            $where,
            $whereParams
        );
    }

    /**
     * Read and decode a JSON column.
     *
     * @param string               $table  The table name.
     * @param string               $column The JSON column name.
     * @param string               $where  WHERE clause.
     * @param array<string, mixed> $params WHERE parameters.
     * @return array<mixed>|null The decoded array or null.
     */
    public function jsonGet(string $table, string $column, string $where, array $params = []): ?array
    {
        $sql = "SELECT {$column} FROM {$table} WHERE {$where} LIMIT 1";
        $result = $this->queryValue($sql, $params);

        if ($result === null || $result === false) {
            return null;
        }

        $decoded = json_decode($result, true);
        return is_array($decoded) ? $decoded : null;
    }

    /**
     * Merge data into an existing JSON column.
     * 
     * Uses MySQL's JSON_MERGE_PATCH for atomic updates.
     *
     * @param string               $table  The table name.
     * @param string               $column The JSON column name.
     * @param array<mixed>         $data   Data to merge into the JSON.
     * @param string               $where  WHERE clause.
     * @param array<string, mixed> $whereParams WHERE parameters.
     * @return int Affected rows.
     */
    public function jsonMerge(string $table, string $column, array $data, string $where, array $whereParams = []): int
    {
        $jsonData = json_encode($data, JSON_THROW_ON_ERROR);

        $sql = "UPDATE {$table} SET {$column} = JSON_MERGE_PATCH(COALESCE({$column}, '{}'), :json_data) WHERE {$where}";

        $params = array_merge(['json_data' => $jsonData], $whereParams);

        return (int) $this->query($sql, $params);
    }

    /**
     * Prepare data for insertion, converting arrays to JSON.
     *
     * @param array<string, mixed> $data The data to prepare.
     * @return array<string, mixed> Prepared data with JSON strings.
     */
    private function prepareJsonData(array $data): array
    {
        foreach ($data as $key => $value) {
            if (is_array($value)) {
                $data[$key] = json_encode($value, JSON_THROW_ON_ERROR);
            }
        }
        return $data;
    }

    /**
     * Begin a transaction.
     *
     * @return bool True on success.
     */
    public function beginTransaction(): bool
    {
        return $this->pdo->beginTransaction();
    }

    /**
     * Commit a transaction.
     *
     * @return bool True on success.
     */
    public function commit(): bool
    {
        return $this->pdo->commit();
    }

    /**
     * Rollback a transaction.
     *
     * @return bool True on success.
     */
    public function rollback(): bool
    {
        return $this->pdo->rollBack();
    }

    /**
     * Execute a callback within a transaction.
     *
     * @param callable $callback The callback to execute.
     * @return mixed The callback's return value.
     * @throws \Throwable Re-throws any exception after rollback.
     */
    public function transaction(callable $callback): mixed
    {
        $this->beginTransaction();

        try {
            $result = $callback($this);
            $this->commit();
            return $result;
        } catch (\Throwable $e) {
            $this->rollback();
            throw $e;
        }
    }

    /**
     * Enable or disable query logging.
     *
     * @param bool $enable True to enable, false to disable.
     * @return self For chaining.
     */
    public function setLogging(bool $enable): self
    {
        $this->logging = $enable;
        return $this;
    }

    /**
     * Get the query log.
     *
     * @return array<array{sql: string, params: array, time: float}> The log.
     */
    public function getQueryLog(): array
    {
        return $this->queryLog;
    }

    /**
     * Clear the query log.
     *
     * @return self For chaining.
     */
    public function clearQueryLog(): self
    {
        $this->queryLog = [];
        return $this;
    }

    /**
     * Check if a table exists.
     *
     * @param string $table The table name.
     * @return bool True if exists.
     */
    public function tableExists(string $table): bool
    {
        $sql = "SHOW TABLES LIKE :table";
        $result = $this->queryValue($sql, ['table' => $table]);
        return $result !== false && $result !== null;
    }

    /**
     * Reset the singleton (useful for testing).
     *
     * @return void
     */
    public static function resetInstance(): void
    {
        self::$instance = null;
    }
}



==================================================
FILE PATH: .\core\Event.php
==================================================

<?php

declare(strict_types=1);

namespace Core;

/**
 * Zero CMS Event Manager (The Heart)
 * 
 * A WordPress-inspired hook system using modern OOP PHP.
 * Provides the ability to register actions (do things) and filters (modify data).
 * This is the spine of the CMS—all addon communication happens through this.
 */
final class Event
{
    /**
     * Storage for all registered listeners.
     * Structure: ['event_name' => [priority => [callbacks]]]
     *
     * @var array<string, array<int, array<callable>>>
     */
    private static array $listeners = [];

    /**
     * Cache for sorted listeners to avoid re-sorting on every trigger.
     *
     * @var array<string, array<callable>>
     */
    private static array $sortedListeners = [];

    /**
     * Register a listener (hook) for an event.
     * 
     * Works like WordPress add_action() / add_filter().
     * Lower priority numbers run first (e.g., 1 runs before 10).
     *
     * @param string   $name     The event name (hook).
     * @param callable $callback The callback to execute.
     * @param int      $priority Priority of execution. Lower = earlier. Default: 10.
     * @return void
     */
    public static function on(string $name, callable $callback, int $priority = 10): void
    {
        // Initialize the event's listener array if not exists
        if (!isset(self::$listeners[$name])) {
            self::$listeners[$name] = [];
        }

        // Initialize the priority level if not exists
        if (!isset(self::$listeners[$name][$priority])) {
            self::$listeners[$name][$priority] = [];
        }

        // Add the callback to the specified priority level
        self::$listeners[$name][$priority][] = $callback;

        // Invalidate the sorted cache for this event
        unset(self::$sortedListeners[$name]);
    }

    /**
     * Remove a listener from an event.
     *
     * @param string   $name     The event name.
     * @param callable $callback The callback to remove.
     * @param int      $priority The priority it was registered with.
     * @return bool True if removed, false if not found.
     */
    public static function off(string $name, callable $callback, int $priority = 10): bool
    {
        if (!isset(self::$listeners[$name][$priority])) {
            return false;
        }

        foreach (self::$listeners[$name][$priority] as $index => $registered) {
            if ($registered === $callback) {
                unset(self::$listeners[$name][$priority][$index]);
                // Re-index the array
                self::$listeners[$name][$priority] = array_values(self::$listeners[$name][$priority]);
                // Invalidate the sorted cache
                unset(self::$sortedListeners[$name]);
                return true;
            }
        }

        return false;
    }

    /**
     * Trigger an action event (do something).
     * 
     * Like WordPress do_action(). Executes all registered callbacks.
     * Does NOT return a value—used for side effects.
     *
     * @param string $name    The event name (hook).
     * @param mixed  $payload Optional data to pass to listeners.
     * @return void
     */
    public static function trigger(string $name, mixed $payload = null): void
    {
        $listeners = self::getSortedListeners($name);

        foreach ($listeners as $callback) {
            $callback($payload);
        }
    }

    /**
     * Apply a filter to a value (modify data).
     * 
     * Like WordPress apply_filters(). Each callback receives the value
     * and can modify it. The final modified value is returned.
     *
     * @param string $name  The filter name (hook).
     * @param mixed  $value The initial value to filter.
     * @param mixed  ...$args Additional arguments to pass to each callback.
     * @return mixed The filtered/modified value.
     */
    public static function filter(string $name, mixed $value, mixed ...$args): mixed
    {
        $listeners = self::getSortedListeners($name);

        foreach ($listeners as $callback) {
            $value = $callback($value, ...$args);
        }

        return $value;
    }

    /**
     * Check if an event has any registered listeners.
     *
     * @param string $name The event name.
     * @return bool True if listeners exist, false otherwise.
     */
    public static function hasListeners(string $name): bool
    {
        return !empty(self::$listeners[$name]);
    }

    /**
     * Get all registered listeners for an event (for debugging).
     *
     * @param string|null $name Optional event name. If null, returns all listeners.
     * @return array<string, array<int, array<callable>>>|array<int, array<callable>>
     */
    public static function getListeners(?string $name = null): array
    {
        if ($name === null) {
            return self::$listeners;
        }

        return self::$listeners[$name] ?? [];
    }

    /**
     * Clear all listeners for an event, or all events.
     *
     * @param string|null $name Optional event name. If null, clears everything.
     * @return void
     */
    public static function clear(?string $name = null): void
    {
        if ($name === null) {
            self::$listeners = [];
            self::$sortedListeners = [];
        } else {
            unset(self::$listeners[$name], self::$sortedListeners[$name]);
        }
    }

    /**
     * Get listeners sorted by priority (cached for performance).
     *
     * @param string $name The event name.
     * @return array<callable> Flat array of callbacks sorted by priority.
     */
    private static function getSortedListeners(string $name): array
    {
        // Return empty if no listeners registered
        if (!isset(self::$listeners[$name])) {
            return [];
        }

        // Return cached sorted listeners if available
        if (isset(self::$sortedListeners[$name])) {
            return self::$sortedListeners[$name];
        }

        // Sort by priority (lower numbers first)
        $priorities = self::$listeners[$name];
        ksort($priorities, SORT_NUMERIC);

        // Flatten into a single array
        $sorted = [];
        foreach ($priorities as $callbacks) {
            foreach ($callbacks as $callback) {
                $sorted[] = $callback;
            }
        }

        // Cache and return
        self::$sortedListeners[$name] = $sorted;
        return $sorted;
    }
}



==================================================
FILE PATH: .\core\Router.php
==================================================

<?php

declare(strict_types=1);

namespace Core;

/**
 * Zero CMS Router (The Auto-API Foundation)
 * 
 * A dynamic, event-driven router that contains NO hardcoded routes.
 * Instead of defining routes here, addons listen to the 'route_request' event
 * and claim URLs they own. This makes the router infinitely extensible.
 */
final class Router
{
    /**
     * Flag to track if any listener handled the request.
     */
    private static bool $handled = false;

    /**
     * The response content from the handler.
     */
    private static mixed $response = null;

    /**
     * Dispatch an incoming request.
     * 
     * This router does NOTHING except fire the 'route_request' event.
     * Addons (like PageManager) will listen and say "I own this URL!"
     * If no listener handles the request, a 404 is returned.
     *
     * @param string $uri    The request URI (e.g., '/blog/my-post').
     * @param string $method The HTTP method (GET, POST, etc.).
     * @return mixed The response from the handler, or triggers 404.
     */
    public static function dispatch(string $uri, string $method = 'GET'): mixed
    {
        // Reset state for this request
        self::$handled = false;
        self::$response = null;

        // Normalize the URI
        $uri = self::normalizeUri($uri);

        // Prepare the request context
        $request = [
            'uri'    => $uri,
            'method' => strtoupper($method),
            'query'  => $_GET ?? [],
            'body'   => $_POST ?? [],
        ];

        // Fire the route_request event - addons will listen to this!
        // This is the ONLY logic in the router. Pure event-driven design.
        Event::trigger('route_request', $request);

        // Check if any addon handled the request
        if (!self::$handled) {
            // No handler claimed this URL - fire 404 event
            Event::trigger('route_not_found', $request);
            
            // If still not handled, return default 404
            if (!self::$handled) {
                return self::notFound($uri);
            }
        }

        return self::$response;
    }

    /**
     * Mark the current request as handled.
     * 
     * Addons should call this when they claim a URL to prevent 404.
     *
     * @param mixed $response The response content to return.
     * @return void
     */
    public static function setHandled(mixed $response = null): void
    {
        self::$handled = true;
        self::$response = $response;
    }

    /**
     * Check if the current request has been handled.
     *
     * @return bool True if handled, false otherwise.
     */
    public static function isHandled(): bool
    {
        return self::$handled;
    }

    /**
     * Get the current response.
     *
     * @return mixed The response content.
     */
    public static function getResponse(): mixed
    {
        return self::$response;
    }

    /**
     * Normalize a URI for consistent matching.
     * - Removes base path (subdirectory)
     * - Removes query string
     * - Ensures leading slash
     * - Removes trailing slash (except for root)
     * - Decodes URL encoding
     *
     * @param string $uri The raw URI.
     * @return string The normalized URI.
     */
    public static function normalizeUri(string $uri): string
    {
        // Remove query string
        if (($pos = strpos($uri, '?')) !== false) {
            $uri = substr($uri, 0, $pos);
        }

        // Decode URL encoding
        $uri = urldecode($uri);

        // Auto-detect and strip base path (e.g., /Zero)
        $scriptName = $_SERVER['SCRIPT_NAME'] ?? '/index.php';
        $basePath = dirname($scriptName);
        if ($basePath !== '/' && $basePath !== '\\' && str_starts_with($uri, $basePath)) {
            $uri = substr($uri, strlen($basePath));
        }

        // Ensure leading slash
        if (!str_starts_with($uri, '/')) {
            $uri = '/' . $uri;
        }

        // Remove trailing slash (but keep root as '/')
        if ($uri !== '/' && str_ends_with($uri, '/')) {
            $uri = rtrim($uri, '/');
        }

        return $uri;
    }

    /**
     * Parse URI segments for easy matching.
     *
     * @param string $uri The URI to parse.
     * @return array<string> Array of segments.
     */
    public static function getSegments(string $uri): array
    {
        $uri = self::normalizeUri($uri);
        $uri = trim($uri, '/');

        if ($uri === '') {
            return [];
        }

        return explode('/', $uri);
    }

    /**
     * Simple pattern matching for dynamic routes.
     * Supports {param} style placeholders.
     *
     * @param string $pattern The route pattern (e.g., '/blog/{slug}').
     * @param string $uri     The actual URI to match.
     * @return array|false Array of matched params, or false if no match.
     */
    public static function matchPattern(string $pattern, string $uri): array|false
    {
        $pattern = self::normalizeUri($pattern);
        $uri = self::normalizeUri($uri);

        // Exact match
        if ($pattern === $uri) {
            return [];
        }

        $patternParts = explode('/', trim($pattern, '/'));
        $uriParts = explode('/', trim($uri, '/'));

        // Must have same number of segments
        if (count($patternParts) !== count($uriParts)) {
            return false;
        }

        $params = [];

        foreach ($patternParts as $i => $part) {
            // Check for {param} placeholder
            if (preg_match('/^\{([a-zA-Z_][a-zA-Z0-9_]*)\}$/', $part, $matches)) {
                $params[$matches[1]] = $uriParts[$i];
            } elseif ($part !== $uriParts[$i]) {
                // No match
                return false;
            }
        }

        return $params;
    }

    /**
     * Default 404 Not Found response.
     *
     * @param string $uri The requested URI.
     * @return string The 404 message.
     */
    private static function notFound(string $uri): string
    {
        http_response_code(404);

        // Allow filtering the 404 response
        $message = Event::filter('404_message', "404 Not Found: {$uri}");

        return $message;
    }

    /**
     * Get the base path (subdirectory) if running in a subdirectory.
     *
     * @return string The base path (e.g., '/Zero' or '').
     */
    public static function getBasePath(): string
    {
        $scriptName = $_SERVER['SCRIPT_NAME'] ?? '/index.php';
        $basePath = dirname($scriptName);
        return ($basePath === '/' || $basePath === '\\') ? '' : $basePath;
    }

    /**
     * Generate a full URL with base path.
     *
     * @param string $path The path (e.g., '/admin/login').
     * @return string The full URL with base path.
     */
    public static function url(string $path): string
    {
        $basePath = self::getBasePath();
        
        // Ensure path starts with /
        if (!str_starts_with($path, '/')) {
            $path = '/' . $path;
        }
        
        return $basePath . $path;
    }

    /**
     * Redirect to another URL.
     *
     * @param string $url        The URL to redirect to (relative paths will have base path prepended).
     * @param int    $statusCode HTTP status code (301, 302, etc.).
     * @return never
     */
    public static function redirect(string $url, int $statusCode = 302): never
    {
        // If it's a relative path (starts with /), prepend base path
        if (str_starts_with($url, '/') && !str_starts_with($url, '//')) {
            $url = self::url($url);
        }
        
        http_response_code($statusCode);
        header("Location: {$url}");
        exit;
    }

    /**
     * Get the current request URI.
     *
     * @return string The current URI.
     */
    public static function getCurrentUri(): string
    {
        return self::normalizeUri($_SERVER['REQUEST_URI'] ?? '/');
    }

    /**
     * Get the current request method.
     *
     * @return string The HTTP method.
     */
    public static function getCurrentMethod(): string
    {
        return strtoupper($_SERVER['REQUEST_METHOD'] ?? 'GET');
    }
}




==================================================
FILE PATH: .\_frontend\jsconfig.json
==================================================

{
    "compilerOptions": {
        "target": "ES2020",
        "useDefineForClassFields": true,
        "lib": [
            "ES2020",
            "DOM",
            "DOM.Iterable"
        ],
        "module": "ESNext",
        "skipLibCheck": true,
        "moduleResolution": "bundler",
        "allowImportingTsExtensions": true,
        "resolveJsonModule": true,
        "isolatedModules": true,
        "noEmit": true,
        "jsx": "react-jsx",
        "strict": true,
        "unusedLocals": false,
        "unusedParameters": false,
        "noFallthroughCasesInSwitch": true,
        "baseUrl": ".",
        "paths": {
            "@/*": [
                "./src/*"
            ]
        }
    },
    "include": [
        "src"
    ]
}


==================================================
FILE PATH: .\_frontend\package.json
==================================================

{
    "name": "zero-editor",
    "version": "1.0.0",
    "type": "module",
    "scripts": {
        "dev": "vite",
        "build": "vite build",
        "tiptap": "npx @tiptap/cli@latest"
    },
    "dependencies": {
        "@floating-ui/dom": "^1.7.4",
        "@floating-ui/react": "^0.27.16",
        "@tiptap/core": "^3.14.0",
        "@tiptap/extension-bubble-menu": "^3.14.0",
        "@tiptap/extension-drag-handle": "^3.14.0",
        "@tiptap/extension-floating-menu": "^3.14.0",
        "@tiptap/extension-image": "^3.14.0",
        "@tiptap/extension-link": "^3.14.0",
        "@tiptap/extension-node-range": "^3.14.0",
        "@tiptap/extension-placeholder": "^3.14.0",
        "@tiptap/pm": "^3.14.0",
        "@tiptap/react": "^3.14.0",
        "@tiptap/starter-kit": "^3.14.0",
        "@tiptap/suggestion": "^3.14.0",
        "clsx": "^2.1.0",
        "lucide-react": "^0.300.0",
        "react": "^18.2.0",
        "react-dom": "^18.2.0",
        "tailwind-merge": "^2.2.0",
        "tippy.js": "^6.3.7"
    },
    "devDependencies": {
        "@vitejs/plugin-react": "^4.2.0",
        "autoprefixer": "^10.4.17",
        "postcss": "^8.4.35",
        "tailwindcss": "^3.4.1",
        "vite": "^5.0.0"
    }
}



==================================================
FILE PATH: .\_frontend\vite.config.js
==================================================

import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
    plugins: [react()],
    build: {
        outDir: '../content/themes/admin-default/assets/js',
        emptyOutDir: false,
        rollupOptions: {
            input: 'src/main.jsx',
            output: {
                entryFileNames: 'editor.bundle.js',
                format: 'iife',
                name: 'ZeroEditor'
            }
        }
    },
    define: {
        'process.env': {}
    }
})



==================================================
FILE PATH: .\_frontend\src\index.css
==================================================

@tailwind base;
@tailwind components;
@tailwind utilities;

.ProseMirror {
  outline: none;
  min-height: 150px;
}

.ProseMirror p.is-editor-empty:first-child::before {
  color: #adb5bd;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

/* Drag Handle Styles */
.drag-handle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  cursor: grab;
  border-radius: 4px;
  background: transparent;
  color: #9ca3af;
  transition: all 0.15s ease;
}

.drag-handle:hover {
  background: #f3f4f6;
  color: #6b7280;
}

.drag-handle:active {
  cursor: grabbing;
  background: #e5e7eb;
  color: #374151;
}

.drag-handle svg {
  width: 14px;
  height: 14px;
}


==================================================
FILE PATH: .\_frontend\src\main.js
==================================================

import { Editor } from '@tiptap/core';
import StarterKit from '@tiptap/starter-kit';
import Image from '@tiptap/extension-image';
import Link from '@tiptap/extension-link';
import Placeholder from '@tiptap/extension-placeholder';
import Typography from '@tiptap/extension-typography';

// Image upload handler function
const uploadImage = async (file) => {
    const formData = new FormData();
    formData.append('image', file);

    try {
        const response = await fetch('/admin/api/upload', {
            method: 'POST',
            body: formData,
        });

        const data = await response.json();

        if (data.success && data.file && data.file.url) {
            return data.file.url;
        } else {
            throw new Error(data.error || 'Upload failed');
        }
    } catch (error) {
        console.error('Error uploading image:', error);
        alert('Failed to upload image: ' + error.message);
        return null;
    }
};

// Initialize Editor
const editor = new Editor({
    element: document.querySelector('#tiptap-editor'),
    extensions: [
        StarterKit,
        Typography,
        Link.configure({
            openOnClick: false,
        }),
        Image.configure({
            inline: true,
            allowBase64: true,
        }),
        Placeholder.configure({
            placeholder: 'Write something epic...',
        }),
    ],
    content: window.ZERO_INITIAL_CONTENT || '',
    autofocus: true,
    editorProps: {
        handleDrop: (view, event, slice, moved) => {
            if (!moved && event.dataTransfer && event.dataTransfer.files && event.dataTransfer.files[0]) {
                const file = event.dataTransfer.files[0];

                if (file.type.startsWith('image/')) {
                    uploadImage(file).then(url => {
                        if (url) {
                            const { schema } = view.state;
                            const coordinates = view.posAtCoords({ left: event.clientX, top: event.clientY });
                            const node = schema.nodes.image.create({ src: url });
                            const transaction = view.state.tr.insert(coordinates.pos, node);
                            view.dispatch(transaction);
                        }
                    });
                    return true; // Handled
                }
            }
            return false;
        },
        handlePaste: (view, event, slice) => {
            const items = (event.clipboardData || event.originalEvent.clipboardData).items;
            for (const item of items) {
                if (item.type.indexOf('image') === 0) {
                    const file = item.getAsFile();

                    uploadImage(file).then(url => {
                        if (url) {
                            const transaction = view.state.tr.replaceSelectionWith(
                                view.state.schema.nodes.image.create({ src: url })
                            );
                            view.dispatch(transaction);
                        }
                    });
                    return true; // Handled
                }
            }
            return false;
        }
    },
});

// Expose editor to window for PHP to access
window.editor = editor;

console.log('Tiptap Editor initialized');



==================================================
FILE PATH: .\_frontend\src\main.jsx
==================================================

import React from 'react'
import ReactDOM from 'react-dom/client'
import { SimpleEditor } from './components/simple-editor'
import './index.css'

const rootElement = document.getElementById('tiptap-editor')

if (rootElement) {
    // Get initial data from PHP
    let content = window.ZERO_INITIAL_CONTENT || null

    // Validate content is valid Tiptap JSON format
    // Tiptap expects { type: 'doc', content: [...] } structure
    if (content && typeof content === 'object') {
        // Check if it's Tiptap format (has type: 'doc')
        if (content.type !== 'doc') {
            // It's probably old Editor.js format or other - start fresh
            console.warn('Content is not in Tiptap format, starting with empty document')
            content = null
        }
    } else if (typeof content === 'string') {
        // If it's a string, it might be HTML - let Tiptap handle it
        // Otherwise pass null for safety
        try {
            const parsed = JSON.parse(content)
            if (parsed.type === 'doc') {
                content = parsed
            } else {
                content = null
            }
        } catch {
            // Keep as string (might be HTML)
        }
    } else {
        content = null
    }

    ReactDOM.createRoot(rootElement).render(
        <React.StrictMode>
            <SimpleEditor content={content} />
        </React.StrictMode>
    )

    console.log('React Editor Mounted')
} else {
    console.error('Target container #tiptap-editor not found')
}



==================================================
FILE PATH: .\_frontend\src\components\command-list.jsx
==================================================

import React, { useState, useEffect, forwardRef, useImperativeHandle } from 'react'
import { Heading1, Heading2, List, ListOrdered, Image, Code } from 'lucide-react'

export const CommandList = forwardRef((props, ref) => {
    const [selectedIndex, setSelectedIndex] = useState(0)

    // Allow the parent to control selection via keyboard
    useImperativeHandle(ref, () => ({
        onKeyDown: ({ event }) => {
            if (event.key === 'ArrowUp') {
                upHandler()
                return true
            }
            if (event.key === 'ArrowDown') {
                downHandler()
                return true
            }
            if (event.key === 'Enter') {
                enterHandler()
                return true
            }
            return false
        },
    }))

    const upHandler = () => {
        setSelectedIndex((selectedIndex + props.items.length - 1) % props.items.length)
    }

    const downHandler = () => {
        setSelectedIndex((selectedIndex + 1) % props.items.length)
    }

    const enterHandler = () => {
        selectItem(selectedIndex)
    }

    const selectItem = (index) => {
        const item = props.items[index]
        if (item) {
            props.command(item)
        }
    }

    useEffect(() => setSelectedIndex(0), [props.items])

    return (
        <div className="bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden min-w-[200px]">
            {props.items.length ? (
                props.items.map((item, index) => (
                    <button
                        key={index}
                        onClick={() => selectItem(index)}
                        className={`w-full flex items-center gap-3 px-4 py-2 text-left text-sm transition-colors ${index === selectedIndex
                                ? 'bg-indigo-50 text-indigo-700'
                                : 'text-gray-700 hover:bg-gray-50'
                            }`}
                    >
                        <span className="text-gray-400">{item.icon}</span>
                        <span>{item.title}</span>
                    </button>
                ))
            ) : (
                <div className="px-4 py-2 text-sm text-gray-500">No results</div>
            )}
        </div>
    )
})

CommandList.displayName = 'CommandList'



==================================================
FILE PATH: .\_frontend\src\components\drag-handle.jsx
==================================================

import React, { useState, useEffect, useCallback } from 'react'
import { GripVertical, Plus, Trash2 } from 'lucide-react'

export const DragHandle = ({ editor }) => {
    const [position, setPosition] = useState(null)
    const [isHovering, setIsHovering] = useState(false)

    const updatePosition = useCallback(() => {
        if (!editor) return

        const { from } = editor.state.selection

        try {
            const domInfo = editor.view.domAtPos(from)
            const nodeDOM = domInfo.node instanceof HTMLElement
                ? domInfo.node
                : domInfo.node.parentElement

            // Find the closest top-level block
            const block = nodeDOM?.closest('.ProseMirror > *')

            if (block) {
                const rect = block.getBoundingClientRect()
                const editorRect = editor.view.dom.getBoundingClientRect()

                // Position the handle to the left of the block
                setPosition({
                    top: rect.top - editorRect.top + 2,
                    height: rect.height
                })
            } else {
                setPosition(null)
            }
        } catch (e) {
            setPosition(null)
        }
    }, [editor])

    useEffect(() => {
        if (!editor) return

        editor.on('selectionUpdate', updatePosition)
        editor.on('update', updatePosition)
        editor.on('focus', updatePosition)

        // Initial position
        const timer = setTimeout(updatePosition, 100)

        return () => {
            clearTimeout(timer)
            editor.off('selectionUpdate', updatePosition)
            editor.off('update', updatePosition)
            editor.off('focus', updatePosition)
        }
    }, [editor, updatePosition])

    // Also update on mouse move over the editor
    useEffect(() => {
        if (!editor) return

        const editorElement = editor.view.dom

        const handleMouseMove = (e) => {
            // Find the block element under the mouse
            const elements = document.elementsFromPoint(e.clientX, e.clientY)
            const block = elements.find(el => el.matches('.ProseMirror > *'))

            if (block) {
                const rect = block.getBoundingClientRect()
                const editorRect = editorElement.getBoundingClientRect()

                setPosition({
                    top: rect.top - editorRect.top + 2,
                    height: rect.height
                })
                setIsHovering(true)
            }
        }

        const handleMouseLeave = () => {
            setIsHovering(false)
            updatePosition()
        }

        editorElement.addEventListener('mousemove', handleMouseMove)
        editorElement.addEventListener('mouseleave', handleMouseLeave)

        return () => {
            editorElement.removeEventListener('mousemove', handleMouseMove)
            editorElement.removeEventListener('mouseleave', handleMouseLeave)
        }
    }, [editor, updatePosition])

    if (!position) return null

    const selectCurrentBlock = () => {
        const { from } = editor.state.selection
        const $pos = editor.state.doc.resolve(from)

        // Find the start and end of the current top-level node
        if ($pos.depth > 0) {
            const start = $pos.before(1)
            const end = $pos.after(1)
            editor.chain().focus().setTextSelection({ from: start, to: end }).run()
        }
    }

    const insertNewParagraph = () => {
        const { from } = editor.state.selection
        const $pos = editor.state.doc.resolve(from)

        // Insert at the end of current block
        if ($pos.depth > 0) {
            const endOfBlock = $pos.after(1)
            editor.chain()
                .focus()
                .insertContentAt(endOfBlock, { type: 'paragraph' })
                .setTextSelection(endOfBlock + 1)
                .run()
        }
    }

    const deleteCurrentBlock = () => {
        const { from } = editor.state.selection
        const $pos = editor.state.doc.resolve(from)

        if ($pos.depth > 0) {
            const start = $pos.before(1)
            const end = $pos.after(1)
            editor.chain().focus().deleteRange({ from: start, to: end }).run()
        }
    }

    return (
        <div
            className="absolute flex items-center gap-1 transition-opacity duration-150"
            style={{
                top: position.top,
                left: -60,
                opacity: isHovering ? 1 : 0.6,
                zIndex: 40
            }}
            onMouseEnter={() => setIsHovering(true)}
            onMouseLeave={() => setIsHovering(false)}
        >
            {/* ADD BUTTON - Insert new paragraph below */}
            <button
                className="p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-all duration-150"
                onClick={insertNewParagraph}
                title="Add block below"
            >
                <Plus className="w-5 h-5" />
            </button>

            {/* DRAG GRIP - Selects the whole block */}
            <button
                className="p-1.5 text-gray-400 hover:text-gray-700 hover:bg-gray-100 rounded-md cursor-grab transition-all duration-150 active:cursor-grabbing"
                onClick={selectCurrentBlock}
                onMouseDown={(e) => {
                    // Select the block on mouse down for immediate feedback
                    selectCurrentBlock()
                }}
                title="Click to select block, then Ctrl+X to cut"
            >
                <GripVertical className="w-5 h-5" />
            </button>

            {/* DELETE BUTTON - Remove the block */}
            <button
                className="p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-all duration-150"
                onClick={deleteCurrentBlock}
                title="Delete block"
            >
                <Trash2 className="w-4 h-4" />
            </button>
        </div>
    )
}



==================================================
FILE PATH: .\_frontend\src\components\simple-editor.jsx
==================================================

import React from 'react'
import { useEditor, EditorContent } from '@tiptap/react'
import StarterKit from '@tiptap/starter-kit'
import Image from '@tiptap/extension-image'
import Link from '@tiptap/extension-link'
import { Bold, Italic, Strikethrough, Link as LinkIcon, Code, Heading1, Heading2 } from 'lucide-react'
import { SlashDropdownMenu } from './slash-dropdown-menu'
import { DragHandle } from './drag-handle'

// Custom BubbleMenu component for v3
const CustomBubbleMenu = ({ editor, children, className }) => {
    const [isVisible, setIsVisible] = React.useState(false)
    const [position, setPosition] = React.useState({ top: 0, left: 0 })
    const menuRef = React.useRef(null)

    React.useEffect(() => {
        if (!editor) return

        const updatePosition = () => {
            const { from, to, empty } = editor.state.selection

            // Only show when text is selected
            if (empty) {
                setIsVisible(false)
                return
            }

            try {
                const coords = editor.view.coordsAtPos(from)
                const editorRect = editor.view.dom.getBoundingClientRect()

                setPosition({
                    top: coords.top - editorRect.top - 45,
                    left: coords.left - editorRect.left
                })
                setIsVisible(true)
            } catch (e) {
                setIsVisible(false)
            }
        }

        editor.on('selectionUpdate', updatePosition)
        editor.on('transaction', updatePosition)

        return () => {
            editor.off('selectionUpdate', updatePosition)
            editor.off('transaction', updatePosition)
        }
    }, [editor])

    if (!isVisible) return null

    return (
        <div
            ref={menuRef}
            className={className}
            style={{
                position: 'absolute',
                top: position.top,
                left: position.left,
                zIndex: 50
            }}
        >
            {children}
        </div>
    )
}

export const SimpleEditor = ({ content = '' }) => {
    const uploadImage = async (file) => {
        const formData = new FormData()
        formData.append('image', file)

        try {
            const response = await fetch('/admin/api/upload', {
                method: 'POST',
                body: formData,
            })
            const data = await response.json()
            if (data.success && data.file && data.file.url) {
                return data.file.url
            }
            throw new Error(data.error || 'Upload failed')
        } catch (error) {
            console.error('Image upload error:', error)
            return null
        }
    }

    const editor = useEditor({
        extensions: [
            StarterKit,
            Image.configure({
                inline: true,
                allowBase64: true,
            }),
            Link.configure({
                openOnClick: false,
            }),
            SlashDropdownMenu,
        ],
        content,
        editorProps: {
            attributes: {
                class: 'prose prose-xl max-w-none focus:outline-none min-h-[1000px] p-16',
            },
            handleDrop: (view, event, slice, moved) => {
                if (!moved && event.dataTransfer && event.dataTransfer.files && event.dataTransfer.files[0]) {
                    const file = event.dataTransfer.files[0]
                    if (file.type.startsWith('image/')) {
                        uploadImage(file).then(url => {
                            if (url) {
                                const { schema } = view.state
                                const coordinates = view.posAtCoords({ left: event.clientX, top: event.clientY })
                                const node = schema.nodes.image.create({ src: url })
                                const transaction = view.state.tr.insert(coordinates.pos, node)
                                view.dispatch(transaction)
                            }
                        })
                        return true
                    }
                }
                return false
            },
            handlePaste: (view, event, slice) => {
                const items = (event.clipboardData || event.originalEvent.clipboardData).items
                for (const item of items) {
                    if (item.type.indexOf('image') === 0) {
                        const file = item.getAsFile()
                        uploadImage(file).then(url => {
                            if (url) {
                                const transaction = view.state.tr.replaceSelectionWith(
                                    view.state.schema.nodes.image.create({ src: url })
                                )
                                view.dispatch(transaction)
                            }
                        })
                        return true
                    }
                }
                return false
            }
        },
        onUpdate: ({ editor }) => {
            window.zero_editor_content = editor.getJSON()
        },
    })

    React.useEffect(() => {
        if (editor) {
            window.editor = editor
        }
    }, [editor])

    if (!editor) {
        return null
    }

    return (
        <div className="w-full min-h-[80vh] flex flex-col group">
            <div className="relative mx-auto w-full max-w-[1000px]">
                {/* Custom Drag Handle */}
                <DragHandle editor={editor} />

                {/* Paper Container */}
                <div className="bg-white shadow-lg min-h-[1100px] my-8">
                    <EditorContent editor={editor} />

                    <CustomBubbleMenu
                        editor={editor}
                        className="flex overflow-hidden rounded-lg border border-gray-200 bg-white shadow-xl"
                    >
                        {/* BOLD */}
                        <button
                            onClick={() => editor.chain().focus().toggleBold().run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('bold') ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Bold"
                        >
                            <Bold className="w-4 h-4" />
                        </button>

                        {/* ITALIC */}
                        <button
                            onClick={() => editor.chain().focus().toggleItalic().run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('italic') ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Italic"
                        >
                            <Italic className="w-4 h-4" />
                        </button>

                        {/* STRIKE */}
                        <button
                            onClick={() => editor.chain().focus().toggleStrike().run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('strike') ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Strikethrough"
                        >
                            <Strikethrough className="w-4 h-4" />
                        </button>

                        {/* CODE */}
                        <button
                            onClick={() => editor.chain().focus().toggleCode().run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('code') ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Code"
                        >
                            <Code className="w-4 h-4" />
                        </button>

                        {/* LINK */}
                        <button
                            onClick={() => {
                                const url = window.prompt('Enter URL')
                                if (url) {
                                    editor.chain().focus().setLink({ href: url }).run()
                                }
                            }}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('link') ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Link"
                        >
                            <LinkIcon className="w-4 h-4" />
                        </button>

                        {/* DIVIDER */}
                        <div className="w-px bg-gray-200 mx-1"></div>

                        {/* H1 */}
                        <button
                            onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('heading', { level: 1 }) ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Heading 1"
                        >
                            <Heading1 className="w-4 h-4" />
                        </button>

                        {/* H2 */}
                        <button
                            onClick={() => editor.chain().focus().toggleHeading({ level: 2 }).run()}
                            className={`p-2 hover:bg-gray-100 ${editor.isActive('heading', { level: 2 }) ? 'text-blue-600 bg-gray-50' : 'text-gray-600'}`}
                            title="Heading 2"
                        >
                            <Heading2 className="w-4 h-4" />
                        </button>
                    </CustomBubbleMenu>
                </div>
            </div>
        </div>
    )
}



==================================================
FILE PATH: .\_frontend\src\components\slash-dropdown-menu.jsx
==================================================

import React, { useState, useEffect, useCallback, useRef } from 'react'
import { Extension } from '@tiptap/core'
import { ReactRenderer } from '@tiptap/react'
import Suggestion from '@tiptap/suggestion'
import tippy from 'tippy.js'
import {
    Type, Heading1, Heading2, Heading3,
    List, ListOrdered, Quote, Code, Minus,
    Image, Link
} from 'lucide-react'

// Helper function to upload image
const uploadImage = async (file) => {
    const formData = new FormData()
    formData.append('image', file)
    try {
        const response = await fetch('/admin/api/upload', {
            method: 'POST',
            body: formData,
        })
        const data = await response.json()
        if (data.success && data.file && data.file.url) {
            return data.file.url
        }
        throw new Error(data.error || 'Upload failed')
    } catch (error) {
        console.error('Image upload error:', error)
        return null
    }
}

// Trigger file input for image upload
const triggerImageUpload = (editor, range) => {
    const input = document.createElement('input')
    input.type = 'file'
    input.accept = 'image/*'
    input.onchange = async (e) => {
        const file = e.target.files?.[0]
        if (file) {
            const url = await uploadImage(file)
            if (url) {
                editor.chain().focus().deleteRange(range).setImage({ src: url }).run()
            }
        }
    }
    input.click()
}

// Menu Items Configuration
const defaultMenuItems = [
    {
        title: 'Text',
        subtext: 'Just start with plain text',
        icon: Type,
        group: 'Format',
        aliases: ['text', 'paragraph', 'p'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setParagraph().run()
        },
    },
    {
        title: 'Heading 1',
        subtext: 'Big section heading',
        icon: Heading1,
        group: 'Format',
        aliases: ['h1', 'heading1', 'title'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setNode('heading', { level: 1 }).run()
        },
    },
    {
        title: 'Heading 2',
        subtext: 'Medium section heading',
        icon: Heading2,
        group: 'Format',
        aliases: ['h2', 'heading2', 'subtitle'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setNode('heading', { level: 2 }).run()
        },
    },
    {
        title: 'Heading 3',
        subtext: 'Small section heading',
        icon: Heading3,
        group: 'Format',
        aliases: ['h3', 'heading3'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setNode('heading', { level: 3 }).run()
        },
    },
    {
        title: 'Bullet List',
        subtext: 'Create a simple bullet list',
        icon: List,
        group: 'Lists',
        aliases: ['ul', 'unordered', 'bullet'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleBulletList().run()
        },
    },
    {
        title: 'Numbered List',
        subtext: 'Create a numbered list',
        icon: ListOrdered,
        group: 'Lists',
        aliases: ['ol', 'ordered', 'numbered'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleOrderedList().run()
        },
    },
    {
        title: 'Quote',
        subtext: 'Capture a quote',
        icon: Quote,
        group: 'Blocks',
        aliases: ['blockquote', 'quote'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleBlockquote().run()
        },
    },
    {
        title: 'Code Block',
        subtext: 'Add code with syntax highlighting',
        icon: Code,
        group: 'Blocks',
        aliases: ['code', 'codeblock', 'pre'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleCodeBlock().run()
        },
    },
    {
        title: 'Divider',
        subtext: 'Visual separator line',
        icon: Minus,
        group: 'Blocks',
        aliases: ['hr', 'divider', 'line'],
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setHorizontalRule().run()
        },
    },
    {
        title: 'Upload Image',
        subtext: 'Upload from your computer',
        icon: Image,
        group: 'Media',
        aliases: ['image', 'upload', 'photo', 'picture'],
        command: ({ editor, range }) => {
            triggerImageUpload(editor, range)
        },
    },
    {
        title: 'Image from URL',
        subtext: 'Embed with a link',
        icon: Link,
        group: 'Media',
        aliases: ['embed', 'url', 'link', 'img'],
        command: ({ editor, range }) => {
            const url = window.prompt('Enter image URL')
            if (url) {
                editor.chain().focus().deleteRange(range).setImage({ src: url }).run()
            }
        },
    },
]

// Filter items by query
const filterItems = (items, query) => {
    if (!query) return items
    const lowerQuery = query.toLowerCase()
    return items.filter(item =>
        item.title.toLowerCase().includes(lowerQuery) ||
        item.aliases?.some(alias => alias.toLowerCase().includes(lowerQuery))
    )
}

// The Visual Menu Component
export const SlashMenuList = React.forwardRef((props, ref) => {
    const [selectedIndex, setSelectedIndex] = useState(0)
    const menuRef = useRef(null)

    const items = props.items || []

    const selectItem = useCallback((index) => {
        const item = items[index]
        if (item) {
            props.command(item)
        }
    }, [items, props])

    useEffect(() => {
        setSelectedIndex(0)
    }, [items])

    // Scroll selected item into view
    useEffect(() => {
        if (menuRef.current) {
            const selected = menuRef.current.querySelector(`[data-index="${selectedIndex}"]`)
            if (selected) {
                selected.scrollIntoView({ block: 'nearest' })
            }
        }
    }, [selectedIndex])

    React.useImperativeHandle(ref, () => ({
        onKeyDown: ({ event }) => {
            if (event.key === 'ArrowUp') {
                setSelectedIndex((prev) => (prev + items.length - 1) % items.length)
                return true
            }
            if (event.key === 'ArrowDown') {
                setSelectedIndex((prev) => (prev + 1) % items.length)
                return true
            }
            if (event.key === 'Enter') {
                selectItem(selectedIndex)
                return true
            }
            return false
        },
    }))

    if (!items.length) {
        return (
            <div className="bg-white rounded-lg shadow-xl border border-gray-200 p-3 text-sm text-gray-500">
                No results found
            </div>
        )
    }

    // Group items
    const groupedItems = items.reduce((acc, item, index) => {
        const group = item.group || 'Other'
        if (!acc[group]) acc[group] = []
        acc[group].push({ ...item, originalIndex: index })
        return acc
    }, {})

    let flatIndex = 0

    return (
        <div
            ref={menuRef}
            className="bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden max-h-80 overflow-y-auto min-w-[280px]"
        >
            {Object.entries(groupedItems).map(([groupName, groupItems]) => (
                <div key={groupName}>
                    <div className="px-3 py-1.5 text-[10px] font-semibold text-gray-400 uppercase tracking-wider bg-gray-50 border-b border-gray-100">
                        {groupName}
                    </div>
                    {groupItems.map((item) => {
                        const currentIndex = flatIndex++
                        const Icon = item.icon
                        return (
                            <button
                                key={item.title}
                                data-index={currentIndex}
                                onClick={() => selectItem(currentIndex)}
                                className={`w-full flex items-center gap-3 px-3 py-2 text-left transition-colors ${currentIndex === selectedIndex
                                    ? 'bg-indigo-50 text-indigo-700'
                                    : 'text-gray-700 hover:bg-gray-50'
                                    }`}
                            >
                                <div className={`p-1.5 rounded ${currentIndex === selectedIndex ? 'bg-indigo-100' : 'bg-gray-100'}`}>
                                    <Icon className="w-4 h-4" />
                                </div>
                                <div className="flex-1 min-w-0">
                                    <div className="text-sm font-medium">{item.title}</div>
                                    <div className="text-xs text-gray-400 truncate">{item.subtext}</div>
                                </div>
                            </button>
                        )
                    })}
                </div>
            ))}
        </div>
    )
})

SlashMenuList.displayName = 'SlashMenuList'

// The Tiptap Extension
export const SlashDropdownMenu = Extension.create({
    name: 'slashDropdownMenu',

    addOptions() {
        return {
            suggestion: {
                char: '/',
                allowSpaces: false,
                startOfLine: false,
                items: ({ query }) => filterItems(defaultMenuItems, query),
                command: ({ editor, range, props }) => {
                    props.command({ editor, range })
                },
                render: () => {
                    let component
                    let popup

                    return {
                        onStart: (props) => {
                            component = new ReactRenderer(SlashMenuList, {
                                props,
                                editor: props.editor,
                            })

                            if (!props.clientRect) return

                            popup = tippy('body', {
                                getReferenceClientRect: props.clientRect,
                                appendTo: () => document.body,
                                content: component.element,
                                showOnCreate: true,
                                interactive: true,
                                trigger: 'manual',
                                placement: 'bottom-start',
                                popperOptions: {
                                    modifiers: [
                                        { name: 'flip', options: { fallbackPlacements: ['top-start'] } },
                                        { name: 'preventOverflow', options: { padding: 8 } },
                                    ],
                                },
                            })
                        },

                        onUpdate(props) {
                            component?.updateProps(props)
                            if (!props.clientRect) return
                            popup?.[0]?.setProps({ getReferenceClientRect: props.clientRect })
                        },

                        onKeyDown(props) {
                            if (props.event.key === 'Escape') {
                                popup?.[0]?.hide()
                                return true
                            }
                            return component?.ref?.onKeyDown(props) ?? false
                        },

                        onExit() {
                            popup?.[0]?.destroy()
                            component?.destroy()
                        },
                    }
                },
            },
        }
    },

    addProseMirrorPlugins() {
        return [
            Suggestion({
                editor: this.editor,
                ...this.options.suggestion,
            }),
        ]
    },
})



==================================================
FILE PATH: .\_frontend\src\components\tiptap-ui-utils\floating-element.jsx
==================================================

import { autoUpdate, useFloating } from '@floating-ui/react'
import * as React from 'react'

export const getSelectionBoundingRect = (editor) => {
    const { view, state } = editor
    const { from, to } = state.selection
    const start = view.coordsAtPos(from)
    const end = view.coordsAtPos(to)

    return {
        left: Math.min(start.left, end.left),
        right: Math.max(start.right, end.right),
        top: Math.min(start.top, end.top),
        bottom: Math.max(start.bottom, end.bottom),
        width: Math.abs(start.left - end.left),
        height: Math.abs(start.bottom - end.top),
        x: Math.min(start.left, end.left),
        y: Math.min(start.top, end.top),
    }
}

export const FloatingElement = ({
    editor,
    children,
    shouldShow = true,
    referenceElement = null,
    getBoundingClientRect = null,
    floatingOptions = {}
}) => {
    if (!editor || !shouldShow) return null

    const { refs, floatingStyles } = useFloating({
        strategy: 'fixed',
        placement: 'top',
        whileElementsMounted: autoUpdate,
        ...floatingOptions,
    })

    React.useLayoutEffect(() => {
        if (referenceElement) {
            refs.setReference(referenceElement)
            return
        }

        const getRect = getBoundingClientRect || (() => getSelectionBoundingRect(editor))

        const virtualElement = {
            getBoundingClientRect: () => {
                const rect = getRect(editor)
                return {
                    width: rect.width,
                    height: rect.height,
                    top: rect.top,
                    right: rect.right,
                    bottom: rect.bottom,
                    left: rect.left,
                    x: rect.left,
                    y: rect.top,
                }
            },
        }

        refs.setReference(virtualElement)
    }, [editor, referenceElement, getBoundingClientRect, refs])

    return (
        <div
            ref={refs.setFloating}
            style={{ ...floatingStyles, zIndex: 50 }}
            onMouseDown={(e) => e.preventDefault()}
        >
            {children}
        </div>
    )
}



==================================================
FILE PATH: .\_frontend\src\extensions\slash-command.js
==================================================

import { Extension } from '@tiptap/core'
import Suggestion from '@tiptap/suggestion'

export const SlashCommand = Extension.create({
    name: 'slashCommand',

    addOptions() {
        return {
            suggestion: {
                char: '/',
                command: ({ editor, range, props }) => {
                    props.command({ editor, range })
                },
            },
        }
    },

    addProseMirrorPlugins() {
        return [
            Suggestion({
                editor: this.editor,
                ...this.options.suggestion,
            }),
        ]
    },
})

export const getSuggestionItems = ({ query }) => {
    const items = [
        {
            title: 'Heading 1',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .setNode('heading', { level: 1 })
                    .run()
            },
        },
        {
            title: 'Heading 2',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .setNode('heading', { level: 2 })
                    .run()
            },
        },
        {
            title: 'Bullet List',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .toggleBulletList()
                    .run()
            },
        },
        {
            title: 'Numbered List',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .toggleOrderedList()
                    .run()
            },
        },
        {
            title: 'Quote',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .toggleBlockquote()
                    .run()
            },
        },
        {
            title: 'Code Block',
            command: ({ editor, range }) => {
                editor
                    .chain()
                    .focus()
                    .deleteRange(range)
                    .toggleCodeBlock()
                    .run()
            },
        },
    ]

    return items.filter(item =>
        item.title.toLowerCase().startsWith(query.toLowerCase())
    )
}



==================================================
FILE PATH: .\_frontend\src\extensions\slash-command.jsx
==================================================

import { Extension } from '@tiptap/core'
import Suggestion from '@tiptap/suggestion'
import { ReactRenderer } from '@tiptap/react'
import tippy from 'tippy.js'
import { CommandList } from '../components/command-list'
import { Heading1, Heading2, List, ListOrdered, Code } from 'lucide-react'
import React from 'react'

const suggestionItems = [
    {
        title: 'Heading 1',
        icon: React.createElement(Heading1, { className: 'w-4 h-4' }),
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setNode('heading', { level: 1 }).run()
        },
    },
    {
        title: 'Heading 2',
        icon: React.createElement(Heading2, { className: 'w-4 h-4' }),
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).setNode('heading', { level: 2 }).run()
        },
    },
    {
        title: 'Bullet List',
        icon: React.createElement(List, { className: 'w-4 h-4' }),
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleBulletList().run()
        },
    },
    {
        title: 'Ordered List',
        icon: React.createElement(ListOrdered, { className: 'w-4 h-4' }),
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleOrderedList().run()
        },
    },
    {
        title: 'Code Block',
        icon: React.createElement(Code, { className: 'w-4 h-4' }),
        command: ({ editor, range }) => {
            editor.chain().focus().deleteRange(range).toggleCodeBlock().run()
        },
    },
]

export const SlashCommand = Extension.create({
    name: 'slashCommand',

    addProseMirrorPlugins() {
        console.log('SlashCommand extension registered') // Debug log

        return [
            Suggestion({
                editor: this.editor,
                char: '/',
                startOfLine: false,
                items: ({ query }) => {
                    console.log('Suggestion items queried:', query) // Debug log
                    return suggestionItems.filter(item =>
                        item.title.toLowerCase().includes(query.toLowerCase())
                    )
                },
                command: ({ editor, range, props }) => {
                    console.log('Command executed:', props) // Debug log
                    props.command({ editor, range })
                },
                render: () => {
                    let component
                    let popup

                    return {
                        onStart: (props) => {
                            console.log('Suggestion onStart', props) // Debug log

                            component = new ReactRenderer(CommandList, {
                                props,
                                editor: props.editor,
                            })

                            if (!props.clientRect) {
                                return
                            }

                            popup = tippy('body', {
                                getReferenceClientRect: props.clientRect,
                                appendTo: () => document.body,
                                content: component.element,
                                showOnCreate: true,
                                interactive: true,
                                trigger: 'manual',
                                placement: 'bottom-start',
                            })
                        },

                        onUpdate(props) {
                            component.updateProps(props)

                            if (!props.clientRect) {
                                return
                            }

                            popup[0].setProps({
                                getReferenceClientRect: props.clientRect,
                            })
                        },

                        onKeyDown(props) {
                            if (props.event.key === 'Escape') {
                                popup[0].hide()
                                return true
                            }

                            return component.ref?.onKeyDown(props)
                        },

                        onExit() {
                            popup[0].destroy()
                            component.destroy()
                        },
                    }
                },
            }),
        ]
    },
})


